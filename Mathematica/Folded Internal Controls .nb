(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    135732,       3203]
NotebookOptionsPosition[    129113,       3019]
NotebookOutlinePosition[    132114,       3086]
CellTagsIndexPosition[    132071,       3083]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Code for the Model", "Section",
 CellChangeTimes->{{3.6348397084940505`*^9, 3.6348397089180746`*^9}, {
  3.63486890578404*^9, 3.6348689079761653`*^9}}],

Cell[CellGroupData[{

Cell["Miscellaneous Utilities", "Subsection",
 CellChangeTimes->{{3.6345770377895007`*^9, 3.6345770388395023`*^9}, {
  3.6348493313534465`*^9, 3.634849334721639*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"makeState", "[", "list_List", "]"}], " ", ":=", " ", 
  "list"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"readState", "[", 
   RowBox[{"state_", ",", " ", "symbol_Symbol"}], "]"}], " ", ":=", " ", 
  RowBox[{"readState", "[", 
   RowBox[{"state", ",", " ", "symbol", ",", " ", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"readState", "[", 
   RowBox[{"state_", ",", " ", "symbol_Symbol", ",", " ", "default_"}], "]"}],
   " ", ":=", " ", 
  RowBox[{"symbol", " ", "/.", " ", 
   RowBox[{"(", 
    RowBox[{"state", " ", "~", "Join", "~", " ", 
     RowBox[{"{", 
      RowBox[{"symbol", " ", "\[Rule]", " ", "default"}], "}"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"preempt", "[", 
   RowBox[{"new_", ",", " ", "old_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"keys", ",", " ", "replacements", ",", " ", "values"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"keys", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"old", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "~", "Join", "~", " ", 
        RowBox[{"new", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "//", " ", "Union"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"replacements", " ", "=", " ", 
      RowBox[{"FilterRules", "[", 
       RowBox[{"new", ",", " ", "keys"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"values", " ", "=", " ", 
      RowBox[{
       RowBox[{"keys", " ", "/.", " ", "replacements"}], " ", "/.", " ", 
       "old"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Rule", " ", "@@", "#"}], "&"}], " ", "/@", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"keys", ",", " ", "values"}], "}"}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"preempt", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "b"}], ",", " ", 
     RowBox[{"e", "\[Rule]", "f"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "c"}], ",", " ", 
     RowBox[{"c", "\[Rule]", "d"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"readState", "[", 
  RowBox[{
   RowBox[{"makeState", "[", 
    RowBox[{"{", 
     RowBox[{"a", "\[Rule]", " ", "7"}], "}"}], "]"}], ",", " ", "b", ",", 
   " ", "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6345770416095057`*^9, 3.6345770867245693`*^9}, {
  3.6345775909082794`*^9, 3.6345775995982914`*^9}, {3.6345777103344483`*^9, 
  3.6345777209574633`*^9}, {3.6346724423876963`*^9, 3.6346725064113584`*^9}, {
  3.6346726854505987`*^9, 3.634672702585579*^9}, {3.6348629106201363`*^9, 
  3.634862924819948*^9}, {3.635103000661501*^9, 3.635103019809596*^9}, {
  3.635130676146448*^9, 3.635130796666342*^9}, {3.6351311334886065`*^9, 
  3.635131138407888*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a", "\[Rule]", "b"}], ",", 
   RowBox[{"c", "\[Rule]", "d"}], ",", 
   RowBox[{"e", "\[Rule]", "f"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6573075642640114`*^9, 3.6573083582425137`*^9, 
  3.657319899112561*^9}],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{3.6573075642640114`*^9, 3.6573083582425137`*^9, 
  3.6573198991135616`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Chemistry", "Subsection",
 CellChangeTimes->{{3.634849268721864*^9, 3.634849271306012*^9}}],

Cell["\<\
The main point of this section is, given a system of chemical equations, to \
be able to compute the set of differential rate equations that govern that \
system.\
\>", "Text",
 CellChangeTimes->{{3.6348504642652454`*^9, 3.634850510185872*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Notation`AutoLoadNotationPalette", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<Notation`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Notation", "[", 
  RowBox[{
   TemplateBox[{RowBox[{"a_", " ", 
       UnderoverscriptBox[
        TagBox[
         TagBox["\[Equilibrium]", DisplayForm], DisplayForm], "kr_", "kf_"], 
       " ", "b_"}]},
    "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
   TemplateBox[{RowBox[{"TChemicalReaction", "[", 
       RowBox[{
         RowBox[{"TChemicalExpr", "[", "a_", "]"}], ",", 
         RowBox[{"TChemicalExpr", "[", "b_", "]"}], ",", "kf_", ",", " ", 
         "kr_"}], "]"}]},
    "NotationTemplateTag"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Notation", "[", 
  RowBox[{
   TemplateBox[{RowBox[{"a_", 
       OverscriptBox["\[RightArrow]", "k_"], "b_"}]},
    "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
   TemplateBox[{RowBox[{"TChemicalReaction", "[", 
       RowBox[{
         RowBox[{"TChemicalExpr", "[", "a_", "]"}], ",", 
         RowBox[{"TChemicalExpr", "[", "b_", "]"}], ",", "k_", ",", " ", 
         "0"}], "]"}]},
    "NotationTemplateTag"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddInputAlias", "[", 
  RowBox[{"\"\<rxn\>\"", "\[Rule]", 
   TemplateBox[{OverscriptBox["\[RightArrow]", "\[Placeholder]"]},
    "NotationTemplateTag"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddInputAlias", "[", 
  RowBox[{"\"\<erxn\>\"", "\[Rule]", 
   TemplateBox[{RowBox[{
       UnderoverscriptBox[
        TagBox[
         TagBox["\[Equilibrium]", DisplayForm], DisplayForm], 
        "\[Placeholder]", "\[Placeholder]"], " "}]},
    "NotationTemplateTag"]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6348492985245686`*^9, 3.6348492997236376`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"chemicalReactionQ", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"x", ",", " ", 
     RowBox[{"TChemicalReaction", "[", 
      RowBox[{"_", ",", "_", ",", "_", ",", "_"}], "]"}]}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chemicalSystemPattern", " ", "=", " ", 
    RowBox[{"{", " ", 
     RowBox[{"Repeated", "[", 
      RowBox[{"_", "?", "chemicalReactionQ"}], "]"}], " ", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allSpecies", "[", 
   RowBox[{"TChemicalExpr", "[", "e_", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"Variables", "[", "e", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allSpecies", "[", 
   RowBox[{"TChemicalReaction", "[", 
    RowBox[{"r_", ",", "p_", ",", " ", "_", ",", " ", "_"}], "]"}], "]"}], 
  " ", ":=", " ", 
  RowBox[{
   RowBox[{"allSpecies", "[", "r", "]"}], " ", "\[Union]", " ", 
   RowBox[{"allSpecies", "[", "p", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"allSpecies", "[", 
     RowBox[{"system", " ", ":", " ", "chemicalSystemPattern"}], "]"}], " ", ":=",
     " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"allSpecies", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
       "system"}], " ", "//", " ", "Flatten"}], " ", "//", " ", "Union"}]}], 
   ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allParameters", "[", 
   RowBox[{"rxn", ":", "  ", 
    RowBox[{"TChemicalReaction", "[", 
     RowBox[{"r_", ",", "p_", ",", " ", "kf_", ",", " ", "kr_"}], "]"}]}], 
   "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Variables", "[", "kf", "]"}], ",", " ", 
      RowBox[{"Variables", "[", "kr", "]"}]}], "}"}], " ", "//", " ", 
    "Flatten"}], " ", "//", " ", "Union"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"allParameters", "[", 
     RowBox[{"system", " ", ":", " ", "chemicalSystemPattern"}], "]"}], " ", ":=",
     " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"allParameters", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
       "system"}], " ", "//", " ", "Flatten"}], " ", "//", " ", "Union"}]}], 
   ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stochiometry", "[", 
   RowBox[{
    RowBox[{"TChemicalExpr", "[", "expr_", "]"}], ",", " ", "species_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"expr", ",", " ", "species"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stochiometry", "[", 
   RowBox[{"e", ":", " ", 
    RowBox[{"TChemicalExpr", "[", "_", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[Nu]", "#"], "\[Rule]", 
     RowBox[{"stochiometry", "[", 
      RowBox[{"e", ",", " ", "#"}], "]"}]}], "&"}], " ", "/@", " ", 
   RowBox[{"allSpecies", "[", "e", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stochiometry", "[", 
   RowBox[{"rxn", ":", "  ", 
    RowBox[{"TChemicalReaction", "[", 
     RowBox[{"r_", ",", "p_", ",", " ", "_", ",", " ", "_"}], "]"}]}], "]"}], 
  " ", ":=", "  ", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[Nu]", "#"], "\[Rule]", 
     RowBox[{
      RowBox[{"stochiometry", "[", 
       RowBox[{"p", ",", " ", "#"}], "]"}], "-", 
      RowBox[{"stochiometry", "[", 
       RowBox[{"r", ",", " ", "#"}], "]"}]}]}], " ", "&"}], " ", "/@", " ", 
   RowBox[{"allSpecies", "[", "rxn", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stochiometry", "[", 
    RowBox[{"system", " ", ":", " ", "chemicalSystemPattern"}], "]"}], " ", ":=",
    " ", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "species", "}"}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Nu]", "species"], "\[Rule]", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["\[Nu]", "species"], " ", "/.", 
             RowBox[{"stochiometry", "[", "#", "]"}]}], " ", "/.", " ", 
            RowBox[{
             SubscriptBox["\[Nu]", "species"], "\[Rule]", " ", "0"}]}], "&"}],
           "/@", " ", "system"}], ")"}], "]"}]}]}], "]"}], "/@", " ", 
    RowBox[{"allSpecies", "[", "system", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rate", "[", 
   RowBox[{
    RowBox[{"e", ":", " ", 
     RowBox[{"TChemicalExpr", "[", "_", "]"}]}], ",", " ", "k_"}], "]"}], " ",
   ":=", " ", 
  RowBox[{"k", " ", "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", " ", "@@", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["#", 
          SubscriptBox["\[Nu]", "#"]], "&"}], "/@", " ", 
        RowBox[{"allSpecies", "[", "e", "]"}]}], ")"}]}], " ", "/.", " ", 
     RowBox[{"stochiometry", "[", "e", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rate", "[", 
    RowBox[{"rxn", " ", ":", " ", 
     RowBox[{"TChemicalReaction", "[", 
      RowBox[{"r_", ",", "p_", ",", " ", "kf_", ",", " ", "kr_"}], "]"}]}], 
    "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"rate", "[", 
     RowBox[{"r", ",", "kf"}], "]"}], " ", "-", " ", 
    RowBox[{"rate", "[", 
     RowBox[{"p", ",", "kr"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rate", "[", 
   RowBox[{
    RowBox[{"rxn", " ", ":", " ", 
     RowBox[{"TChemicalReaction", "[", 
      RowBox[{"_", ",", "_", ",", "_", ",", "_"}], "]"}]}], ",", " ", 
    "species_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"rate", "[", "rxn", "]"}], " ", "*", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Nu]", 
       RowBox[{"species", " "}]], "/.", " ", 
      RowBox[{"stochiometry", "[", "rxn", "]"}]}], " ", "/.", " ", 
     RowBox[{
      SubscriptBox["\[Nu]", 
       RowBox[{"species", " "}]], "\[Rule]", " ", "0"}]}], 
    ")"}]}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rateEqns", "[", 
   RowBox[{
    RowBox[{"rxn_", "?", "chemicalReactionQ"}], ",", " ", "t_"}], "]"}], " ", 
  ":=", " ", 
  RowBox[{"rates", "[", 
   RowBox[{
    RowBox[{"{", "rxn", "}"}], ",", " ", "t"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rateEqns", "[", 
   RowBox[{
    RowBox[{"system", " ", ":", " ", "chemicalSystemPattern"}], ",", " ", 
    "t_", ",", " ", "optionsSeq___Rule"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"options", ",", "  ", "systemSpecies", ",", " ", "exprs"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"options", " ", "=", " ", 
      RowBox[{"preempt", "[", 
       RowBox[{
        RowBox[{"{", " ", "optionsSeq", " ", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"WasteSpecies", " ", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"systemSpecies", " ", "=", " ", 
      RowBox[{"allSpecies", "[", "system", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"systemSpecies", " ", "=", " ", 
      RowBox[{"Intersection", "[", 
       RowBox[{"systemSpecies", ",", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{"systemSpecies", ",", " ", 
          RowBox[{"(", 
           RowBox[{"WasteSpecies", " ", "/.", " ", "options"}], ")"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "species", "}"}], ",", " ", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"species", "[", "t", "]"}], ",", "t"}], "]"}], " ", "==", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"#", ",", " ", "species"}], "]"}], "&"}], "/@", " ", 
             "system"}], "]"}], " ", "/.", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"#", " ", "\[Rule]", " ", 
               RowBox[{"#", "[", "t", "]"}]}], "&"}], " ", "/@", " ", 
             "systemSpecies"}], ")"}]}], ")"}]}]}], "]"}], "/@", 
      "systemSpecies"}]}]}], " ", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6348494258278503`*^9, 3.634849432539234*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rateEqns", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "+", " ", "G"}], " ", 
       OverscriptBox["\[RightArrow]", "k"], " ", 
       RowBox[{"P", " ", "+", " ", "W1"}]}], ",", " ", 
      RowBox[{
       RowBox[{"P", " ", "+", " ", "R"}], " ", 
       OverscriptBox["\[RightArrow]", "q"], " ", 
       RowBox[{"F", " ", "+", " ", "W2"}]}]}], "}"}], ",", " ", "\[Tau]", ",",
     " ", 
    RowBox[{"WasteSpecies", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"W1", ",", " ", "W2"}], "}"}]}]}], "]"}], " ", "//", " ", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.6348495618736315`*^9, 3.634849562265654*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["F", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{"q", " ", 
        RowBox[{"P", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"R", "[", "\[Tau]", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["G", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", "k"}], " ", 
        RowBox[{"G", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"S", "[", "\[Tau]", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["P", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q"}], " ", 
         RowBox[{"P", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"R", "[", "\[Tau]", "]"}]}], "+", 
        RowBox[{"k", " ", 
         RowBox[{"G", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"S", "[", "\[Tau]", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["R", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", "q"}], " ", 
        RowBox[{"P", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"R", "[", "\[Tau]", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["S", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", "k"}], " ", 
        RowBox[{"G", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"S", "[", "\[Tau]", "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.657307575708145*^9, 3.657308358758316*^9, 
  3.6573198996767845`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stochiometry", "[", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "+", " ", "G"}], " ", 
     OverscriptBox["\[RightArrow]", "k"], " ", 
     RowBox[{"P", " ", "+", " ", "W1"}]}], ",", " ", 
    RowBox[{
     RowBox[{"P", " ", "+", " ", "R"}], " ", 
     OverscriptBox["\[RightArrow]", "q"], " ", 
     RowBox[{"F", " ", "+", " ", "W2"}]}], ",", " ", 
    RowBox[{
     RowBox[{"A", " ", "+", " ", "B"}], " ", 
     OverscriptBox["\[RightArrow]", "d"], "C"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Nu]", "A"], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    SubscriptBox["\[Nu]", "B"], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    SubscriptBox["\[Nu]", "C"], "\[Rule]", "1"}], ",", 
   RowBox[{
    SubscriptBox["\[Nu]", "F"], "\[Rule]", "1"}], ",", 
   RowBox[{
    SubscriptBox["\[Nu]", "G"], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    SubscriptBox["\[Nu]", "P"], "\[Rule]", "0"}], ",", 
   RowBox[{
    SubscriptBox["\[Nu]", "R"], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    SubscriptBox["\[Nu]", "S"], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    SubscriptBox["\[Nu]", "W1"], "\[Rule]", "1"}], ",", 
   RowBox[{
    SubscriptBox["\[Nu]", "W2"], "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6573075757161455`*^9, 3.6573083587653356`*^9, 
  3.657319899688769*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Constants", "Subsection",
 CellChangeTimes->{{3.6344352200038705`*^9, 3.634435220931924*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stateVariables", " ", "=", " ", "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
   "p", ",", " ", "c", ",", " ", "t", ",", " ", "pt", ",", " ", "pc"}], 
   "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.635188245888831*^9, 3.635188285327087*^9}, {
  3.6355371548766394`*^9, 3.6355371552816396`*^9}, {3.635537186561184*^9, 
  3.6355371895411882`*^9}, {3.657308080543272*^9, 3.6573080838691454`*^9}, {
  3.6573200091204467`*^9, 3.657320010937215*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"p", ",", "c", ",", "t", ",", "pt", ",", "pc"}], "}"}]], "Output",
 CellChangeTimes->{3.6573076439361763`*^9, 3.657308084583723*^9, 
  3.6573083599449797`*^9, 3.657319899696766*^9, 3.6573200113324995`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"constants", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state0", "[", "]"}], " ", ":=", " ", 
  RowBox[{"state0", "[", 
   RowBox[{"tStart", ",", " ", "constants"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state0", "[", 
   RowBox[{"tStart_", ",", " ", "constants_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"makeState", " ", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"p", " ", "\[Rule]", " ", "pStart"}], ",", " ", 
        RowBox[{"t", " ", "\[Rule]", " ", "tStart"}], ",", " ", 
        RowBox[{"c", " ", "\[Rule]", " ", "cStart"}]}], " ", "}"}], " ", "//.",
       " ", "constants"}], ")"}]}], " ", "//", " ", 
   "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"state0", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", "  ", 
     RowBox[{"t1", ",", " ", "t2", ",", "  ", "kh1", ",", " ", "ku", ",", " ", 
      RowBox[{"koffu", "/", "konu"}], ",", " ", "koffu", ",", " ", "konu"}], 
     " ", "}"}], " ", "//.", " ", 
    RowBox[{"state0", "[", "]"}]}], " ", "//.", " ", "constants"}], "//", " ",
   "N"}]}], "Input",
 CellChangeTimes->{{3.634435222143993*^9, 3.634435225780201*^9}, {
   3.6344355326827545`*^9, 3.6344358431055098`*^9}, {3.6344374258620386`*^9, 
   3.63443754513286*^9}, {3.6344376444285393`*^9, 3.634437665132724*^9}, {
   3.6344381175706015`*^9, 3.634438134160551*^9}, {3.634439339697503*^9, 
   3.6344393424166594`*^9}, {3.634439433712881*^9, 3.634439434448923*^9}, {
   3.6344394744162087`*^9, 3.634439479992528*^9}, 3.6344395111443095`*^9, {
   3.634482914057667*^9, 3.6344829197676744`*^9}, {3.6344898161093497`*^9, 
   3.6344898169893513`*^9}, {3.6344906260015326`*^9, 3.634490674926601*^9}, {
   3.634494723657215*^9, 3.6344947237272153`*^9}, {3.634494808954336*^9, 
   3.6344948091443367`*^9}, {3.6344950830337214`*^9, 3.634495083403722*^9}, {
   3.634495138009799*^9, 3.634495138109799*^9}, 3.63449518873687*^9, {
   3.634495631348048*^9, 3.6344956867351265`*^9}, {3.634495791056273*^9, 
   3.634495820140314*^9}, {3.6344959118544436`*^9, 3.6344959118944435`*^9}, 
   3.6345000069733047`*^9, {3.6345002117895937`*^9, 3.6345002183706026`*^9}, {
   3.634500267358672*^9, 3.634500267549672*^9}, 3.634500593147131*^9, 
   3.6345006265411787`*^9, {3.6345007787773924`*^9, 3.634500782718398*^9}, {
   3.6345009334866104`*^9, 3.634500933586611*^9}, 3.6345010506927757`*^9, 
   3.6345014170313015`*^9, {3.6345026937911277`*^9, 3.63450273827619*^9}, {
   3.6345031060047073`*^9, 3.6345031074747095`*^9}, 3.6345041252103586`*^9, {
   3.6345087939830613`*^9, 3.634508847383116*^9}, {3.634577112727606*^9, 
   3.6345771143686085`*^9}, 3.6346622554316564`*^9, {3.6346623070209465`*^9, 
   3.63466231436856*^9}, {3.6346623489070206`*^9, 3.634662353150228*^9}, {
   3.6346624149897366`*^9, 3.6346624224465494`*^9}, 3.63466245659801*^9, {
   3.63466267289239*^9, 3.6346626729703903`*^9}, 3.6346628680985327`*^9, {
   3.6346629271456366`*^9, 3.634662927317237*^9}, 3.6346629622144985`*^9, 
   3.634663046517046*^9, {3.634663179975281*^9, 3.6346631822372847`*^9}, {
   3.634667777166379*^9, 3.6346677985966053`*^9}, {3.6346744729588385`*^9, 
   3.6346745029255524`*^9}, {3.6346943511758075`*^9, 3.634694356307101*^9}, {
   3.634694684862893*^9, 3.634694712334464*^9}, {3.6346948426399174`*^9, 
   3.6346948452230654`*^9}, {3.634696096182616*^9, 3.634696100078839*^9}, {
   3.6348345565243745`*^9, 3.634834594316536*^9}, {3.634840502394459*^9, 
   3.6348405024984646`*^9}, {3.6348517553870935`*^9, 
   3.6348518156195383`*^9}, {3.634853297921321*^9, 3.634853324352833*^9}, {
   3.634853739813596*^9, 3.634853740877657*^9}, {3.6348538159579515`*^9, 
   3.63485384094038*^9}, {3.6348539524847603`*^9, 3.6348539562199736`*^9}, {
   3.6348540030526524`*^9, 3.6348540222037477`*^9}, {3.6348541789307117`*^9, 
   3.6348542689068584`*^9}, 3.6348611877135916`*^9, {3.634861230129018*^9, 
   3.634861243161763*^9}, {3.634861347696742*^9, 3.634861375008304*^9}, 
   3.6348614065361075`*^9, {3.6348614609842215`*^9, 3.634861469822727*^9}, {
   3.634861505031741*^9, 3.6348615639241095`*^9}, {3.634865634914957*^9, 
   3.6348656442874928`*^9}, {3.634865736143747*^9, 3.6348659868960896`*^9}, {
   3.6348671291724234`*^9, 3.6348671373038883`*^9}, {3.6348685191979284`*^9, 
   3.6348685427902775`*^9}, {3.6350159134777303`*^9, 3.635015922799743*^9}, {
   3.6350207602601385`*^9, 3.6350207645911446`*^9}, {3.635027870670311*^9, 
   3.6350279019210987`*^9}, {3.6350279947054057`*^9, 3.63502799548145*^9}, {
   3.6350281779998894`*^9, 3.6350281852393036`*^9}, {3.635096336534335*^9, 
   3.635096370806295*^9}, 3.635097805292343*^9, {3.63510229361306*^9, 
   3.635102328981083*^9}, {3.6351311685596123`*^9, 3.635131240733741*^9}, 
   3.635131845260318*^9, 3.6351319097710075`*^9, {3.6351319406357727`*^9, 
   3.6351319421878614`*^9}, {3.635188083212527*^9, 3.6351881426249247`*^9}, {
   3.6352643172198625`*^9, 3.63526432784247*^9}, {3.635264518721388*^9, 
   3.6352645807529354`*^9}, {3.635264633335943*^9, 3.635264672024156*^9}, {
   3.635264791791006*^9, 3.6352648151913447`*^9}, {3.6352654337147226`*^9, 
   3.6352654427862415`*^9}, {3.635265482138492*^9, 3.6352654962663*^9}, {
   3.6353430211983447`*^9, 3.635343053178401*^9}, {3.635343091524268*^9, 
   3.635343191699044*^9}, {3.6353433470129175`*^9, 3.635343382253379*^9}, {
   3.63534351308471*^9, 3.6353435267286353`*^9}, {3.635343692681833*^9, 
   3.635343718749479*^9}, {3.6353437694807677`*^9, 3.6353437738799753`*^9}, {
   3.6353438119128428`*^9, 3.6353438133012447`*^9}, 3.6353438437524986`*^9, {
   3.635356621501941*^9, 3.6353566539499984`*^9}, {3.635356685618054*^9, 
   3.6353567176293097`*^9}, {3.6353567731040077`*^9, 
   3.6353568508409443`*^9}, {3.635356916159259*^9, 3.635357267987677*^9}, {
   3.6353583686987176`*^9, 3.6353584646026864`*^9}, {3.635358510436567*^9, 
   3.6353585263173947`*^9}, {3.635358587126302*^9, 3.63535859745352*^9}, {
   3.635537128217101*^9, 3.6355371378181148`*^9}, {3.6355468346851406`*^9, 
   3.635546850267163*^9}, {3.6573080984897485`*^9, 3.6573081399903345`*^9}, {
   3.6573083780379553`*^9, 3.657308378837232*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"p", "\[Rule]", "pStart"}], ",", 
   RowBox[{"t", "\[Rule]", "tStart"}], ",", 
   RowBox[{"c", "\[Rule]", "cStart"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6573076436973457`*^9, 3.65730810999182*^9, 3.6573081406107283`*^9, {
   3.6573083614730763`*^9, 3.6573083792376523`*^9}, 3.6573198997047653`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"t1", ",", "t2", ",", "kh1", ",", "ku", ",", 
   FractionBox["koffu", "konu"], ",", "koffu", ",", "konu"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6573076436973457`*^9, 3.65730810999182*^9, 3.6573081406107283`*^9, {
   3.6573083614730763`*^9, 3.6573083792376523`*^9}, 3.657319899708782*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reactions", "Subsection",
 CellChangeTimes->{{3.657308409320326*^9, 3.657308413407798*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"reactions", " ", "=", " ", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"p", " ", "+", " ", "t"}], " ", 
     UnderoverscriptBox[
      TagBox[
       TagBox["\[Equilibrium]",
        DisplayForm],
       DisplayForm], "koff1", "kon1"], " ", "pt"}], ",", " ", 
    RowBox[{
     RowBox[{"p", " ", "+", " ", "c"}], " ", 
     UnderoverscriptBox[
      TagBox[
       TagBox["\[Equilibrium]",
        DisplayForm],
       DisplayForm], "koff2", "kon2"], " ", "pc"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reactionEqns", " ", "=", " ", 
   RowBox[{"rateEqns", "[", 
    RowBox[{"reactions", ",", "  ", "\[Tau]", ",", " ", 
     RowBox[{"WasteSpecies", " ", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reactionEqns", " ", "//", " ", "Column"}], " ", "//", " ", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.657308418093299*^9, 3.6573085052975464`*^9}, {
  3.6573088219376464`*^9, 3.657308842872547*^9}, {3.657308889374916*^9, 
  3.6573088895997005`*^9}, {3.657320360191884*^9, 3.6573203734427347`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "+", "t"}], " ", 
    UnderoverscriptBox[
     TagBox[
      TagBox["\[Equilibrium]",
       DisplayForm],
      DisplayForm], "koff1", "kon1"], " ", "pt"}], ",", 
   RowBox[{
    RowBox[{"c", "+", "p"}], " ", 
    UnderoverscriptBox[
     TagBox[
      TagBox["\[Equilibrium]",
       DisplayForm],
      DisplayForm], "koff2", "kon2"], " ", "pc"}]}], "}"}]], "Output",
 CellChangeTimes->{3.657308526104887*^9, 3.6573088433944144`*^9, 
  3.6573088902203007`*^9, 3.657319920257527*^9, 3.65732037402328*^9}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["c", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "kon2"}], " ", 
         RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}]}], "+", 
        RowBox[{"koff2", " ", 
         RowBox[{"pc", "[", "\[Tau]", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["p", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "kon2"}], " ", 
         RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}]}], "+", 
        RowBox[{"koff2", " ", 
         RowBox[{"pc", "[", "\[Tau]", "]"}]}], "+", 
        RowBox[{"koff1", " ", 
         RowBox[{"pt", "[", "\[Tau]", "]"}]}], "-", 
        RowBox[{"kon1", " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["pc", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"kon2", " ", 
         RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}]}], "-", 
        RowBox[{"koff2", " ", 
         RowBox[{"pc", "[", "\[Tau]", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["pt", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "koff1"}], " ", 
         RowBox[{"pt", "[", "\[Tau]", "]"}]}], "+", 
        RowBox[{"kon1", " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["t", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"koff1", " ", 
         RowBox[{"pt", "[", "\[Tau]", "]"}]}], "-", 
        RowBox[{"kon1", " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}]}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.657308526104887*^9, 3.6573088433944144`*^9, 
  3.6573088902203007`*^9, 3.657319920257527*^9, 3.657320374027297*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"massBalanceEqns", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"pT", " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"p", "[", "\[Tau]", "]"}], " ", "+", " ", 
       RowBox[{"pt", "[", "\[Tau]", "]"}], " ", "+", " ", 
       RowBox[{"pc", "[", "\[Tau]", "]"}]}]}], ",", " ", 
     RowBox[{"tT", " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"t", "[", "\[Tau]", "]"}], " ", "+", " ", 
       RowBox[{"pt", "[", "\[Tau]", "]"}]}]}], ",", " ", 
     RowBox[{"cT", " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"c", "[", "\[Tau]", "]"}], " ", "+", " ", 
       RowBox[{"ct", "[", "\[Tau]", "]"}]}]}]}], "}"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{"massBalanceEqns", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "[", "\[Tau]", "]"}], ",", " ", 
      RowBox[{"t", "[", "\[Tau]", "]"}], ",", " ", 
      RowBox[{"c", "[", "\[Tau]", "]"}]}], "}"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.657308534976677*^9, 3.6573085630091577`*^9}, {
  3.657308897489565*^9, 3.6573089024225464`*^9}, {3.657320574187295*^9, 
  3.657320589414155*^9}, {3.6573206491818676`*^9, 3.6573206792424917`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"pT", "\[Equal]", 
    RowBox[{
     RowBox[{"p", "[", "\[Tau]", "]"}], "+", 
     RowBox[{"pc", "[", "\[Tau]", "]"}], "+", 
     RowBox[{"pt", "[", "\[Tau]", "]"}]}]}], ",", 
   RowBox[{"tT", "\[Equal]", 
    RowBox[{
     RowBox[{"pt", "[", "\[Tau]", "]"}], "+", 
     RowBox[{"t", "[", "\[Tau]", "]"}]}]}], ",", 
   RowBox[{"cT", "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "\[Tau]", "]"}], "+", 
     RowBox[{"ct", "[", "\[Tau]", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6573085636313143`*^9, 3.6573088449495935`*^9, 3.6573089028281145`*^9, 
   3.6573199173281403`*^9, 3.657320590879255*^9, {3.65732067297882*^9, 
   3.657320679599053*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "[", "\[Tau]", "]"}], "\[Rule]", 
    RowBox[{"pT", "-", 
     RowBox[{"pc", "[", "\[Tau]", "]"}], "-", 
     RowBox[{"pt", "[", "\[Tau]", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"t", "[", "\[Tau]", "]"}], "\[Rule]", 
    RowBox[{"tT", "-", 
     RowBox[{"pt", "[", "\[Tau]", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "\[Tau]", "]"}], "\[Rule]", 
    RowBox[{"cT", "-", 
     RowBox[{"ct", "[", "\[Tau]", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6573085636313143`*^9, 3.6573088449495935`*^9, 3.6573089028281145`*^9, 
   3.6573199173281403`*^9, 3.657320590879255*^9, {3.65732067297882*^9, 
   3.6573206796030574`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"inits", " ", "=", " ", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "0", "]"}], " ", "\[Equal]", " ", "pT"}], ",", " ", 
    RowBox[{
     RowBox[{"t", "[", "0", "]"}], " ", "\[Equal]", " ", "tT"}], ",", " ", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], " ", "\[Equal]", " ", "cT"}], ",", " ", 
    RowBox[{
     RowBox[{"pt", "[", "0", "]"}], "\[Equal]", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"ct", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6573199274565573`*^9, 3.657319975253612*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "[", "0", "]"}], "\[Equal]", "pT"}], ",", 
   RowBox[{
    RowBox[{"t", "[", "0", "]"}], "\[Equal]", "tT"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "0", "]"}], "\[Equal]", "cT"}], ",", 
   RowBox[{
    RowBox[{"pt", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"ct", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.657319975812503*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eqns", " ", "=", " ", 
  RowBox[{
  "reactionEqns", " ", "~", "Join", "~", " ", 
   "inits"}]}], "\[IndentingNewLine]", 
 RowBox[{"vars", " ", "=", " ", "stateVariables"}], "\[IndentingNewLine]", 
 RowBox[{"DSolve", "[", 
  RowBox[{"eqns", ",", " ", "vars", ",", " ", "\[Tau]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6573200176720715`*^9, 3.6573200564806843`*^9}, {
  3.6573201132484384`*^9, 3.6573201210832863`*^9}, {3.657320301968131*^9, 
  3.657320312021801*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["c", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "kon2"}], " ", 
      RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
      RowBox[{"p", "[", "\[Tau]", "]"}]}], "+", 
     RowBox[{"koff2", " ", 
      RowBox[{"pc", "[", "\[Tau]", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["p", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "kon2"}], " ", 
      RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
      RowBox[{"p", "[", "\[Tau]", "]"}]}], "+", 
     RowBox[{"koff2", " ", 
      RowBox[{"pc", "[", "\[Tau]", "]"}]}], "+", 
     RowBox[{"koff1", " ", 
      RowBox[{"pt", "[", "\[Tau]", "]"}]}], "-", 
     RowBox[{"kon1", " ", 
      RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
      RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["pc", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"kon2", " ", 
      RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
      RowBox[{"p", "[", "\[Tau]", "]"}]}], "-", 
     RowBox[{"koff2", " ", 
      RowBox[{"pc", "[", "\[Tau]", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["pt", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "koff1"}], " ", 
      RowBox[{"pt", "[", "\[Tau]", "]"}]}], "+", 
     RowBox[{"kon1", " ", 
      RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
      RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["t", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"koff1", " ", 
      RowBox[{"pt", "[", "\[Tau]", "]"}]}], "-", 
     RowBox[{"kon1", " ", 
      RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
      RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "0", "]"}], "\[Equal]", "pT"}], ",", 
   RowBox[{
    RowBox[{"t", "[", "0", "]"}], "\[Equal]", "tT"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "0", "]"}], "\[Equal]", "cT"}], ",", 
   RowBox[{
    RowBox[{"pt", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"ct", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6573200422072954`*^9, 3.6573200567968493`*^9}, 
   3.657320122659133*^9, 3.657320313152423*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"p", ",", "c", ",", "t", ",", "pt", ",", "pc"}], "}"}]], "Output",
 CellChangeTimes->{{3.6573200422072954`*^9, 3.6573200567968493`*^9}, 
   3.657320122659133*^9, 3.6573203131564217`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"DSolve", "::", "deqx"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Supplied equations are not differential equations of the \
given functions. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/DSolve/deqx\
\\\", ButtonNote -> \\\"DSolve::deqx\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.657320313190961*^9}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["c", "\[Prime]",
        MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kon2"}], " ", 
        RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"p", "[", "\[Tau]", "]"}]}], "+", 
       RowBox[{"koff2", " ", 
        RowBox[{"pc", "[", "\[Tau]", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["p", "\[Prime]",
        MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kon2"}], " ", 
        RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"p", "[", "\[Tau]", "]"}]}], "+", 
       RowBox[{"koff2", " ", 
        RowBox[{"pc", "[", "\[Tau]", "]"}]}], "+", 
       RowBox[{"koff1", " ", 
        RowBox[{"pt", "[", "\[Tau]", "]"}]}], "-", 
       RowBox[{"kon1", " ", 
        RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["pc", "\[Prime]",
        MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"kon2", " ", 
        RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"p", "[", "\[Tau]", "]"}]}], "-", 
       RowBox[{"koff2", " ", 
        RowBox[{"pc", "[", "\[Tau]", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["pt", "\[Prime]",
        MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "koff1"}], " ", 
        RowBox[{"pt", "[", "\[Tau]", "]"}]}], "+", 
       RowBox[{"kon1", " ", 
        RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["t", "\[Prime]",
        MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"koff1", " ", 
        RowBox[{"pt", "[", "\[Tau]", "]"}]}], "-", 
       RowBox[{"kon1", " ", 
        RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"p", "[", "0", "]"}], "\[Equal]", "pT"}], ",", 
     RowBox[{
      RowBox[{"t", "[", "0", "]"}], "\[Equal]", "tT"}], ",", 
     RowBox[{
      RowBox[{"c", "[", "0", "]"}], "\[Equal]", "cT"}], ",", 
     RowBox[{
      RowBox[{"pt", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"ct", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "c", ",", "t", ",", "pt", ",", "pc"}], "}"}], ",", 
   "\[Tau]"}], "]"}]], "Output",
 CellChangeTimes->{{3.6573200422072954`*^9, 3.6573200567968493`*^9}, 
   3.657320122659133*^9, 3.657320313192459*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Annealing Model", "Subsection",
 CellChangeTimes->{{3.634862344829775*^9, 3.634862346701882*^9}}],

Cell[CellGroupData[{

Cell["Equilibrium Annealing Model", "Subsubsection",
 CellChangeTimes->{{3.6344315782535744`*^9, 3.6344315833338647`*^9}, {
  3.634862332982097*^9, 3.634862334222168*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"equilibriumEqns", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p1T", " ", "\[Equal]", " ", 
      RowBox[{"p1", " ", "+", " ", "h1", " ", "+", " ", "d"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"p2T", " ", "\[Equal]", " ", 
      RowBox[{"p2", " ", "+", " ", "h2", " ", "+", " ", "d"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"t1T", " ", "\[Equal]", " ", 
      RowBox[{"t1", " ", "+", " ", "h1"}]}], " ", 
     RowBox[{"(*", 
      RowBox[{"+", " ", "u"}], "*)"}], ",", "\[IndentingNewLine]", 
     RowBox[{"t2T", " ", "\[Equal]", " ", 
      RowBox[{"t2", " ", "+", " ", "h2"}]}], " ", 
     RowBox[{"(*", 
      RowBox[{"+", " ", "u"}], "*)"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kh1", " ", "\[Equal]", " ", 
      RowBox[{"p1", " ", 
       RowBox[{"t1", " ", "/", " ", "h1"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"kh2", " ", "\[Equal]", " ", 
      RowBox[{"p2", " ", 
       RowBox[{"t2", " ", "/", " ", "h2"}]}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"ku", " ", "\[Equal]", " ", 
        RowBox[{"t1", " ", 
         RowBox[{"t2", " ", "/", " ", "u"}]}]}], ","}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"kd", " ", "\[Equal]", " ", 
      RowBox[{"p1", " ", 
       RowBox[{"p2", " ", "/", " ", "d"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6344160609570355`*^9, 3.6344160709726086`*^9}, {
   3.6344161110679016`*^9, 3.634416213042734*^9}, {3.6344162710670533`*^9, 
   3.6344163209479065`*^9}, {3.6344166853597493`*^9, 3.6344166863278046`*^9}, 
   3.634417627338628*^9, {3.6344177059371233`*^9, 3.634417708072245*^9}, {
   3.6344177567540293`*^9, 3.6344179376633773`*^9}, {3.6344179820469155`*^9, 
   3.6344180479666862`*^9}, 3.6344181557508507`*^9, {3.634418949695262*^9, 
   3.634418995678892*^9}, {3.634419027028685*^9, 3.634419106678241*^9}, {
   3.6344214964379272`*^9, 3.6344214968059483`*^9}, {3.6344315714871874`*^9, 
   3.6344315854469852`*^9}, {3.6344382214955463`*^9, 
   3.6344382365594077`*^9}, {3.6344382696653013`*^9, 
   3.6344382783908005`*^9}, {3.6344389500092144`*^9, 3.634438999479044*^9}, {
   3.6344393480809827`*^9, 3.6344393498240824`*^9}, {3.634439535771718*^9, 
   3.6344395453072634`*^9}, {3.6344831140679483`*^9, 3.634483116377951*^9}, {
   3.634488112580595*^9, 3.6344881129705954`*^9}}],

Cell["\<\
A function that given the input state to the annealing step produces the \
state at the conclusion of the annealing step according to the equilibrium \
model.\
\>", "Text",
 CellChangeTimes->{{3.634480828485735*^9, 3.634480873349798*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"annealEquilibrium", "[", 
   RowBox[{"annealingInput_", ",", " ", "constants_", ",", " ", 
    RowBox[{"options_:", 
     RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "  ", 
     RowBox[{
     "eqns", ",", " ", "solns", ",", "result", " ", ",", " ", 
      "annEfficiency"}], " ", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eqns", " ", "=", " ", 
      RowBox[{
       RowBox[{"equilibriumEqns", " ", "/.", " ", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p1T", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "p1"}], "]"}], "  ", "+", 
             " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "h1"}], "]"}], " ", "+", 
             " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "d"}], "]"}]}], ")"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"p2T", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "p2"}], "]"}], " ", "+", 
             " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "h2"}], "]"}], " ", "+", 
             " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "d"}], "]"}]}], ")"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"t1T", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "t1"}], "]"}], " ", "+", 
             " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "h1"}], "]"}]}], ")"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"t2T", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "t2"}], "]"}], " ", "+", 
             " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "h2"}], "]"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], " ", "\[IndentingNewLine]", " ", "//.",
        " ", "constants"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"solns", " ", "=", " ", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"eqns", " ", "~", "Join", "~", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p1", " ", "\[GreaterEqual]", "0"}], " ", ",", 
            RowBox[{"p2", " ", "\[GreaterEqual]", "0"}]}], "}"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "h1", ",", "h2", ",", "p1", ",", "p2", ",", " ", "t1", ",", " ", 
           "t2", ",", " ", "d"}], "}"}]}], "]"}], " ", "//", " ", "Quiet"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "solns", "]"}], " ", ">", " ", "0"}], ",", 
        RowBox[{"solns", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
        RowBox[{"preempt", "[", 
         RowBox[{"annealingInput", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"h1", "\[Rule]", " ", "0"}], ",", " ", 
            RowBox[{"h2", "\[Rule]", " ", "0"}], ",", " ", 
            RowBox[{"p1", "\[Rule]", "0"}], ",", 
            RowBox[{"p2", "\[Rule]", "0"}], ",", 
            RowBox[{"t1", "\[Rule]", "0"}], ",", 
            RowBox[{"t2", "\[Rule]", "0"}], ",", 
            RowBox[{"d", "\[Rule]", "0"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"annEfficiency", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"h1", " ", "+", " ", "h2"}], ")"}], " ", "//.", " ", 
          "result"}], ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"readState", "[", 
           RowBox[{"annealingInput", ",", "t1"}], "]"}], " ", "+", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingInput", ",", "t2"}], "]"}]}], ")"}]}], " ", "//",
        " ", "Quiet"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"suppress", " ", "division", " ", "by", " ", "zero"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"annEfficiency", " ", "===", " ", "Indeterminate"}], ",", " ", 
       RowBox[{"annEfficiency", " ", "=", " ", "0"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"preempt", "[", 
       RowBox[{"result", ",", " ", "annealingInput"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"preempt", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Epsilon]Ann", " ", "\[Rule]", " ", "annEfficiency"}], 
         "}"}], ",", " ", "result"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "//", " ", "makeState"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"annealEquilibrium", "[", 
  RowBox[{
   RowBox[{"state0", "[", "]"}], ",", " ", "constants"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"annealEquilibrium", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "\[Rule]", "0"}], ",", " ", 
     RowBox[{"p2", "\[Rule]", "0"}], ",", " ", 
     RowBox[{"t1", " ", "\[Rule]", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}]}], ",", " ", 
     RowBox[{"t2", "\[Rule]", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}]}]}], "}"}], ",", " ", "constants"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6344350112349296`*^9, 3.6344350305100317`*^9}, {
   3.634437387533846*^9, 3.6344373879008675`*^9}, {3.6344381566878395`*^9, 
   3.634438201479401*^9}, {3.6344382971918755`*^9, 3.6344383259095182`*^9}, {
   3.6344383799156075`*^9, 3.634438408063217*^9}, {3.634438443478243*^9, 
   3.6344384446783113`*^9}, {3.634438679172724*^9, 3.634438681164838*^9}, {
   3.634438760676385*^9, 3.63443876355555*^9}, {3.6344388028457975`*^9, 
   3.634438898467266*^9}, {3.634438984707199*^9, 3.6344390489168715`*^9}, {
   3.634439097953676*^9, 3.634439098489707*^9}, {3.6344391489135914`*^9, 
   3.6344391533298435`*^9}, {3.634439356408459*^9, 3.634439395214679*^9}, {
   3.6344395483184357`*^9, 3.6344395486304536`*^9}, {3.634439595302123*^9, 
   3.634439639518652*^9}, 3.6344397214863405`*^9, {3.6344398187969065`*^9, 
   3.6344400586756268`*^9}, {3.634440144642544*^9, 3.634440165770752*^9}, {
   3.634440195994481*^9, 3.6344401966035156`*^9}, {3.634440229458395*^9, 
   3.634440381857112*^9}, {3.634440427096699*^9, 3.6344405112565126`*^9}, {
   3.6344807924396844`*^9, 3.6344807938796864`*^9}, {3.6344881220716085`*^9, 
   3.63448813785363*^9}, {3.6344884804410286`*^9, 3.634488492232045*^9}, {
   3.6344886734243*^9, 3.6344886826053133`*^9}, {3.634488997759083*^9, 
   3.634489008820098*^9}, {3.6344894267805*^9, 3.634489428050502*^9}, {
   3.6344974529487133`*^9, 3.634497461128724*^9}, {3.634577131370632*^9, 
   3.634577136271639*^9}, 3.6346678169726562`*^9, {3.6348622721926203`*^9, 
   3.6348622999922104`*^9}, {3.634921334367488*^9, 3.634921336629492*^9}, {
   3.635095901032426*^9, 3.6350959078408146`*^9}, {3.635101876015175*^9, 
   3.635101908046007*^9}, {3.63513145996628*^9, 3.6351315643812523`*^9}, {
   3.635131603229474*^9, 3.635131711164648*^9}, {3.6351318191318235`*^9, 
   3.6351318193958387`*^9}, {3.6351727776069326`*^9, 
   3.6351728868705244`*^9}, {3.6351729292089987`*^9, 
   3.6351729313306026`*^9}, {3.635188333583847*^9, 3.6351883636795683`*^9}, {
   3.635214097260445*^9, 3.6352141294032836`*^9}, {3.635214370162054*^9, 
   3.6352143748393216`*^9}, {3.635214437417901*^9, 3.6352144958072405`*^9}, {
   3.6352147515038657`*^9, 3.635214762695506*^9}, {3.6352147931122456`*^9, 
   3.63521480087969*^9}, {3.6352148414000072`*^9, 3.6352150923573613`*^9}, {
   3.6352151435412893`*^9, 3.635215328515869*^9}, {3.6352154426743984`*^9, 
   3.6352154540350485`*^9}, {3.635215514330497*^9, 3.635215557585971*^9}, {
   3.6355371735201654`*^9, 3.635537175990169*^9}, {3.635546659124894*^9, 
   3.6355466813579254`*^9}, {3.6355574836620526`*^9, 3.6355575112850914`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"d", "\[Rule]", "9.997980506688289`*^-11"}], ",", 
   RowBox[{"e", "\[Rule]", "2.4`*^-7"}], ",", 
   RowBox[{"h1", "\[Rule]", "9.999994445841764`*^-13"}], ",", 
   RowBox[{"h2", "\[Rule]", "9.999185054119554`*^-13"}], ",", 
   RowBox[{"p1", "\[Rule]", "9.998990201954884`*^-7"}], ",", 
   RowBox[{"p2", "\[Rule]", "9.998990202764277`*^-7"}], ",", 
   RowBox[{"t1", "\[Rule]", "5.553048012529871`*^-19"}], ",", 
   RowBox[{"t1Start", "\[Rule]", "1.`*^-12"}], ",", 
   RowBox[{"t2", "\[Rule]", "8.149458804462828`*^-17"}], ",", 
   RowBox[{"t2Start", "\[Rule]", "1.`*^-12"}], ",", 
   RowBox[{"\[Epsilon]Ann", "\[Rule]", "0.9999589749980659`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.657307652222102*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"d", "\[Rule]", "0"}], ",", 
   RowBox[{"h1", "\[Rule]", "0"}], ",", 
   RowBox[{"h2", "\[Rule]", "0"}], ",", 
   RowBox[{"p1", "\[Rule]", "0"}], ",", 
   RowBox[{"p2", "\[Rule]", "0"}], ",", 
   RowBox[{"t1", "\[Rule]", 
    FractionBox["1", "1000000"]}], ",", 
   RowBox[{"t2", "\[Rule]", 
    FractionBox["1", "1000000"]}], ",", 
   RowBox[{"\[Epsilon]Ann", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6573076522871227`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Michaelis Menton Reactions", "Subsubsection",
 CellChangeTimes->{{3.635100055457045*^9, 3.635100062048422*^9}}],

Cell["\<\
The reactions are classic. Note that we have two sets, one for each hybrid \
(h1 and h2). We also have competition with accumulated amplicons. Note that \
we list the reactions here rather than in the \[OpenCurlyQuote]Extension \
Model\[CloseCurlyQuote] section as we need them to handle the case where we \
do both extension and annealing in the \[OpenCurlyQuote]Kinetic Annealing \
Model\[CloseCurlyQuote].\
\>", "Text",
 CellChangeTimes->{{3.635197103456455*^9, 3.635197147528976*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"michaelisMentionReactions", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"e", " ", "+", " ", "h1"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "koff1", "kon1"], " ", "eh1"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"eh1", " ", 
      OverscriptBox["\[RightArrow]", "kcat1"], " ", 
      RowBox[{"e", "+", "u"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", " ", "+", " ", "h2"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "koff2", "kon2"], " ", "eh2"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"eh2", " ", 
      OverscriptBox["\[RightArrow]", "kcat2"], 
      RowBox[{"e", "+", "u"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", " ", "+", " ", "u"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "koff3", "kon3"], " ", "eu"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", " ", "+", " ", "d"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "koff4", "kon4"], " ", "ed"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extensionMichaelisMentionDiffEqs", " ", "=", " ", 
   RowBox[{"rateEqns", "[", 
    RowBox[{"michaelisMentionReactions", ",", " ", "\[Tau]", ",", " ", 
     RowBox[{"WasteSpecies", " ", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "//", " ", "Column"}], " ", "//", " ", 
  "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.6348650167976027`*^9, 3.6348650230939627`*^9}, {
   3.6348656456965733`*^9, 3.6348656466166263`*^9}, 3.6348657415280547`*^9, 
   3.6348657775281143`*^9, {3.635008989643858*^9, 3.635009025786909*^9}, {
   3.6350158639096603`*^9, 3.635015894073703*^9}, 3.635017749314889*^9, {
   3.6355372014022045`*^9, 3.635537218644229*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinetic Annealing Model", "Subsubsection",
 CellChangeTimes->{{3.6344809110048513`*^9, 3.634480913554855*^9}, {
  3.6348623371103334`*^9, 3.634862338510413*^9}}],

Cell["We have the fundamental annealing reactions from the paper.", "Text",
 CellChangeTimes->{{3.6344885044340625`*^9, 3.6344885073140664`*^9}, {
  3.634571544308897*^9, 3.6345715532689095`*^9}, {3.635099878577928*^9, 
  3.6350998882344804`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kineticAnnealingReactions", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"p1", " ", "+", " ", "t1"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "koffh1", "konh1"], " ", "h1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p2", " ", "+", " ", "t2"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "koffh2", "konh2"], " ", "h2"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t1", " ", "+", " ", "t2"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "koffu", "konu"], " ", "u"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p1", " ", "+", "p2"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "koffd", "kond"], " ", "d"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kineticEqns", " ", "=", " ", 
   RowBox[{"rateEqns", "[", 
    RowBox[{"kineticAnnealingReactions", ",", "  ", "\[Tau]", ",", " ", 
     RowBox[{"WasteSpecies", " ", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kineticEqns", "//", " ", "Column"}], " ", "//", " ", 
  "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.634950655945882*^9, 3.6349508314709215`*^9}, {
   3.6349510597409773`*^9, 3.6349510636612015`*^9}, {3.6349511608367596`*^9, 
   3.6349511699402804`*^9}, {3.635009072442974*^9, 3.635009117547038*^9}, 
   3.635356624762347*^9, 3.6353566556036015`*^9, {3.6353566907504625`*^9, 
   3.635356718752512*^9}, {3.635356781356422*^9, 3.635356853680149*^9}}],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "\[Prime]",
         MultilineFunction->None], "(", "\[Tau]", ")"}], "\[LongEqual]", 
       RowBox[{
        RowBox[{"kond", " ", 
         RowBox[{"p1", "(", "\[Tau]", ")"}], " ", 
         RowBox[{"p2", "(", "\[Tau]", ")"}]}], "-", 
        RowBox[{"koffd", " ", 
         RowBox[{"d", "(", "\[Tau]", ")"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["h1", "\[Prime]",
         MultilineFunction->None], "(", "\[Tau]", ")"}], "\[LongEqual]", 
       RowBox[{
        RowBox[{"konh1", " ", 
         RowBox[{"p1", "(", "\[Tau]", ")"}], " ", 
         RowBox[{"t1", "(", "\[Tau]", ")"}]}], "-", 
        RowBox[{"koffh1", " ", 
         RowBox[{"h1", "(", "\[Tau]", ")"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["h2", "\[Prime]",
         MultilineFunction->None], "(", "\[Tau]", ")"}], "\[LongEqual]", 
       RowBox[{
        RowBox[{"konh2", " ", 
         RowBox[{"p2", "(", "\[Tau]", ")"}], " ", 
         RowBox[{"t2", "(", "\[Tau]", ")"}]}], "-", 
        RowBox[{"koffh2", " ", 
         RowBox[{"h2", "(", "\[Tau]", ")"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["p1", "\[Prime]",
         MultilineFunction->None], "(", "\[Tau]", ")"}], "\[LongEqual]", 
       RowBox[{
        RowBox[{"koffd", " ", 
         RowBox[{"d", "(", "\[Tau]", ")"}]}], "+", 
        RowBox[{"koffh1", " ", 
         RowBox[{"h1", "(", "\[Tau]", ")"}]}], "-", 
        RowBox[{"kond", " ", 
         RowBox[{"p1", "(", "\[Tau]", ")"}], " ", 
         RowBox[{"p2", "(", "\[Tau]", ")"}]}], "-", 
        RowBox[{"konh1", " ", 
         RowBox[{"p1", "(", "\[Tau]", ")"}], " ", 
         RowBox[{"t1", "(", "\[Tau]", ")"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["p2", "\[Prime]",
         MultilineFunction->None], "(", "\[Tau]", ")"}], "\[LongEqual]", 
       RowBox[{
        RowBox[{"koffd", " ", 
         RowBox[{"d", "(", "\[Tau]", ")"}]}], "+", 
        RowBox[{"koffh2", " ", 
         RowBox[{"h2", "(", "\[Tau]", ")"}]}], "-", 
        RowBox[{"kond", " ", 
         RowBox[{"p1", "(", "\[Tau]", ")"}], " ", 
         RowBox[{"p2", "(", "\[Tau]", ")"}]}], "-", 
        RowBox[{"konh2", " ", 
         RowBox[{"p2", "(", "\[Tau]", ")"}], " ", 
         RowBox[{"t2", "(", "\[Tau]", ")"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["t1", "\[Prime]",
         MultilineFunction->None], "(", "\[Tau]", ")"}], "\[LongEqual]", 
       RowBox[{
        RowBox[{"koffh1", " ", 
         RowBox[{"h1", "(", "\[Tau]", ")"}]}], "+", 
        RowBox[{"koffu", " ", 
         RowBox[{"u", "(", "\[Tau]", ")"}]}], "-", 
        RowBox[{"konh1", " ", 
         RowBox[{"p1", "(", "\[Tau]", ")"}], " ", 
         RowBox[{"t1", "(", "\[Tau]", ")"}]}], "-", 
        RowBox[{"konu", " ", 
         RowBox[{"t1", "(", "\[Tau]", ")"}], " ", 
         RowBox[{"t2", "(", "\[Tau]", ")"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["t2", "\[Prime]",
         MultilineFunction->None], "(", "\[Tau]", ")"}], "\[LongEqual]", 
       RowBox[{
        RowBox[{"koffh2", " ", 
         RowBox[{"h2", "(", "\[Tau]", ")"}]}], "+", 
        RowBox[{"koffu", " ", 
         RowBox[{"u", "(", "\[Tau]", ")"}]}], "-", 
        RowBox[{"konh2", " ", 
         RowBox[{"p2", "(", "\[Tau]", ")"}], " ", 
         RowBox[{"t2", "(", "\[Tau]", ")"}]}], "-", 
        RowBox[{"konu", " ", 
         RowBox[{"t1", "(", "\[Tau]", ")"}], " ", 
         RowBox[{"t2", "(", "\[Tau]", ")"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["u", "\[Prime]",
         MultilineFunction->None], "(", "\[Tau]", ")"}], "\[LongEqual]", 
       RowBox[{
        RowBox[{"konu", " ", 
         RowBox[{"t1", "(", "\[Tau]", ")"}], " ", 
         RowBox[{"t2", "(", "\[Tau]", ")"}]}], "-", 
        RowBox[{"koffu", " ", 
         RowBox[{"u", "(", "\[Tau]", ")"}]}]}]}]}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"], TraditionalForm]], "Output",
 CellChangeTimes->{3.657309449892105*^9}]
}, Open  ]],

Cell["\<\
We consider both kinetic annealing and Michaelis Mention reactions together.\
\>", "Text",
 CellChangeTimes->{{3.635100500045474*^9, 3.6351005194055815`*^9}, 
   3.6351019494033723`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kineticAnnealAndMMEqns", " ", "=", " ", 
   RowBox[{"rateEqns", "[", 
    RowBox[{
     RowBox[{
     "kineticAnnealingReactions", " ", "~", "Join", "~", " ", 
      "michaelisMentionReactions"}], ",", " ", "\[Tau]", ",", " ", 
     RowBox[{"WasteSpecies", " ", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kineticAnnealAndMMEqns", "//", " ", "Column"}], " ", "//", " ", 
  "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.6351005235608187`*^9, 3.6351005758708105`*^9}}],

Cell["\<\
We construct a function that executes the annealing step according to the \
kinetic model. Optionally, in can include extension activity, but at a \
reduced efficiency.\
\>", "Text",
 CellChangeTimes->{{3.634571747538397*^9, 3.6345717614394164`*^9}, {
  3.635129163227914*^9, 3.635129189779433*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"annealKinetic", "[", 
   RowBox[{"annealingInput_", ",", " ", "constants_", ",", " ", 
    RowBox[{"options_:", 
     RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "  ", 
     RowBox[{
     "\[Tau]Anneal", ",", " ", "extend", ",", " ", "diffeqs", ",", " ", 
      "inits", ",", " ", "consts", ",", " ", "eqns", ",", " ", "vars", ",", 
      " ", "soln", ",", " ", "result", ",", " ", "annEfficiency", " ", ",", 
      " ", "\[CapitalDelta]p1", ",", " ", "\[CapitalDelta]p2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"consts", " ", "=", " ", "constants"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"extend", " ", "=", " ", 
      RowBox[{"useExtendDuringAnneal", " ", "//.", " ", 
       RowBox[{"preempt", "[", 
        RowBox[{"options", ",", " ", 
         RowBox[{"{", 
          RowBox[{"useExtendDuringAnneal", " ", "\[Rule]", " ", "False"}], 
          "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"extend", ",", "\[IndentingNewLine]", 
       RowBox[{"consts", " ", "=", " ", 
        RowBox[{"preempt", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "polymeraseEfficiency", "\[Rule]", " ", 
            "polymeraseAnnealEfficiency"}], "}"}], ",", " ", "consts"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Tau]Anneal", " ", "=", " ", 
      RowBox[{"\[Tau]ann", " ", "//.", " ", "consts"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"diffeqs", " ", "=", " ", "kineticEqns"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inits", " ", "=", " ", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"h1", "[", "0", "]"}], " ", "\[Equal]", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", " ", "h1", ",", " ", "0"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"h2", "[", "0", "]"}], " ", "\[Equal]", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", " ", "h2", ",", " ", "0"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u", "[", "0", "]"}], " ", "\[Equal]", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", " ", "u", ",", " ", "0"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"d", "[", "0", "]"}], " ", "\[Equal]", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", " ", "d", ",", " ", "0"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p1", "[", "0", "]"}], " ", "\[Equal]", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", "p1", ",", " ", "0"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p2", "[", "0", "]"}], " ", "\[Equal]", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", "p2", ",", " ", "0"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t1", "[", "0", "]"}], " ", "\[Equal]", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", "t1", ",", " ", "0"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t2", "[", "0", "]"}], " ", "\[Equal]", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", "t2", ",", " ", "0"}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
       "h1", ",", " ", "h2", ",", " ", "u", ",", " ", "d", ",", " ", "p1", 
        ",", " ", "p2", ",", " ", "t1", " ", ",", "t2"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"extend", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"diffeqs", " ", "=", " ", "kineticAnnealAndMMEqns"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"inits", " ", "=", " ", 
         RowBox[{"inits", " ", "~", "Join", "~", " ", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"eh1", "[", "0", "]"}], " ", "\[Equal]", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", "eh1", ",", " ", "0"}], "]"}]}], 
            ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"eh2", "[", "0", "]"}], " ", "\[Equal]", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", "eh2", ",", " ", "0"}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"e", "[", "0", "]"}], " ", "==", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "e", ",", " ", "0"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"eu", "[", "0", "]"}], " ", "\[Equal]", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", "eu", ",", " ", "0"}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ed", "[", "0", "]"}], " ", "\[Equal]", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", "ed", ",", " ", "0"}], "]"}]}]}],
            "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vars", " ", "=", " ", 
         RowBox[{"vars", " ", "~", "Join", "~", " ", 
          RowBox[{"{", 
           RowBox[{
           "eh1", ",", " ", "eh2", ",", " ", "e", ",", "  ", "eu", ",", " ", 
            "ed"}], "}"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqns", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"diffeqs", " ", "//.", " ", "consts"}], ")"}], " ", "~", 
       "Join", "~", " ", "inits"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"soln", " ", "=", " ", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{"eqns", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", "\[Tau]", "]"}], "&"}], " ", "/@", " ", "vars"}],
          ",", " ", 
         RowBox[{"{", 
          RowBox[{"\[Tau]", ",", " ", "0", ",", " ", "\[Tau]Anneal"}], "}"}], 
         ",", " ", "\[IndentingNewLine]", 
         RowBox[{"AccuracyGoal", "\[Rule]", "MachinePrecision"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PrecisionGoal", "\[Rule]", "MachinePrecision"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MaxStepFraction", "\[Rule]", ".001"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", "\[Tau]", "]"}], " ", "/.", " ", "soln"}], 
             ")"}], " ", "/.", " ", 
            RowBox[{"\[Tau]", "\[Rule]", "\[Tau]Anneal"}]}], ")"}]}], "&"}], "/@",
         " ", "vars"}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"preempt", "[", 
       RowBox[{"result", ",", " ", "annealingInput"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"We", "'"}], "ll", " ", "use", " ", "an", " ", "annealing", 
        " ", "efficiency", " ", "cacluation", " ", "which", " ", "is", " ", 
        "equivalent", " ", "to", " ", "the", " ", "below"}], ",", " ", 
       RowBox[{
       "but", " ", "also", " ", "works", " ", "in", " ", "the", " ", 
        "extension", " ", "case", " ", "too"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Essentially", " ", "waht", " ", "we", " ", "do", " ", "is", " ", 
       "figure", " ", "out", " ", "how", " ", "many", " ", "free", " ", 
       "primers", " ", 
       RowBox[{"we", "'"}], "ve", " ", "lost", " ", "to", " ", "everything", 
       " ", "except", " ", "primer", " ", 
       RowBox[{"dimers", ".", " ", "Those"}], " ", "must", " ", "have"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"hybridized", ",", " ", 
       RowBox[{
       "and", " ", "either", " ", "still", " ", "be", " ", "hybrids", " ", 
        "or", " ", "have", " ", "been", " ", "extended", " ", "into", " ", 
        "duplex", " ", "amplicons"}], ",", " ", 
       RowBox[{"and", " ", 
        RowBox[{"so", ":", " ", 
         RowBox[{
         "be", " ", "the", " ", "amount", " ", "of", " ", "hybrids", " ", 
          RowBox[{"formed", "."}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Divided", " ", "by", " ", "the", " ", "total", " ", "template", " ", 
        "targets", " ", "we", " ", "have"}], ",", " ", 
       RowBox[{"and", " ", "we", " ", "get", " ", "the", " ", "efficiency"}], 
       ",", " ", 
       RowBox[{
       "just", " ", "as", " ", "in", " ", "eqn", " ", "31", " ", "in", " ", 
        "the", " ", "paper"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"annEfficiency", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"h2", " ", "+", " ", "h2"}], ")"}], " ", "//.", " ", 
           "result"}], ")"}], " ", "/", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"readState", "[", 
            RowBox[{"annealingInput", ",", "t1"}], "]"}], " ", "+", " ", 
           RowBox[{"readState", "[", 
            RowBox[{"annealingInput", ",", "t2"}], "]"}]}], ")"}]}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]p1", " ", "=", " ", 
      RowBox[{
       RowBox[{"readState", "[", 
        RowBox[{"annealingInput", ",", "p1"}], "]"}], "-", " ", 
       RowBox[{"(", 
        RowBox[{"p1", " ", "//.", " ", "result"}], ")"}], " ", "-", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", " ", "//.", " ", "result"}], ")"}], " ", "-", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", " ", "d"}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]p2", " ", "=", " ", 
      RowBox[{
       RowBox[{"readState", "[", 
        RowBox[{"annealingInput", ",", "p2"}], "]"}], " ", "-", " ", 
       RowBox[{"(", 
        RowBox[{"p2", " ", "//.", " ", "result"}], ")"}], " ", "-", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", " ", "//.", " ", "result"}], ")"}], " ", "-", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", " ", "d"}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"annEfficiency", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[CapitalDelta]p1", " ", "+", " ", "\[CapitalDelta]p2"}], 
         ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"readState", "[", 
           RowBox[{"annealingInput", ",", "t1"}], "]"}], " ", "+", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingInput", ",", "t2"}], "]"}]}], ")"}]}], " ", "//",
        " ", "Quiet"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"annEfficiency", "===", "Indeterminate"}], ",", " ", 
       RowBox[{"annEfficiency", "=", "0"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"preempt", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Epsilon]Ann", " ", "\[Rule]", " ", "annEfficiency"}], 
         "}"}], ",", " ", "result"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "//", " ", "makeState"}]}]}], " ", 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"annealKinetic", "[", 
   RowBox[{
    RowBox[{"state0", "[", "]"}], ",", " ", 
    RowBox[{"preempt", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", " ", "constants"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"useExtendDuringAnneal", " ", "\[Rule]", " ", "False"}], "}"}]}],
    "]"}], " ", "//", "Sort"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"annealKinetic", "[", 
   RowBox[{
    RowBox[{"state0", "[", "]"}], ",", " ", 
    RowBox[{"preempt", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", " ", "constants"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"useExtendDuringAnneal", " ", "\[Rule]", " ", "True"}], "}"}]}], 
   "]"}], " ", "//", " ", "Sort"}]}], "Input",
 CellChangeTimes->{{3.634571774521435*^9, 3.634571825227506*^9}, {
   3.6345719142372336`*^9, 3.634571965913306*^9}, {3.6345719980063515`*^9, 
   3.6345720373694067`*^9}, {3.6345720899034805`*^9, 
   3.6345721104455094`*^9}, {3.634572142636555*^9, 3.6345722702297354`*^9}, {
   3.6345723398958335`*^9, 3.6345723427768373`*^9}, {3.634572376688885*^9, 
   3.6345726237152324`*^9}, {3.6345729275435*^9, 3.6345729284435015`*^9}, {
   3.634572958726544*^9, 3.634573001079603*^9}, 3.6345738253463397`*^9, {
   3.634574129795768*^9, 3.634574156118805*^9}, {3.6345742301659093`*^9, 
   3.6345742437979283`*^9}, {3.6345743279970465`*^9, 3.634574348558076*^9}, {
   3.6345746968875685`*^9, 3.634574766403666*^9}, {3.634574871306815*^9, 
   3.6345748886278396`*^9}, {3.6345749221698866`*^9, 3.634574922329887*^9}, {
   3.634575002471504*^9, 3.6345750230225334`*^9}, 3.6345750878186245`*^9, {
   3.6345754193491583`*^9, 3.6345754260091677`*^9}, {3.6345771813507032`*^9, 
   3.634577182451705*^9}, {3.6345772561218085`*^9, 3.6345772600618143`*^9}, 
   3.634667845837307*^9, {3.634696915280466*^9, 3.634696975223894*^9}, {
   3.6346971315828376`*^9, 3.634697177854484*^9}, 3.634697212662475*^9, {
   3.6346973614209833`*^9, 3.6346973648851814`*^9}, {3.63469742552465*^9, 
   3.6346974669160175`*^9}, 3.634697612053319*^9, {3.6347369633980875`*^9, 
   3.634736963574097*^9}, {3.6348620549621954`*^9, 3.6348621236901264`*^9}, {
   3.6348621859536877`*^9, 3.634862232793367*^9}, {3.6350208425102544`*^9, 
   3.6350208467502604`*^9}, {3.6350213928400307`*^9, 
   3.6350214413950987`*^9}, {3.635021526258218*^9, 3.635021527068219*^9}, {
   3.635021573386285*^9, 3.635021581477296*^9}, {3.635021647884389*^9, 
   3.6350216480643897`*^9}, {3.635095920536541*^9, 3.635095924936793*^9}, {
   3.635099772333851*^9, 3.635099837367571*^9}, {3.635099909887719*^9, 
   3.6350999214693813`*^9}, {3.635099955613334*^9, 3.6350999935945063`*^9}, {
   3.635100112324298*^9, 3.6351004311155314`*^9}, {3.6351006024583316`*^9, 
   3.6351006238225536`*^9}, {3.6351007252213535`*^9, 
   3.6351007436944103`*^9}, {3.6351007892690163`*^9, 
   3.6351008008296776`*^9}, {3.63510085664787*^9, 3.635100858355968*^9}, {
   3.635100907111757*^9, 3.6351009103649426`*^9}, {3.6351009665351553`*^9, 
   3.635101106747175*^9}, {3.6351011367548914`*^9, 3.635101137378927*^9}, {
   3.635101191590028*^9, 3.6351014112055893`*^9}, {3.6351014845727854`*^9, 
   3.6351015914118967`*^9}, {3.635101978245022*^9, 3.6351019877855678`*^9}, {
   3.63510237053446*^9, 3.6351023981750407`*^9}, {3.63510249606164*^9, 
   3.6351025880939035`*^9}, {3.635102635957641*^9, 3.6351026785170755`*^9}, {
   3.635102749772151*^9, 3.6351027499561615`*^9}, {3.635129198192914*^9, 
   3.635129234649999*^9}, {3.635130628693734*^9, 3.635130631525896*^9}, {
   3.635130812068222*^9, 3.6351308574758196`*^9}, {3.635130900119259*^9, 
   3.6351309096268024`*^9}, {3.635130941366618*^9, 3.6351309623368177`*^9}, {
   3.635131005469284*^9, 3.63513104262941*^9}, 3.635131292621709*^9, 
   3.635131928578083*^9, {3.6351884118233223`*^9, 3.635188426191144*^9}, {
   3.6352127932958627`*^9, 3.6352128892163486`*^9}, {3.635212928448593*^9, 
   3.6352129928872786`*^9}, {3.635216177969455*^9, 3.6352162019128246`*^9}, {
   3.635259026468249*^9, 3.635259048571513*^9}, {3.635537231485247*^9, 
   3.6355372607182884`*^9}, {3.6355465615337563`*^9, 3.635546576634778*^9}, 
   3.635546636672862*^9, {3.6355575686181726`*^9, 3.635557604348223*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extension Model", "Subsection",
 CellChangeTimes->{{3.6344315933414373`*^9, 3.634431595605567*^9}}],

Cell[CellGroupData[{

Cell["Gevertz et al.", "Subsubsection",
 CellChangeTimes->{{3.634846565477247*^9, 3.634846574669773*^9}}],

Cell["\<\
Here we implement the extension model as described in the paper by Gevertz et \
al, in section \[OpenCurlyDoubleQuote]Step 3\[CloseCurlyDoubleQuote]. We \
begin by analysing the differential equation 28 from the paper, solving it \
symbolically, once, so we don\[CloseCurlyQuote]t have to recompute that each \
and every cycle.\
\>", "Text",
 CellChangeTimes->{{3.634488518357082*^9, 3.6344885655211487`*^9}, {
  3.6345001475215034`*^9, 3.6345001557025146`*^9}, {3.634501540703477*^9, 
  3.63450158546854*^9}, {3.6345016166505837`*^9, 3.634501617351585*^9}, {
  3.6348465859414177`*^9, 3.6348465917887526`*^9}, {3.6348466343251853`*^9, 
  3.6348466595406275`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"extensionAnalysis", "[", 
   RowBox[{"sT_", ",", " ", "\[Tau]_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"diffeq", ",", " ", "s", ",", " ", "soln", ",", " ", "vmax"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"diffeq", " ", "=", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"s", "[", "\[Tau]", "]"}], ",", "\[Tau]"}], "]"}]}], " ", 
       "\[Equal]", " ", 
       RowBox[{"vmax", " ", 
        RowBox[{
         RowBox[{"s", "[", "\[Tau]", "]"}], " ", "/", " ", 
         RowBox[{"(", 
          RowBox[{"km", " ", "+", " ", 
           RowBox[{"s", "[", "\[Tau]", "]"}]}], ")"}]}]}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"eqn", " ", "28"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"soln", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"DSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"diffeq", ",", " ", 
            RowBox[{
             RowBox[{"s", "[", "0", "]"}], "\[Equal]", "sT"}]}], "}"}], ",", 
          " ", 
          RowBox[{"s", "[", "\[Tau]", "]"}], ",", " ", "\[Tau]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "Quiet"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", "[", "\[Tau]", "]"}], " ", "/.", " ", 
      RowBox[{"(", 
       RowBox[{"soln", " ", "/.", " ", 
        RowBox[{"vmax", " ", "\[Rule]", " ", 
         RowBox[{"kcat", " ", "*", " ", "e"}]}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"sAnalysis", " ", "=", " ", 
  RowBox[{"extensionAnalysis", "[", 
   RowBox[{"sT", ",", " ", "\[Tau]ext"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.63449673751966*^9, 3.6344967877537303`*^9}, {
   3.634496821756778*^9, 3.6344969190459146`*^9}, {3.6344969513499603`*^9, 
   3.6344970664591217`*^9}, {3.6344971103951836`*^9, 3.634497171380269*^9}, {
   3.6344972908024855`*^9, 3.634497407312649*^9}, {3.634497516164802*^9, 
   3.6344977341981087`*^9}, {3.634497812907219*^9, 3.634497894035333*^9}, {
   3.6344979248683767`*^9, 3.634497929438383*^9}, {3.6344981296826644`*^9, 
   3.634498167105717*^9}, {3.6344982805078764`*^9, 3.634498337833957*^9}, {
   3.634498381809019*^9, 3.634498409092057*^9}, {3.6344985158722076`*^9, 
   3.6344985750772905`*^9}, {3.634498630143368*^9, 3.6344986364933767`*^9}, 
   3.634498726176504*^9, {3.6344987652905593`*^9, 3.634498853139683*^9}, {
   3.634498885883729*^9, 3.6344989586228313`*^9}, 3.634499138414084*^9, {
   3.6344992689972677`*^9, 3.6344993615373974`*^9}, {3.634499394430444*^9, 
   3.6344994431345124`*^9}, {3.634499481713567*^9, 3.634499631285777*^9}, {
   3.6344996639788227`*^9, 3.63449969075086*^9}, {3.6344997428359337`*^9, 
   3.634499987901278*^9}, {3.634500062858383*^9, 3.6345000665083885`*^9}, 
   3.6345001391204915`*^9, {3.634656030021838*^9, 3.6346560336018434`*^9}}],

Cell["With that in hand, the extension efficiency can be computed.", "Text",
 CellChangeTimes->{{3.634501623802594*^9, 3.634501636733612*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"extensionEfficiencyGevertz", "[", 
   RowBox[{"annealingOutput_", ",", " ", "constants_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sTT", ",", " ", "s", ",", " ", "vmax", ",", " ", "eqn30", ",", " ", 
      "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sTT", " ", "=", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"readState", "[", 
         RowBox[{"annealingOutput", ",", "h1"}], "]"}], " ", "+", " ", 
        RowBox[{"readState", "[", 
         RowBox[{"annealingOutput", ",", "h2"}], "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"sAnalysis", " ", "/.", " ", 
         RowBox[{"sT", " ", "\[Rule]", " ", "sTT"}]}], " ", "/.", " ", 
        "constants"}], " ", "/.", " ", 
       RowBox[{"e", " ", "\[Rule]", " ", 
        RowBox[{"readState", "[", 
         RowBox[{"annealingOutput", ",", "e"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"sTT", " ", "-", "s"}], ")"}], " ", "/", " ", "sTT"}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{"eqn", " ", "32"}], " ", "*)"}], " ", "//", " ", "Quiet"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"result", " ", "===", " ", "Indeterminate"}], ",", " ", 
       RowBox[{"result", " ", "=", " ", "0"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"extensionEfficiencyGevertz", "[", 
  RowBox[{
   RowBox[{"annealKinetic", "[", 
    RowBox[{
     RowBox[{"state0", "[", "]"}], ",", " ", "constants"}], "]"}], ",", " ", 
   "constants"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6344885504801273`*^9, 3.634488621318227*^9}, 
   3.634488995388079*^9, {3.634489343631383*^9, 3.634489345172385*^9}, {
   3.6344934285668344`*^9, 3.634493430036837*^9}, {3.63449383346187*^9, 
   3.6344941157042675`*^9}, {3.634494165888338*^9, 3.634494173009348*^9}, {
   3.6344942070823956`*^9, 3.634494269150483*^9}, {3.634494569309998*^9, 
   3.6344945977840385`*^9}, {3.634494662230129*^9, 3.634494683532159*^9}, 
   3.6344956981361427`*^9, {3.6344990014678917`*^9, 3.634499001857892*^9}, {
   3.6345000573573756`*^9, 3.634500130520479*^9}, {3.63450164942663*^9, 
   3.6345016541166363`*^9}, {3.6345733188316264`*^9, 3.634573319661628*^9}, {
   3.6345753747940955`*^9, 3.634575375384096*^9}, 3.6345755707403708`*^9, {
   3.6345764310375805`*^9, 3.6345764312875805`*^9}, {3.6345772823848457`*^9, 
   3.6345773114568863`*^9}, 3.634655894160647*^9, {3.6346564501904306`*^9, 
   3.6346564506104307`*^9}, 3.63465747804989*^9, {3.634662069704929*^9, 
   3.6346620700325294`*^9}, 3.6346693427704086`*^9, {3.634672418987358*^9, 
   3.6346724193163767`*^9}, {3.634674259358621*^9, 3.634674311382597*^9}, 
   3.634674361806481*^9, {3.634674392086213*^9, 3.6346744162535954`*^9}, {
   3.634674578388869*^9, 3.6346746603965592`*^9}, 3.6346747062551823`*^9, {
   3.6346748317223587`*^9, 3.634674940618587*^9}, {3.6346947320385914`*^9, 
   3.6346947599421873`*^9}, {3.634696824816292*^9, 3.6346968259273553`*^9}, {
   3.6348465482592626`*^9, 3.634846548265263*^9}, {3.635173349967526*^9, 
   3.6351733530563316`*^9}, 3.6351734043024216`*^9, {3.6352156793349347`*^9, 
   3.635215702231244*^9}, {3.6352157340390635`*^9, 3.635215805450148*^9}}],

Cell["\<\
We compute the result of the extension step (which becomes, after an implicit \
denaturing, the input to the next annealing step). Note that this can be \
modified to support one of three different enzyme degredation models.\
\>", "Text",
 CellChangeTimes->{{3.6344886500722675`*^9, 3.634488653522272*^9}, {
  3.6344886863853188`*^9, 3.6344887198203654`*^9}, {3.6344889400120015`*^9, 
  3.634488959464029*^9}, {3.634501681559675*^9, 3.634501703562706*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"extensionStepGevertz", "[", 
   RowBox[{"annealingOutputA_", ",", " ", "constants_", ",", " ", 
    RowBox[{"options_:", " ", 
     RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"annealingOutput", ",", " ", "extEfficiency"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Free", " ", "up", " ", "any", " ", "eh1", " ", "and", " ", "eh2", " ", 
       "complexes", " ", "to", " ", "fit", " ", "into", " ", "the", " ", 
       "Gevertz", " ", 
       RowBox[{"model", ".", " ", 
        RowBox[{"Shouldn", "'"}]}], "t", " ", "actually", " ", "*", "be", "*",
        " ", "any"}], ";", " ", 
      RowBox[{
       RowBox[{"we", "'"}], "re", " ", "just", " ", "being", " ", 
       RowBox[{"complete", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"annealingOutput", " ", "=", " ", 
      RowBox[{"preempt", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"h1", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "h1"}], "]"}], " ", "+", 
            " ", 
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "eh1"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"h2", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "h2"}], "]"}], " ", "+", 
            " ", 
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "eh2"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"e", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "e"}], "]"}], " ", "+", 
            " ", 
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "eh1"}], "]"}], " ", "+", 
            " ", 
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "eh2"}], "]"}], " ", "+", 
            " ", 
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "ed"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"eh1", " ", "\[Rule]", " ", "0"}], ",", " ", 
          RowBox[{"eh2", " ", "\[Rule]", " ", "0"}], ",", " ", 
          RowBox[{"ed", "\[Rule]", " ", "0"}]}], "\[IndentingNewLine]", "}"}],
         ",", " ", "annealingOutputA"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"now", " ", 
       RowBox[{"it", "'"}], "s", " ", 
       RowBox[{"simple", ":", " ", 
        RowBox[{
        "h1", " ", "and", " ", "h2", " ", "extend", " ", "at", " ", "the", 
         " ", "computed", " ", "efficiency"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"extEfficiency", " ", "=", " ", 
      RowBox[{"extensionEfficiencyGevertz", "[", 
       RowBox[{"annealingOutput", ",", " ", "constants"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"preempt", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"h1", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", " ", "-", " ", "extEfficiency"}], ")"}], " ", 
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutput", ",", "h1"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"h2", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", " ", "-", " ", "extEfficiency"}], ")"}], " ", 
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutput", ",", "h2"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"u", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutput", ",", " ", "u"}], "]"}], " ", "+", " ", 
            RowBox[{"extEfficiency", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingOutput", ",", "h2"}], "]"}]}], " ", "+", "  ", 
            RowBox[{"extEfficiency", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingOutput", ",", "h1"}], "]"}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Epsilon]Ext", " ", "\[Rule]", " ", "extEfficiency"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        "annealingOutput"}], "\[IndentingNewLine]", "]"}], "  ", "//", " ", 
      "makeState"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"extensionStepGevertz", "[", 
  RowBox[{
   RowBox[{"annealEquilibrium", "[", 
    RowBox[{
     RowBox[{"state0", "[", "]"}], ",", "constants"}], "]"}], ",", " ", 
   "constants"}], "]"}]}], "Input",
 CellChangeTimes->{{3.634488963044034*^9, 3.6344889862170663`*^9}, {
   3.6344890259441223`*^9, 3.6344892409394245`*^9}, {3.634489277163289*^9, 
   3.634489315208343*^9}, {3.6344894392815175`*^9, 3.6344894402915187`*^9}, {
   3.634490104457263*^9, 3.6344901165282803`*^9}, {3.63449068844862*^9, 
   3.63449068848862*^9}, {3.634492945194155*^9, 3.6344929692561893`*^9}, {
   3.6344930628653207`*^9, 3.6344931004983735`*^9}, {3.6344931439434347`*^9, 
   3.634493182787489*^9}, {3.634493260059598*^9, 3.634493267849609*^9}, {
   3.6344933978537917`*^9, 3.634493437887848*^9}, {3.6344957550722227`*^9, 
   3.63449576718324*^9}, {3.634495896863423*^9, 3.634495904453433*^9}, {
   3.6345003719508195`*^9, 3.634500382882835*^9}, {3.6345004174168835`*^9, 
   3.6345005226080313`*^9}, {3.6345011088038673`*^9, 
   3.6345011088938675`*^9}, {3.634501707893712*^9, 3.6345017336567483`*^9}, 
   3.6345041132573414`*^9, {3.6345042540145397`*^9, 3.63450426862656*^9}, {
   3.634508819783537*^9, 3.6345088235747538`*^9}, {3.6345089614286385`*^9, 
   3.634508987869151*^9}, {3.6345090642695208`*^9, 3.6345090839336452`*^9}, {
   3.634577407147021*^9, 3.6345774698231087`*^9}, 3.634667910821024*^9, 
   3.6346723569818115`*^9, {3.634694505649643*^9, 3.6346945098258815`*^9}, {
   3.634694771607855*^9, 3.6346947717918653`*^9}, {3.6348467681998425`*^9, 
   3.634846768207843*^9}, {3.634861993762695*^9, 3.634862008835557*^9}, {
   3.634862386600164*^9, 3.634862460296379*^9}, {3.6349212736989813`*^9, 
   3.63492130151383*^9}, {3.6350224176552353`*^9, 3.6350224318512607`*^9}, {
   3.6350959553925347`*^9, 3.6350959588167305`*^9}, {3.635132000243182*^9, 
   3.635132012914907*^9}, {3.6351320536422367`*^9, 3.635132055658352*^9}, {
   3.6351734282016635`*^9, 3.6351735705217133`*^9}, {3.6351736007077665`*^9, 
   3.635173656977065*^9}, {3.6351884842144628`*^9, 3.635188494598057*^9}, {
   3.6351954816226916`*^9, 3.6351955987983932`*^9}, {3.6351956598858876`*^9, 
   3.635195879764464*^9}, {3.6351959184276752`*^9, 3.6351959276122007`*^9}, {
   3.6351965020480566`*^9, 3.635196525920422*^9}, {3.635196573103121*^9, 
   3.635196574863221*^9}, {3.635215639478655*^9, 3.6352156452469845`*^9}, {
   3.635215825717307*^9, 3.6352158277574244`*^9}, {3.6355467490660205`*^9, 
   3.6355467641680417`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Michaelis Menton extension model from first principles", "Subsubsection",
 CellChangeTimes->{{3.634864892115471*^9, 3.634864905364229*^9}, {
  3.635015784050548*^9, 3.6350157877205534`*^9}}],

Cell["\<\
The reactions are classic. Note that we have two sets, one for each hybrid \
(h1 and h2). We also have competition with accumulated amplicons.\
\>", "Text",
 CellChangeTimes->{{3.634864909003437*^9, 3.6348649620914736`*^9}, {
  3.63501579987157*^9, 3.635015857317651*^9}}],

Cell["\<\
Here, we compute the extension step by solving the Michaelis Menton \
differential equations from first principles. The actual differential \
equations were computed above.\
\>", "Text",
 CellChangeTimes->{{3.6348468008757114`*^9, 3.634846840818996*^9}, {
  3.6348524023640985`*^9, 3.634852406276322*^9}, {3.6348649881309633`*^9, 
  3.634865002667794*^9}}],

Cell[BoxData[
 RowBox[{"extensionMichaelisMentionDiffEqs", " ", "//", " ", 
  "ColumnForm"}]], "Input",
 CellChangeTimes->{{3.6355378756266546`*^9, 3.635537878837659*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"extensionStepMichaelisMention", "[", 
    RowBox[{"annealingOutput_", ",", "constants_", ",", " ", 
     RowBox[{"options_:", " ", 
      RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "\[Tau]Extension", ",", " ", "inits", ",", " ", "diffeqs", ",", " ", 
       "eqns", ",", " ", "soln", ",", " ", "h1Start", ",", " ", "h2Start", 
       ",", " ", "endOf", ",", "extEfficiency"}], " ", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Tau]Extension", " ", "=", " ", 
       RowBox[{"\[Tau]ext", " ", "//.", " ", "constants"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"diffeqs", " ", "=", " ", "extensionMichaelisMentionDiffEqs"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"h1Start", " ", "=", " ", 
       RowBox[{"readState", "[", 
        RowBox[{"annealingOutput", ",", " ", "h1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"h2Start", " ", "=", " ", 
       RowBox[{"readState", "[", 
        RowBox[{"annealingOutput", ",", " ", "h2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inits", " ", "=", " ", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"h1", "[", "0", "]"}], " ", "\[Equal]", " ", "h1Start"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"h2", "[", "0", "]"}], " ", "\[Equal]", " ", "h2Start"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"e", "[", "0", "]"}], " ", "\[Equal]", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingOutput", ",", "e"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eh1", "[", "0", "]"}], " ", "\[Equal]", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingOutput", ",", "eh1"}], "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eh2", "[", "0", "]"}], " ", "\[Equal]", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingOutput", ",", "eh2"}], "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"u", "[", "0", "]"}], " ", "\[Equal]", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingOutput", ",", " ", "u"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"d", "[", "0", "]"}], " ", "\[Equal]", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingOutput", ",", " ", "d"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eu", "[", "0", "]"}], " ", "\[Equal]", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingOutput", ",", "eu"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ed", "[", "0", "]"}], " ", "\[Equal]", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingOutput", ",", " ", "ed"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eqns", " ", "=", " ", 
       RowBox[{"diffeqs", " ", "~", "Join", "~", " ", "inits"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"soln", " ", "=", " ", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"eqns", " ", "//.", " ", "constants"}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", "\[Tau]", "]"}], "&"}], " ", "/@", " ", 
           RowBox[{"{", 
            RowBox[{
            "h1", ",", " ", "h2", ",", " ", "eh1", ",", " ", "eh2", ",", " ", 
             "e", ",", " ", "u", ",", " ", "d", ",", " ", "eu", ",", " ", 
             "ed"}], "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\[Tau]", ",", " ", "0", ",", " ", "\[Tau]Extension"}], 
           "}"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"AccuracyGoal", "\[Rule]", "MachinePrecision"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PrecisionGoal", "\[Rule]", "MachinePrecision"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MaxStepFraction", "\[Rule]", ".001"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"endOf", "[", "sym_", "]"}], " ", ":=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"sym", "[", "\[Tau]", "]"}], " ", "/.", " ", "soln"}], " ", "/.",
         " ", 
        RowBox[{"\[Tau]", " ", "\[Rule]", " ", "\[Tau]Extension"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Our", " ", "extension", " ", "efficiency", " ", "is", " ", "the", " ",
         "fraction", " ", "of", " ", "the", " ", "hybrids", " ", "that", " ", 
        "got", " ", "converted", " ", "during", " ", "the", " ", 
        "extension"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"extEfficiency", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"h1Start", " ", "+", " ", "h2Start"}], ")"}], " ", "-", 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"endOf", "[", "h1", "]"}], " ", "+", " ", 
             RowBox[{"endOf", "[", "h2", "]"}]}], ")"}]}], ")"}], " ", "/", 
         " ", 
         RowBox[{"(", 
          RowBox[{"h1Start", " ", "+", " ", "h2Start"}], ")"}]}], " ", "//", 
        " ", "Quiet"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"extEfficiency", "\[Equal]", "Indeterminate"}], ",", " ", 
        RowBox[{"extEfficiency", "=", "0"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"preempt", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"h1", " ", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "h1", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"h2", " ", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "h2", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"e", " ", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "e", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"eh1", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "eh1", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"eh2", " ", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "eh2", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"u", " ", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "u", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"d", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "d", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"eu", " ", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "eu", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ed", " ", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "ed", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\[Epsilon]Ext", " ", "\[Rule]", " ", "extEfficiency"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "annealingOutput"}], "]"}], " ", 
       "//", " ", "makeState"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extensionStepMichaelisMention", "[", 
   RowBox[{
    RowBox[{"annealKinetic", "[", 
     RowBox[{
      RowBox[{"state0", "[", "]"}], ",", " ", "constants"}], "]"}], ",", " ", 
    "constants"}], "]"}], " "}]}], "Input",
 CellChangeTimes->{{3.6348498236396036`*^9, 3.634849830030969*^9}, {
   3.6348498939916277`*^9, 3.6348502687180605`*^9}, {3.634850368797785*^9, 
   3.6348503738450737`*^9}, 3.634850524348682*^9, {3.6348510171448684`*^9, 
   3.6348510486566706`*^9}, {3.6348510844087152`*^9, 
   3.6348511596160173`*^9}, {3.6348512242047114`*^9, 
   3.6348512527253428`*^9}, {3.6348516730593843`*^9, 3.6348517221541924`*^9}, 
   3.634851823288977*^9, {3.6348518686485715`*^9, 3.634851921193577*^9}, {
   3.634851977234782*^9, 3.634851981411021*^9}, {3.6348521347857933`*^9, 
   3.634852142208218*^9}, {3.634852295709998*^9, 3.634852343734745*^9}, {
   3.634853025120718*^9, 3.6348532620392685`*^9}, 3.634853378535932*^9, {
   3.634853783126073*^9, 3.6348537872693105`*^9}, {3.6348538652097683`*^9, 
   3.634853928490388*^9}, {3.6348539683646684`*^9, 3.6348539753540683`*^9}, {
   3.634854036182547*^9, 3.6348540508153844`*^9}, {3.6348540828822184`*^9, 
   3.634854104714467*^9}, {3.634854148985999*^9, 3.63485416140971*^9}, {
   3.634854390863834*^9, 3.634854403998585*^9}, {3.634854466896183*^9, 
   3.634854732486374*^9}, {3.6348548090617533`*^9, 3.634854887342231*^9}, {
   3.6348608721965446`*^9, 3.63486092071332*^9}, {3.634860979906706*^9, 
   3.63486107387508*^9}, {3.6348611098821397`*^9, 3.6348611616421003`*^9}, {
   3.634861684935031*^9, 3.634861782803629*^9}, {3.634861832370464*^9, 
   3.6348619093018637`*^9}, {3.634862498913588*^9, 3.634862502605799*^9}, {
   3.6348634089786406`*^9, 3.6348634788956394`*^9}, {3.634863542922302*^9, 
   3.634863630626318*^9}, {3.634863663775214*^9, 3.6348638887570825`*^9}, {
   3.634864239645152*^9, 3.6348642421172934`*^9}, {3.634864339661873*^9, 
   3.6348643399578896`*^9}, {3.6349206853311353`*^9, 
   3.6349206989343596`*^9}, {3.634921159864581*^9, 3.634921183732623*^9}, {
   3.6350159641778016`*^9, 3.635015985081831*^9}, {3.6350160610289383`*^9, 
   3.6350160612389383`*^9}, {3.6350178283740005`*^9, 3.635017837367013*^9}, {
   3.635018401748808*^9, 3.6350184107198205`*^9}, {3.6350185728080487`*^9, 
   3.635018596729082*^9}, {3.6350222369601183`*^9, 3.6350222402517242`*^9}, {
   3.6350222847742023`*^9, 3.635022284961403*^9}, 3.635027418840468*^9, {
   3.635027580957741*^9, 3.635027593917482*^9}, {3.63502768549372*^9, 
   3.6350276856447287`*^9}, {3.635095977930824*^9, 3.6350959861382933`*^9}, {
   3.635102152631996*^9, 3.635102187728004*^9}, {3.6351292971285725`*^9, 
   3.6351293096482887`*^9}, 3.635129879675893*^9, {3.635129944372593*^9, 
   3.6351299610035443`*^9}, {3.635132119460001*^9, 3.635132163356512*^9}, {
   3.6351736923891277`*^9, 3.6351737367098055`*^9}, {3.63519655490908*^9, 
   3.63519660036868*^9}, {3.635196635320679*^9, 3.6351967592717686`*^9}, {
   3.6351967948798056`*^9, 3.6351967951358204`*^9}, {3.6351968921593695`*^9, 
   3.6351970789170513`*^9}, {3.635197283459751*^9, 3.635197304658963*^9}, {
   3.6351999570166693`*^9, 3.6351999934167514`*^9}, {3.63521624239814*^9, 
   3.6352162638263655`*^9}, {3.6353865788949842`*^9, 3.635386603829019*^9}, {
   3.635537268219299*^9, 3.6355372919533324`*^9}, {3.635537905301696*^9, 
   3.6355379428357487`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Denaturing Model", "Subsection",
 CellChangeTimes->{{3.6351731556277966`*^9, 3.6351731594966035`*^9}}],

Cell["\<\
We explicitly model the denaturing by breaking apart all DNA complexes and \
disassociating the enzyme from anything it might be attached to. We also \
account for enzyme degredation.\
\>", "Text",
 CellChangeTimes->{{3.6351975304138756`*^9, 3.6351975738773613`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"denature", "[", 
   RowBox[{"state_", ",", " ", "constants_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "enzymeDegredation", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"enzymeDegredation", " ", "=", " ", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Symbol", "[", "\"\<enzymeDegredation\>\"", "]"}], " ", "//.",
          " ", "constants"}], ",", " ", "\[IndentingNewLine]", "none", ",", 
        " ", "1", ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"no", " ", "degredation"}], " ", "*)"}], 
        "\[IndentingNewLine]", "eqn26", ",", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "kdeg"}], " ", "/", " ", "\[Tau]den"}], "]"}], " ", "//.",
          " ", "constants"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"eqn", " ", "26"}], " ", "*)"}], "\[IndentingNewLine]", 
        "eqn27", ",", " ", "0.9990"}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{"eqn", " ", "27"}], " ", "*)"}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"preempt", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p1", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "p1"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "h1"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "eh1"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "d"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "ed"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"p2", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "p2"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "h2"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "eh2"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "d"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "ed"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"t1", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "t1"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "u"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "eu"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "h1"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "eh1"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"t2", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "t2"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "u"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "eu"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "h2"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "eh2"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"e", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"readState", "[", 
               RowBox[{"state", ",", "e"}], "]"}], " ", "+", " ", 
              RowBox[{"readState", "[", 
               RowBox[{"state", ",", " ", "eh1"}], "]"}], " ", "+", " ", 
              RowBox[{"readState", "[", 
               RowBox[{"state", ",", "eh2"}], "]"}], " ", "+", " ", 
              RowBox[{"readState", "[", 
               RowBox[{"state", ",", "eu"}], "]"}], " ", "+", " ", 
              RowBox[{"readState", "[", 
               RowBox[{"state", ",", " ", "ed"}], "]"}]}], ")"}], " ", "*", 
            " ", "enzymeDegredation"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"h1", " ", "\[Rule]", " ", "0"}], ",", 
          RowBox[{"h2", " ", "\[Rule]", " ", "0"}], ",", 
          RowBox[{"d", "\[Rule]", " ", "0"}], ",", 
          RowBox[{"u", " ", "\[Rule]", " ", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"eu", " ", "\[Rule]", " ", "0"}], ",", 
          RowBox[{"ed", "\[Rule]", " ", "0"}], ",", " ", 
          RowBox[{"eh1", " ", "\[Rule]", " ", "0"}], ",", " ", 
          RowBox[{"eh2", " ", "\[Rule]", " ", "0"}]}], "\[IndentingNewLine]", 
         "}"}], ",", "state"}], "]"}], " ", "//", "makeState"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"denature", "[", 
  RowBox[{
   RowBox[{"extensionStepMichaelisMention", "[", 
    RowBox[{
     RowBox[{"annealKinetic", "[", 
      RowBox[{
       RowBox[{"state0", "[", "]"}], ",", " ", "constants"}], "]"}], ",", " ",
      "constants"}], "]"}], ",", " ", "constants"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"#", " ", "\[Rule]", " ", 
    RowBox[{"(", 
     RowBox[{"#", " ", "/.", " ", "%"}], ")"}]}], " ", "&"}], " ", "/@", " ", 
  "stateVariables"}]}], "Input",
 CellChangeTimes->{{3.6351301480482426`*^9, 3.6351304103332443`*^9}, {
   3.6351731993546734`*^9, 3.635173262877985*^9}, {3.6351973800252743`*^9, 
   3.6351975140489397`*^9}, {3.635197591752384*^9, 3.6351975933844776`*^9}, {
   3.6351976406641817`*^9, 3.6351976749281416`*^9}, 3.6351978759506392`*^9, {
   3.6351984838024063`*^9, 3.635198484306435*^9}, {3.635198607313471*^9, 
   3.635198614888904*^9}, {3.635514973460596*^9, 3.6355149901726193`*^9}, {
   3.6355150221756644`*^9, 3.635515039637689*^9}, {3.63553729736434*^9, 
   3.6355374084634967`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Runs", "Subsection",
 CellChangeTimes->{{3.634489357213402*^9, 3.6344893579134035`*^9}, {
  3.634489456113541*^9, 3.6344894591635456`*^9}, {3.634489492936593*^9, 
  3.634489493266593*^9}, {3.6345021102002783`*^9, 3.634502115791286*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"run", "[", "n_", "]"}], " ", ":=", " ", 
  RowBox[{"run", "[", 
   RowBox[{"n", ",", 
    RowBox[{"state0", "[", "]"}], ",", " ", "annealKinetic", ",", " ", 
    "extensionStepMichaelisMention", ",", " ", "constants"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"run", "[", 
   RowBox[{
   "n_", ",", " ", "initialState_", ",", " ", "annealStep_", ",", " ", 
    "extnStep_", ",", " ", "constants_", ",", " ", 
    RowBox[{"options_:", " ", 
     RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "results", ",", " ", "step", ",", " ", "cycle", ",", " ", 
      "denaturedCycleInput", ",", " ", "annealOutput", ",", " ", 
      "extensionOutput", ",", " ", "denaturedExtensionOutput"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"results", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"denaturedCycleInput", " ", "=", " ", 
      RowBox[{"denature", "[", 
       RowBox[{"initialState", ",", " ", "constants"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"cycle", " ", "=", " ", "0"}], ",", " ", 
       RowBox[{"cycle", " ", "<", " ", "n"}], ",", " ", 
       RowBox[{"cycle", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"annealOutput", " ", "=", " ", 
         RowBox[{"annealStep", "[", 
          RowBox[{
          "denaturedCycleInput", ",", " ", "constants", ",", " ", "options"}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"extensionOutput", " ", "=", " ", 
         RowBox[{"extnStep", "[", 
          RowBox[{
          "annealOutput", ",", " ", "constants", ",", " ", "options"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"denaturedExtensionOutput", " ", "=", " ", 
         RowBox[{"denature", "[", 
          RowBox[{"extensionOutput", ",", " ", "constants"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"results", " ", "=", " ", 
         RowBox[{"results", " ", "~", "Join", "~", " ", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"t1Start", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedCycleInput", ",", " ", "t1Start"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"t1Start", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedCycleInput", ",", " ", "t2Start"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"eTC", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedCycleInput", ",", " ", "e"}], "]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"p1TC", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedCycleInput", ",", " ", "p1"}], "]"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"p2TC", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedCycleInput", ",", " ", "p2"}], "]"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"t1TC", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedCycleInput", ",", " ", "t1"}], "]"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"t2TC", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedCycleInput", ",", " ", "t2"}], "]"}]}], 
               ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"eT", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedExtensionOutput", ",", " ", "e"}], "]"}]}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"p1T", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedExtensionOutput", ",", " ", "p1"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"p2T", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedExtensionOutput", ",", " ", "p2"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"t1T", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedExtensionOutput", ",", " ", "t1"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"t2T", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedExtensionOutput", ",", " ", "t2"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"p1A", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "p1"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"p2A", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "p2"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"t1A", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "t1"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"t2A", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "t2"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"h1A", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "h1"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"h2A", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "h2"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"dA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "d"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"uA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "u"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"euA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "eu"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"edA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "ed"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"eh1A", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "eh1"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"eh2A", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "eh2"}], "]"}]}]}], 
              "\[IndentingNewLine]", "}"}], ",", " ", "\[IndentingNewLine]", 
             "extensionOutput"}], "\[IndentingNewLine]", "]"}], "}"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
        "denaturedCycleInput", " ", "=", " ", "denaturedExtensionOutput"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "results"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"customGraphVariables", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
    "eTC", ",", " ", "p1TC", ",", " ", "p2TC", ",", " ", "t1TC", ",", " ", 
     "t2TC", ",", " ", "eT", ",", " ", "p1T", ",", " ", "p2T", ",", " ", 
     "t1T", ",", " ", "t2T", ",", " ", "\[IndentingNewLine]", "p1", ",", " ", 
     "p2", ",", " ", "h1", ",", " ", "h2", ",", " ", "t1", ",", " ", "t2", 
     ",", " ", "d", ",", " ", "u", ",", " ", "e", ",", " ", "eu", ",", " ", 
     "ed", ",", " ", "eh1", ",", " ", "eh2", ",", " ", "\[IndentingNewLine]", 
     "p1A", ",", " ", "p2A", ",", " ", "h1A", ",", " ", "h2A", ",", " ", 
     "t1A", ",", " ", "t2A", ",", " ", "dA", ",", " ", "uA", ",", " ", "eA", 
     ",", " ", "euA", ",", " ", "eh1A", ",", " ", "eh2A", ",", 
     "\[IndentingNewLine]", "t1Start", ",", " ", "t2Start"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"run", "[", 
   RowBox[{"3", ",", " ", 
    RowBox[{"state0", "[", "]"}], ",", " ", "annealEquilibrium", ",", " ", 
    "extensionStepGevertz", ",", " ", "constants"}], "]"}], " ", "//", " ", 
  "ColumnForm"}]}], "Input",
 CellChangeTimes->{{3.6344897427412467`*^9, 3.6344897939463186`*^9}, {
   3.634489832180372*^9, 3.6344899027894726`*^9}, {3.6344904229462466`*^9, 
   3.6344904440102763`*^9}, {3.634490694078628*^9, 3.634490694128628*^9}, 
   3.6344923060818996`*^9, {3.6344930694563303`*^9, 3.634493072376334*^9}, {
   3.6344947037841873`*^9, 3.634494704654188*^9}, {3.634495722789177*^9, 
   3.6344957229891777`*^9}, 3.6345021268023014`*^9, {3.634502322783579*^9, 
   3.6345023538266225`*^9}, {3.634502395622681*^9, 3.634502403763693*^9}, 
   3.634502443728749*^9, {3.634502783250253*^9, 3.6345030890926833`*^9}, {
   3.63450315045177*^9, 3.6345032837869573`*^9}, {3.634503332752026*^9, 
   3.6345033360120306`*^9}, {3.6345033732652035`*^9, 
   3.6345033828162165`*^9}, {3.634503493887373*^9, 3.634503590837509*^9}, {
   3.634503626500559*^9, 3.634503703277667*^9}, {3.634503821538932*^9, 
   3.634503959212125*^9}, {3.634504073363285*^9, 3.634504095435316*^9}, {
   3.6345041542333994`*^9, 3.6345042371315155`*^9}, {3.6345042728265657`*^9, 
   3.6345042752775693`*^9}, {3.6345077118691683`*^9, 3.634507713278249*^9}, {
   3.63457304816667*^9, 3.634573074068706*^9}, {3.634573110012757*^9, 
   3.6345731690978394`*^9}, {3.6345732018008857`*^9, 3.634573234706932*^9}, {
   3.63457333579365*^9, 3.6345733393936553`*^9}, {3.6345755927124014`*^9, 
   3.6345756126244297`*^9}, {3.6345757314075966`*^9, 3.634575826789731*^9}, {
   3.634577663848383*^9, 3.6345776649683847`*^9}, {3.6346567345498314`*^9, 
   3.6346567349198313`*^9}, {3.6346679261168985`*^9, 3.6346679331873035`*^9}, 
   3.6348465482792635`*^9, 3.634846768223844*^9, {3.6348476385046215`*^9, 
   3.6348476396486864`*^9}, {3.6348625361117153`*^9, 3.634862552839672*^9}, {
   3.634862589252755*^9, 3.634862846964495*^9}, {3.634862995011963*^9, 
   3.6348630171552296`*^9}, {3.6348639781171937`*^9, 
   3.6348640534745035`*^9}, {3.634920956085211*^9, 3.634920990951272*^9}, {
   3.634921045270568*^9, 3.6349210518537793`*^9}, {3.635022454674101*^9, 
   3.635022469774927*^9}, {3.635023334484446*^9, 3.6350233769321203`*^9}, 
   3.635023617375343*^9, 3.6350238404557347`*^9, {3.6350958802252355`*^9, 
   3.635095885689548*^9}, {3.6350959428808193`*^9, 3.635095943664864*^9}, {
   3.6350960040403175`*^9, 3.6350960051043777`*^9}, {3.6351304742128983`*^9, 
   3.635130570612412*^9}, 3.6351737589242444`*^9, {3.635174882949403*^9, 
   3.6351749130730557`*^9}, {3.635197905269316*^9, 3.6351979090535326`*^9}, {
   3.6351979429874735`*^9, 3.635197954499132*^9}, {3.6351980048080096`*^9, 
   3.6351980319485617`*^9}, {3.635198394091275*^9, 3.6351984243680067`*^9}, {
   3.6351984996553135`*^9, 3.63519850222346*^9}, {3.6351986564562817`*^9, 
   3.635198658223383*^9}, {3.635198782286479*^9, 3.6351988859424076`*^9}, {
   3.635198922038472*^9, 3.6351991369487643`*^9}, {3.635199392715393*^9, 
   3.635199452642821*^9}, {3.635199559833952*^9, 3.6351995817142034`*^9}, {
   3.6352096441247406`*^9, 3.6352097248983603`*^9}, {3.635211426750701*^9, 
   3.6352114379113393`*^9}, {3.6352126111424437`*^9, 
   3.6352126194949217`*^9}, {3.6352139055074778`*^9, 
   3.6352139458287835`*^9}, {3.635213995274612*^9, 3.635213995634632*^9}, 
   3.6352158579251494`*^9, {3.6354745896096945`*^9, 3.6354746691888065`*^9}, {
   3.6354747048018565`*^9, 3.635474718643876*^9}, {3.635474754137926*^9, 
   3.635474786020971*^9}, {3.6354748492580595`*^9, 3.6354749574012117`*^9}, 
   3.635529059006604*^9, {3.6355290973106585`*^9, 3.6355293222059746`*^9}, {
   3.635529359450027*^9, 3.635529365071035*^9}, {3.6355294258691206`*^9, 
   3.63552946089217*^9}, {3.6355295984058886`*^9, 3.635529610017905*^9}, {
   3.635537435733035*^9, 3.635537454125061*^9}, {3.63554693362728*^9, 
   3.635546988553357*^9}}]
}, Closed]]
}, Open  ]]
},
WindowSize->{1233, 913},
WindowMargins->{{80, Automatic}, {-3, Automatic}},
CellContext->Notebook,
InputAliases->{"intt" -> RowBox[{"\[Integral]", 
     RowBox[{"\[SelectionPlaceholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "dintt" -> RowBox[{
     SubsuperscriptBox[
     "\[Integral]", "\[SelectionPlaceholder]", "\[Placeholder]"], 
     RowBox[{"\[Placeholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "sumt" -> RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "prodt" -> RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "dt" -> RowBox[{
     SubscriptBox["\[PartialD]", "\[Placeholder]"], " ", 
     "\[SelectionPlaceholder]"}], "ket" -> 
  TemplateBox[{"\[Placeholder]"}, "Ket"], "bra" -> 
  TemplateBox[{"\[Placeholder]"}, "Bra"], "braket" -> 
  TemplateBox[{"\[Placeholder]", "\[Placeholder]"}, "BraKet"], "notation" -> 
  RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation>" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation<" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "symb" -> RowBox[{"Symbolize", "[", 
     TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], "]"}], 
  "infixnotation" -> RowBox[{"InfixNotation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], ",", 
       "\[Placeholder]"}], "]"}], "addia" -> RowBox[{"AddInputAlias", "[", 
     RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "pattwraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationPatternTag"], 
  "madeboxeswraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationMadeBoxesTag"], "rxn" -> 
  OverscriptBox["\[RightArrow]", "\[Placeholder]"], "erxn" -> RowBox[{
     UnderoverscriptBox[
      TagBox[
       TagBox["\[Equilibrium]", DisplayForm], DisplayForm], "\[Placeholder]", 
      "\[Placeholder]"], " "}]},
Magnification:>0.95 Inherited,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 157, 2, 67, "Section"],
Cell[CellGroupData[{
Cell[762, 28, 166, 2, 46, "Subsection"],
Cell[CellGroupData[{
Cell[953, 34, 2953, 75, 200, "Input"],
Cell[3909, 111, 266, 7, 70, "Output"],
Cell[4178, 120, 123, 2, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[4350, 128, 97, 1, 38, "Subsection"],
Cell[4450, 131, 254, 5, 27, "Text"],
Cell[4707, 138, 1814, 42, 193, "Input"],
Cell[6524, 182, 6080, 173, 374, "Input"],
Cell[12607, 357, 2385, 63, 124, "Input"],
Cell[CellGroupData[{
Cell[15017, 424, 699, 19, 37, "Input"],
Cell[15719, 445, 2227, 66, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17983, 516, 528, 14, 37, "Input"],
Cell[18514, 532, 928, 29, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[19491, 567, 99, 1, 38, "Subsection"],
Cell[CellGroupData[{
Cell[19615, 572, 517, 9, 91, "Input"],
Cell[20135, 583, 244, 4, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20416, 592, 6252, 99, 151, "Input"],
Cell[26671, 693, 358, 8, 29, "Output"],
Cell[27032, 703, 332, 6, 44, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27413, 715, 97, 1, 46, "Subsection"],
Cell[CellGroupData[{
Cell[27535, 720, 1129, 30, 84, "Input"],
Cell[28667, 752, 575, 18, 42, "Output"],
Cell[29245, 772, 2605, 74, 86, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31887, 851, 1256, 30, 51, "Input"],
Cell[33146, 883, 714, 19, 29, "Output"],
Cell[33863, 904, 710, 19, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34610, 928, 583, 14, 30, "Input"],
Cell[35196, 944, 455, 13, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35688, 962, 494, 10, 71, "Input"],
Cell[36185, 974, 2535, 72, 49, "Output"],
Cell[38723, 1048, 225, 4, 29, "Output"],
Cell[38951, 1054, 450, 9, 19, "Message"],
Cell[39404, 1065, 2830, 77, 49, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42283, 1148, 103, 1, 46, "Subsection"],
Cell[CellGroupData[{
Cell[42411, 1153, 171, 2, 38, "Subsubsection"],
Cell[42585, 1157, 2444, 49, 200, "Input"],
Cell[45032, 1208, 248, 5, 27, "Text"],
Cell[CellGroupData[{
Cell[45305, 1217, 8524, 180, 371, "Input"],
Cell[53832, 1399, 759, 15, 51, "Output"],
Cell[54594, 1416, 493, 13, 41, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[55136, 1435, 117, 1, 32, "Subsubsection"],
Cell[55256, 1438, 498, 8, 48, "Text"],
Cell[55757, 1448, 2188, 56, 286, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57982, 1509, 167, 2, 38, "Subsubsection"],
Cell[58152, 1513, 247, 3, 29, "Text"],
Cell[CellGroupData[{
Cell[58424, 1520, 1914, 50, 238, "Input"],
Cell[60341, 1572, 4253, 116, 147, "Output"]
}, Open  ]],
Cell[64609, 1691, 196, 4, 29, "Text"],
Cell[64808, 1697, 574, 13, 51, "Input"],
Cell[65385, 1712, 309, 6, 29, "Text"],
Cell[65697, 1720, 16355, 343, 1091, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[82101, 2069, 105, 1, 46, "Subsection"],
Cell[CellGroupData[{
Cell[82231, 2074, 105, 1, 38, "Subsubsection"],
Cell[82339, 2077, 674, 11, 45, "Text"],
Cell[83016, 2090, 2996, 63, 124, "Input"],
Cell[86015, 2155, 142, 1, 27, "Text"],
Cell[86160, 2158, 3529, 71, 162, "Input"],
Cell[89692, 2231, 466, 7, 45, "Text"],
Cell[90161, 2240, 7341, 147, 447, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[97539, 2392, 196, 2, 32, "Subsubsection"],
Cell[97738, 2396, 282, 5, 27, "Text"],
Cell[98023, 2403, 366, 7, 27, "Text"],
Cell[98392, 2412, 171, 3, 28, "Input"],
Cell[98566, 2417, 10671, 209, 789, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109286, 2632, 108, 1, 46, "Subsection"],
Cell[109397, 2635, 277, 5, 21, "Text"],
Cell[109677, 2642, 6267, 133, 317, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[115981, 2780, 242, 3, 38, "Subsection"],
Cell[116226, 2785, 12859, 230, 842, "Input"]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
