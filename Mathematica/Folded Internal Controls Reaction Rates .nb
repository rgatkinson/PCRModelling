(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     52981,       1315]
NotebookOptionsPosition[     48869,       1213]
NotebookOutlinePosition[     51869,       1280]
CellTagsIndexPosition[     51826,       1277]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Code for the Model", "Section",
 CellChangeTimes->{{3.6348397084940505`*^9, 3.6348397089180746`*^9}, {
  3.63486890578404*^9, 3.6348689079761653`*^9}}],

Cell[CellGroupData[{

Cell["Miscellaneous Utilities", "Subsection",
 CellChangeTimes->{{3.6345770377895007`*^9, 3.6345770388395023`*^9}, {
  3.6348493313534465`*^9, 3.634849334721639*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"makeState", "[", "list_List", "]"}], " ", ":=", " ", 
  "list"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"readState", "[", 
   RowBox[{"state_", ",", " ", "symbol_Symbol"}], "]"}], " ", ":=", " ", 
  RowBox[{"readState", "[", 
   RowBox[{"state", ",", " ", "symbol", ",", " ", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"readState", "[", 
   RowBox[{"state_", ",", " ", "symbol_Symbol", ",", " ", "default_"}], "]"}],
   " ", ":=", " ", 
  RowBox[{"symbol", " ", "/.", " ", 
   RowBox[{"(", 
    RowBox[{"state", " ", "~", "Join", "~", " ", 
     RowBox[{"{", 
      RowBox[{"symbol", " ", "\[Rule]", " ", "default"}], "}"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"preempt", "[", 
   RowBox[{"new_", ",", " ", "old_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"keys", ",", " ", "replacements", ",", " ", "values"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"keys", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"old", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "~", "Join", "~", " ", 
        RowBox[{"new", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "//", " ", "Union"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"replacements", " ", "=", " ", 
      RowBox[{"FilterRules", "[", 
       RowBox[{"new", ",", " ", "keys"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"values", " ", "=", " ", 
      RowBox[{
       RowBox[{"keys", " ", "/.", " ", "replacements"}], " ", "/.", " ", 
       "old"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Rule", " ", "@@", "#"}], "&"}], " ", "/@", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"keys", ",", " ", "values"}], "}"}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"preempt", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "b"}], ",", " ", 
     RowBox[{"e", "\[Rule]", "f"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "c"}], ",", " ", 
     RowBox[{"c", "\[Rule]", "d"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"readState", "[", 
  RowBox[{
   RowBox[{"makeState", "[", 
    RowBox[{"{", 
     RowBox[{"a", "\[Rule]", " ", "7"}], "}"}], "]"}], ",", " ", "b", ",", 
   " ", "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6345770416095057`*^9, 3.6345770867245693`*^9}, {
  3.6345775909082794`*^9, 3.6345775995982914`*^9}, {3.6345777103344483`*^9, 
  3.6345777209574633`*^9}, {3.6346724423876963`*^9, 3.6346725064113584`*^9}, {
  3.6346726854505987`*^9, 3.634672702585579*^9}, {3.6348629106201363`*^9, 
  3.634862924819948*^9}, {3.635103000661501*^9, 3.635103019809596*^9}, {
  3.635130676146448*^9, 3.635130796666342*^9}, {3.6351311334886065`*^9, 
  3.635131138407888*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Chemistry", "Subsection",
 CellChangeTimes->{{3.634849268721864*^9, 3.634849271306012*^9}}],

Cell["\<\
The main point of this section is, given a system of chemical equations, to \
be able to compute the set of differential rate equations that govern that \
system.\
\>", "Text",
 CellChangeTimes->{{3.6348504642652454`*^9, 3.634850510185872*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Notation`AutoLoadNotationPalette", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<Notation`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Notation", "[", 
  RowBox[{
   TemplateBox[{RowBox[{"a_", " ", 
       UnderoverscriptBox[
        TagBox[
         TagBox["\[Equilibrium]", DisplayForm], DisplayForm], "kr_", "kf_"], 
       " ", "b_"}]},
    "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
   TemplateBox[{RowBox[{"TChemicalReaction", "[", 
       RowBox[{
         RowBox[{"TChemicalExpr", "[", "a_", "]"}], ",", 
         RowBox[{"TChemicalExpr", "[", "b_", "]"}], ",", "kf_", ",", " ", 
         "kr_"}], "]"}]},
    "NotationTemplateTag"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Notation", "[", 
  RowBox[{
   TemplateBox[{RowBox[{"a_", 
       OverscriptBox["\[RightArrow]", "k_"], "b_"}]},
    "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
   TemplateBox[{RowBox[{"TChemicalReaction", "[", 
       RowBox[{
         RowBox[{"TChemicalExpr", "[", "a_", "]"}], ",", 
         RowBox[{"TChemicalExpr", "[", "b_", "]"}], ",", "k_", ",", " ", 
         "0"}], "]"}]},
    "NotationTemplateTag"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddInputAlias", "[", 
  RowBox[{"\"\<rxn\>\"", "\[Rule]", 
   TemplateBox[{OverscriptBox["\[RightArrow]", "\[Placeholder]"]},
    "NotationTemplateTag"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddInputAlias", "[", 
  RowBox[{"\"\<erxn\>\"", "\[Rule]", 
   TemplateBox[{RowBox[{
       UnderoverscriptBox[
        TagBox[
         TagBox["\[Equilibrium]", DisplayForm], DisplayForm], 
        "\[Placeholder]", "\[Placeholder]"], " "}]},
    "NotationTemplateTag"]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6348492985245686`*^9, 3.6348492997236376`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"chemicalReactionQ", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"x", ",", " ", 
     RowBox[{"TChemicalReaction", "[", 
      RowBox[{"_", ",", "_", ",", "_", ",", "_"}], "]"}]}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chemicalSystemPattern", " ", "=", " ", 
    RowBox[{"{", " ", 
     RowBox[{"Repeated", "[", 
      RowBox[{"_", "?", "chemicalReactionQ"}], "]"}], " ", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allSpecies", "[", 
   RowBox[{"TChemicalExpr", "[", "e_", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"Variables", "[", "e", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allSpecies", "[", 
   RowBox[{"TChemicalReaction", "[", 
    RowBox[{"r_", ",", "p_", ",", " ", "_", ",", " ", "_"}], "]"}], "]"}], 
  " ", ":=", " ", 
  RowBox[{
   RowBox[{"allSpecies", "[", "r", "]"}], " ", "\[Union]", " ", 
   RowBox[{"allSpecies", "[", "p", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"allSpecies", "[", 
     RowBox[{"system", " ", ":", " ", "chemicalSystemPattern"}], "]"}], " ", ":=",
     " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"allSpecies", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
       "system"}], " ", "//", " ", "Flatten"}], " ", "//", " ", "Union"}]}], 
   ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allParameters", "[", 
   RowBox[{"rxn", ":", "  ", 
    RowBox[{"TChemicalReaction", "[", 
     RowBox[{"r_", ",", "p_", ",", " ", "kf_", ",", " ", "kr_"}], "]"}]}], 
   "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Variables", "[", "kf", "]"}], ",", " ", 
      RowBox[{"Variables", "[", "kr", "]"}]}], "}"}], " ", "//", " ", 
    "Flatten"}], " ", "//", " ", "Union"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"allParameters", "[", 
     RowBox[{"system", " ", ":", " ", "chemicalSystemPattern"}], "]"}], " ", ":=",
     " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"allParameters", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
       "system"}], " ", "//", " ", "Flatten"}], " ", "//", " ", "Union"}]}], 
   ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stochiometry", "[", 
   RowBox[{
    RowBox[{"TChemicalExpr", "[", "expr_", "]"}], ",", " ", "species_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"expr", ",", " ", "species"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stochiometry", "[", 
   RowBox[{"e", ":", " ", 
    RowBox[{"TChemicalExpr", "[", "_", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[Nu]", "#"], "\[Rule]", 
     RowBox[{"stochiometry", "[", 
      RowBox[{"e", ",", " ", "#"}], "]"}]}], "&"}], " ", "/@", " ", 
   RowBox[{"allSpecies", "[", "e", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stochiometry", "[", 
   RowBox[{"rxn", ":", "  ", 
    RowBox[{"TChemicalReaction", "[", 
     RowBox[{"r_", ",", "p_", ",", " ", "_", ",", " ", "_"}], "]"}]}], "]"}], 
  " ", ":=", "  ", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[Nu]", "#"], "\[Rule]", 
     RowBox[{
      RowBox[{"stochiometry", "[", 
       RowBox[{"p", ",", " ", "#"}], "]"}], "-", 
      RowBox[{"stochiometry", "[", 
       RowBox[{"r", ",", " ", "#"}], "]"}]}]}], " ", "&"}], " ", "/@", " ", 
   RowBox[{"allSpecies", "[", "rxn", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stochiometry", "[", 
    RowBox[{"system", " ", ":", " ", "chemicalSystemPattern"}], "]"}], " ", ":=",
    " ", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "species", "}"}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Nu]", "species"], "\[Rule]", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["\[Nu]", "species"], " ", "/.", 
             RowBox[{"stochiometry", "[", "#", "]"}]}], " ", "/.", " ", 
            RowBox[{
             SubscriptBox["\[Nu]", "species"], "\[Rule]", " ", "0"}]}], "&"}],
           "/@", " ", "system"}], ")"}], "]"}]}]}], "]"}], "/@", " ", 
    RowBox[{"allSpecies", "[", "system", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rate", "[", 
   RowBox[{
    RowBox[{"e", ":", " ", 
     RowBox[{"TChemicalExpr", "[", "_", "]"}]}], ",", " ", "k_"}], "]"}], " ",
   ":=", " ", 
  RowBox[{"k", " ", "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", " ", "@@", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["#", 
          SubscriptBox["\[Nu]", "#"]], "&"}], "/@", " ", 
        RowBox[{"allSpecies", "[", "e", "]"}]}], ")"}]}], " ", "/.", " ", 
     RowBox[{"stochiometry", "[", "e", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rate", "[", 
    RowBox[{"rxn", " ", ":", " ", 
     RowBox[{"TChemicalReaction", "[", 
      RowBox[{"r_", ",", "p_", ",", " ", "kf_", ",", " ", "kr_"}], "]"}]}], 
    "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"rate", "[", 
     RowBox[{"r", ",", "kf"}], "]"}], " ", "-", " ", 
    RowBox[{"rate", "[", 
     RowBox[{"p", ",", "kr"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rate", "[", 
   RowBox[{
    RowBox[{"rxn", " ", ":", " ", 
     RowBox[{"TChemicalReaction", "[", 
      RowBox[{"_", ",", "_", ",", "_", ",", "_"}], "]"}]}], ",", " ", 
    "species_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"rate", "[", "rxn", "]"}], " ", "*", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Nu]", 
       RowBox[{"species", " "}]], "/.", " ", 
      RowBox[{"stochiometry", "[", "rxn", "]"}]}], " ", "/.", " ", 
     RowBox[{
      SubscriptBox["\[Nu]", 
       RowBox[{"species", " "}]], "\[Rule]", " ", "0"}]}], 
    ")"}]}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rateEqns", "[", 
   RowBox[{
    RowBox[{"rxn_", "?", "chemicalReactionQ"}], ",", " ", "t_"}], "]"}], " ", 
  ":=", " ", 
  RowBox[{"rates", "[", 
   RowBox[{
    RowBox[{"{", "rxn", "}"}], ",", " ", "t"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rateEqns", "[", 
   RowBox[{
    RowBox[{"system", " ", ":", " ", "chemicalSystemPattern"}], ",", " ", 
    "t_", ",", " ", "optionsSeq___Rule"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"options", ",", "  ", "systemSpecies", ",", " ", "exprs"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"options", " ", "=", " ", 
      RowBox[{"preempt", "[", 
       RowBox[{
        RowBox[{"{", " ", "optionsSeq", " ", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"WasteSpecies", " ", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"systemSpecies", " ", "=", " ", 
      RowBox[{"allSpecies", "[", "system", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"systemSpecies", " ", "=", " ", 
      RowBox[{"Intersection", "[", 
       RowBox[{"systemSpecies", ",", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{"systemSpecies", ",", " ", 
          RowBox[{"(", 
           RowBox[{"WasteSpecies", " ", "/.", " ", "options"}], ")"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "species", "}"}], ",", " ", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"species", "[", "t", "]"}], ",", "t"}], "]"}], " ", "==", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"#", ",", " ", "species"}], "]"}], "&"}], "/@", " ", 
             "system"}], "]"}], " ", "/.", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"#", " ", "\[Rule]", " ", 
               RowBox[{"#", "[", "t", "]"}]}], "&"}], " ", "/@", " ", 
             "systemSpecies"}], ")"}]}], ")"}]}]}], "]"}], "/@", 
      "systemSpecies"}]}]}], " ", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6348494258278503`*^9, 3.634849432539234*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rateEqns", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "+", " ", "G"}], " ", 
       OverscriptBox["\[RightArrow]", "k"], " ", 
       RowBox[{"P", " ", "+", " ", "W1"}]}], ",", " ", 
      RowBox[{
       RowBox[{"P", " ", "+", " ", "R"}], " ", 
       OverscriptBox["\[RightArrow]", "q"], " ", 
       RowBox[{"F", " ", "+", " ", "W2"}]}]}], "}"}], ",", " ", "\[Tau]", ",",
     " ", 
    RowBox[{"WasteSpecies", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"W1", ",", " ", "W2"}], "}"}]}]}], "]"}], " ", "//", " ", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.6348495618736315`*^9, 3.634849562265654*^9}}],

Cell[BoxData[
 RowBox[{"stochiometry", "[", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "+", " ", "G"}], " ", 
     OverscriptBox["\[RightArrow]", "k"], " ", 
     RowBox[{"P", " ", "+", " ", "W1"}]}], ",", " ", 
    RowBox[{
     RowBox[{"P", " ", "+", " ", "R"}], " ", 
     OverscriptBox["\[RightArrow]", "q"], " ", 
     RowBox[{"F", " ", "+", " ", "W2"}]}], ",", " ", 
    RowBox[{
     RowBox[{"A", " ", "+", " ", "B"}], " ", 
     OverscriptBox["\[RightArrow]", "d"], "C"}]}], "}"}], "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Constants (not used)", "Subsection",
 CellChangeTimes->{{3.6344352200038705`*^9, 3.634435220931924*^9}, {
  3.6580795773690896`*^9, 3.658079579929011*^9}}],

Cell[BoxData[
 RowBox[{"stateVariables", " ", "=", " ", 
  RowBox[{"{", " ", 
   RowBox[{
   "p", ",", " ", "c", ",", " ", "t", ",", " ", "pt", ",", " ", "pc"}], " ", 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.635188245888831*^9, 3.635188285327087*^9}, {
  3.6355371548766394`*^9, 3.6355371552816396`*^9}, {3.635537186561184*^9, 
  3.6355371895411882`*^9}, {3.657308080543272*^9, 3.6573080838691454`*^9}, {
  3.6573200091204467`*^9, 3.657320010937215*^9}, {3.657466967539339*^9, 
  3.6574669798997035`*^9}, {3.6579085516868963`*^9, 3.6579085522871866`*^9}, {
  3.657908911225584*^9, 3.657908914792776*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"constants", " ", "=", " ", 
   RowBox[{"{", " ", "}"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state0", "[", "]"}], " ", ":=", " ", 
  RowBox[{"state0", "[", 
   RowBox[{"tStart", ",", " ", "constants"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state0", "[", 
   RowBox[{"tStart_", ",", " ", "constants_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"makeState", " ", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"p", " ", "\[Rule]", " ", "pStart"}], ",", " ", 
        RowBox[{"t", " ", "\[Rule]", " ", "tStart"}], ",", " ", 
        RowBox[{"c", " ", "\[Rule]", " ", "cStart"}]}], " ", "}"}], " ", "//.",
       " ", "constants"}], ")"}]}], " ", "//", " ", 
   "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"state0", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", "  ", 
     RowBox[{"t1", ",", " ", "t2", ",", "  ", "kh1", ",", " ", "ku", ",", " ", 
      RowBox[{"koffu", "/", "konu"}], ",", " ", "koffu", ",", " ", "konu"}], 
     " ", "}"}], " ", "//.", " ", 
    RowBox[{"state0", "[", "]"}]}], " ", "//.", " ", "constants"}], "//", " ",
   "N"}]}], "Input",
 CellChangeTimes->{{3.634435222143993*^9, 3.634435225780201*^9}, {
   3.6344355326827545`*^9, 3.6344358431055098`*^9}, {3.6344374258620386`*^9, 
   3.63443754513286*^9}, {3.6344376444285393`*^9, 3.634437665132724*^9}, {
   3.6344381175706015`*^9, 3.634438134160551*^9}, {3.634439339697503*^9, 
   3.6344393424166594`*^9}, {3.634439433712881*^9, 3.634439434448923*^9}, {
   3.6344394744162087`*^9, 3.634439479992528*^9}, 3.6344395111443095`*^9, {
   3.634482914057667*^9, 3.6344829197676744`*^9}, {3.6344898161093497`*^9, 
   3.6344898169893513`*^9}, {3.6344906260015326`*^9, 3.634490674926601*^9}, {
   3.634494723657215*^9, 3.6344947237272153`*^9}, {3.634494808954336*^9, 
   3.6344948091443367`*^9}, {3.6344950830337214`*^9, 3.634495083403722*^9}, {
   3.634495138009799*^9, 3.634495138109799*^9}, 3.63449518873687*^9, {
   3.634495631348048*^9, 3.6344956867351265`*^9}, {3.634495791056273*^9, 
   3.634495820140314*^9}, {3.6344959118544436`*^9, 3.6344959118944435`*^9}, 
   3.6345000069733047`*^9, {3.6345002117895937`*^9, 3.6345002183706026`*^9}, {
   3.634500267358672*^9, 3.634500267549672*^9}, 3.634500593147131*^9, 
   3.6345006265411787`*^9, {3.6345007787773924`*^9, 3.634500782718398*^9}, {
   3.6345009334866104`*^9, 3.634500933586611*^9}, 3.6345010506927757`*^9, 
   3.6345014170313015`*^9, {3.6345026937911277`*^9, 3.63450273827619*^9}, {
   3.6345031060047073`*^9, 3.6345031074747095`*^9}, 3.6345041252103586`*^9, {
   3.6345087939830613`*^9, 3.634508847383116*^9}, {3.634577112727606*^9, 
   3.6345771143686085`*^9}, 3.6346622554316564`*^9, {3.6346623070209465`*^9, 
   3.63466231436856*^9}, {3.6346623489070206`*^9, 3.634662353150228*^9}, {
   3.6346624149897366`*^9, 3.6346624224465494`*^9}, 3.63466245659801*^9, {
   3.63466267289239*^9, 3.6346626729703903`*^9}, 3.6346628680985327`*^9, {
   3.6346629271456366`*^9, 3.634662927317237*^9}, 3.6346629622144985`*^9, 
   3.634663046517046*^9, {3.634663179975281*^9, 3.6346631822372847`*^9}, {
   3.634667777166379*^9, 3.6346677985966053`*^9}, {3.6346744729588385`*^9, 
   3.6346745029255524`*^9}, {3.6346943511758075`*^9, 3.634694356307101*^9}, {
   3.634694684862893*^9, 3.634694712334464*^9}, {3.6346948426399174`*^9, 
   3.6346948452230654`*^9}, {3.634696096182616*^9, 3.634696100078839*^9}, {
   3.6348345565243745`*^9, 3.634834594316536*^9}, {3.634840502394459*^9, 
   3.6348405024984646`*^9}, {3.6348517553870935`*^9, 
   3.6348518156195383`*^9}, {3.634853297921321*^9, 3.634853324352833*^9}, {
   3.634853739813596*^9, 3.634853740877657*^9}, {3.6348538159579515`*^9, 
   3.63485384094038*^9}, {3.6348539524847603`*^9, 3.6348539562199736`*^9}, {
   3.6348540030526524`*^9, 3.6348540222037477`*^9}, {3.6348541789307117`*^9, 
   3.6348542689068584`*^9}, 3.6348611877135916`*^9, {3.634861230129018*^9, 
   3.634861243161763*^9}, {3.634861347696742*^9, 3.634861375008304*^9}, 
   3.6348614065361075`*^9, {3.6348614609842215`*^9, 3.634861469822727*^9}, {
   3.634861505031741*^9, 3.6348615639241095`*^9}, {3.634865634914957*^9, 
   3.6348656442874928`*^9}, {3.634865736143747*^9, 3.6348659868960896`*^9}, {
   3.6348671291724234`*^9, 3.6348671373038883`*^9}, {3.6348685191979284`*^9, 
   3.6348685427902775`*^9}, {3.6350159134777303`*^9, 3.635015922799743*^9}, {
   3.6350207602601385`*^9, 3.6350207645911446`*^9}, {3.635027870670311*^9, 
   3.6350279019210987`*^9}, {3.6350279947054057`*^9, 3.63502799548145*^9}, {
   3.6350281779998894`*^9, 3.6350281852393036`*^9}, {3.635096336534335*^9, 
   3.635096370806295*^9}, 3.635097805292343*^9, {3.63510229361306*^9, 
   3.635102328981083*^9}, {3.6351311685596123`*^9, 3.635131240733741*^9}, 
   3.635131845260318*^9, 3.6351319097710075`*^9, {3.6351319406357727`*^9, 
   3.6351319421878614`*^9}, {3.635188083212527*^9, 3.6351881426249247`*^9}, {
   3.6352643172198625`*^9, 3.63526432784247*^9}, {3.635264518721388*^9, 
   3.6352645807529354`*^9}, {3.635264633335943*^9, 3.635264672024156*^9}, {
   3.635264791791006*^9, 3.6352648151913447`*^9}, {3.6352654337147226`*^9, 
   3.6352654427862415`*^9}, {3.635265482138492*^9, 3.6352654962663*^9}, {
   3.6353430211983447`*^9, 3.635343053178401*^9}, {3.635343091524268*^9, 
   3.635343191699044*^9}, {3.6353433470129175`*^9, 3.635343382253379*^9}, {
   3.63534351308471*^9, 3.6353435267286353`*^9}, {3.635343692681833*^9, 
   3.635343718749479*^9}, {3.6353437694807677`*^9, 3.6353437738799753`*^9}, {
   3.6353438119128428`*^9, 3.6353438133012447`*^9}, 3.6353438437524986`*^9, {
   3.635356621501941*^9, 3.6353566539499984`*^9}, {3.635356685618054*^9, 
   3.6353567176293097`*^9}, {3.6353567731040077`*^9, 
   3.6353568508409443`*^9}, {3.635356916159259*^9, 3.635357267987677*^9}, {
   3.6353583686987176`*^9, 3.6353584646026864`*^9}, {3.635358510436567*^9, 
   3.6353585263173947`*^9}, {3.635358587126302*^9, 3.63535859745352*^9}, {
   3.635537128217101*^9, 3.6355371378181148`*^9}, {3.6355468346851406`*^9, 
   3.635546850267163*^9}, {3.6573080984897485`*^9, 3.6573081399903345`*^9}, {
   3.6573083780379553`*^9, 3.657308378837232*^9}, {3.657466985511763*^9, 
   3.6574669880947113`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Reactions", "Subsection",
 CellChangeTimes->{{3.657308409320326*^9, 3.657308413407798*^9}}],

Cell["\<\
We set up the full generality of a single primer binding to template vs \
binding to control.\
\>", "Text",
 CellChangeTimes->{{3.6580744106814594`*^9, 3.65807443696808*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"reactions", " ", "=", " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"p", " ", "+", " ", "t"}], " ", 
       UnderoverscriptBox[
        TagBox[
         TagBox["\[Equilibrium]",
          DisplayForm],
         DisplayForm], "koffpt", "konpt"], " ", "pt"}], ",", " ", 
      RowBox[{
       RowBox[{"p", " ", "+", " ", "c"}], " ", 
       UnderoverscriptBox[
        TagBox[
         TagBox["\[Equilibrium]",
          DisplayForm],
         DisplayForm], "koffpc", "konpc"], " ", "pc"}]}], "}"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"assumptions", " ", "=", " ", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{"konpt", " ", ">", " ", "0"}], ",", " ", 
    RowBox[{"koffpt", " ", ">", " ", "0"}], ",", " ", 
    RowBox[{"konpc", " ", ">", " ", "0"}], ",", " ", 
    RowBox[{"koffpc", " ", ">", " ", "0"}]}], " ", 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reactionEqns", " ", "=", " ", 
   RowBox[{"rateEqns", "[", 
    RowBox[{"reactions", ",", "  ", "\[Tau]", ",", " ", 
     RowBox[{"WasteSpecies", " ", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reactionEqns", " ", "//", " ", "Column"}], " ", "//", " ", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.657308418093299*^9, 3.6573085052975464`*^9}, {
  3.6573088219376464`*^9, 3.657308842872547*^9}, {3.657308889374916*^9, 
  3.6573088895997005`*^9}, {3.657320360191884*^9, 3.6573203734427347`*^9}, {
  3.6574669502426677`*^9, 3.657466964470499*^9}, {3.657908281576789*^9, 
  3.657908282216444*^9}, {3.6579083161858077`*^9, 3.6579083445313663`*^9}, {
  3.657908725096837*^9, 3.6579087743877616`*^9}, {3.6579118359401245`*^9, 
  3.657911872408023*^9}, {3.6579129461702127`*^9, 3.6579129482271166`*^9}, {
  3.658074383300229*^9, 3.658074387164471*^9}, {3.6581732629442644`*^9, 
  3.65817328372982*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"konpt", ">", "0"}], ",", 
   RowBox[{"koffpt", ">", "0"}], ",", 
   RowBox[{"konpc", ">", "0"}], ",", 
   RowBox[{"koffpc", ">", "0"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.658173262958803*^9, 3.658173283741352*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["c", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "konpc"}], " ", 
         RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}]}], "+", 
        RowBox[{"koffpc", " ", 
         RowBox[{"pc", "[", "\[Tau]", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["p", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "konpc"}], " ", 
         RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}]}], "+", 
        RowBox[{"koffpc", " ", 
         RowBox[{"pc", "[", "\[Tau]", "]"}]}], "+", 
        RowBox[{"koffpt", " ", 
         RowBox[{"pt", "[", "\[Tau]", "]"}]}], "-", 
        RowBox[{"konpt", " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["pc", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"konpc", " ", 
         RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}]}], "-", 
        RowBox[{"koffpc", " ", 
         RowBox[{"pc", "[", "\[Tau]", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["pt", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "koffpt"}], " ", 
         RowBox[{"pt", "[", "\[Tau]", "]"}]}], "+", 
        RowBox[{"konpt", " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["t", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"koffpt", " ", 
         RowBox[{"pt", "[", "\[Tau]", "]"}]}], "-", 
        RowBox[{"konpt", " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}]}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Input",
 CellChangeTimes->{{3.658173262971343*^9, 3.6581732837478676`*^9}}],

Cell["Initially, nothing is bound", "Text",
 CellChangeTimes->{{3.658074443480913*^9, 3.6580744492809505`*^9}}],

Cell[BoxData[
 RowBox[{"inits", " ", "=", " ", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "0", "]"}], " ", "\[Equal]", " ", "p0"}], ",", " ", 
    RowBox[{
     RowBox[{"t", "[", "0", "]"}], " ", "\[Equal]", " ", "t0"}], ",", " ", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], " ", "\[Equal]", " ", "c0"}], ",", " ", 
    RowBox[{
     RowBox[{"pt", "[", "0", "]"}], "\[Equal]", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"pc", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6573199274565573`*^9, 3.657319975253612*^9}, {
  3.6574670960755973`*^9, 3.6574671091030045`*^9}, {3.6579088826673355`*^9, 
  3.657908883774333*^9}, {3.6579096728379726`*^9, 3.657909690133672*^9}, {
  3.657909953830184*^9, 3.6579099790440493`*^9}, {3.6579102469662256`*^9, 
  3.6579102532709785`*^9}, {3.657911906002739*^9, 3.657911909798383*^9}, {
  3.657912867845005*^9, 3.657912867989257*^9}, {3.6579130566736803`*^9, 
  3.6579130663569717`*^9}}],

Cell["\<\
We try to explore things numerically. As we\[CloseCurlyQuote]re really only \
interested in the relative behavior of c vs t, we can canonicallize some \
constants; this in effect just sets some odd units. We also pick some \
arbitrary values for other parameters.\
\>", "Text",
 CellChangeTimes->{{3.6579109459710965`*^9, 3.657910984252788*^9}, {
  3.6580745113062735`*^9, 3.6580745246264796`*^9}, {3.6580746725309086`*^9, 
  3.6580746833308315`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"eqns", " ", "=", " ", 
    RowBox[{"reactionEqns", " ", "~", "Join", "~", " ", "inits"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"canonical", " ", "=", " ", 
   RowBox[{"{", " ", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"eqns", " ", "=", " ", 
  RowBox[{"eqns", " ", "/.", "canonical"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqns", " ", "//", " ", "Column"}], " ", "//", " ", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"vars", " ", "=", " ", 
  RowBox[{
   RowBox[{"#", "&"}], " ", "/@", " ", "stateVariables"}]}]}], "Input",
 CellChangeTimes->{
  3.6579088975069056`*^9, {3.657908955974598*^9, 3.65790897087391*^9}, {
   3.657909635582333*^9, 3.657909647074128*^9}, {3.6579097221771593`*^9, 
   3.6579097610852027`*^9}, {3.657909873320117*^9, 3.6579098998291273`*^9}, {
   3.657909931149642*^9, 3.6579099317468605`*^9}, {3.65790999310198*^9, 
   3.657909998042841*^9}, {3.6579102053120985`*^9, 3.6579102060934544`*^9}, {
   3.657910264349017*^9, 3.6579102690852323`*^9}, {3.657910738824068*^9, 
   3.657910787230201*^9}, {3.6579108204115734`*^9, 3.6579108611024203`*^9}, {
   3.657910896915514*^9, 3.6579109204775085`*^9}, {3.657910991351766*^9, 
   3.657910992951291*^9}, {3.6579111177016697`*^9, 3.6579111180069714`*^9}, {
   3.6579117134299755`*^9, 3.657911715059877*^9}, {3.6579119219304266`*^9, 
   3.657911922474709*^9}, {3.657912932533478*^9, 3.6579129330530076`*^9}, 
   3.6579129631074457`*^9, {3.657913004374511*^9, 3.657913023373033*^9}, {
   3.657913076061884*^9, 3.6579130900867743`*^9}, {3.65791507019497*^9, 
   3.6579150702989345`*^9}, {3.6579151044594035`*^9, 3.657915104598428*^9}, {
   3.6579158156812162`*^9, 3.6579158360979414`*^9}, {3.6579159186195626`*^9, 
   3.657915919597476*^9}, {3.658074503826096*^9, 3.658074564191079*^9}, {
   3.6580748616736703`*^9, 3.6580748626851425`*^9}, {3.65807578357644*^9, 
   3.6580757946724873`*^9}, {3.6580758326155024`*^9, 3.658075838374552*^9}, {
   3.6580779442981677`*^9, 3.65807794482499*^9}, 3.6580785273584375`*^9, {
   3.6580786892051563`*^9, 3.658078711358463*^9}, 3.658080307468128*^9, {
   3.658080356768101*^9, 3.6580803729190197`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["c", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "konpc"}], " ", 
      RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
      RowBox[{"p", "[", "\[Tau]", "]"}]}], "+", 
     RowBox[{"koffpc", " ", 
      RowBox[{"pc", "[", "\[Tau]", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["p", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "konpc"}], " ", 
      RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
      RowBox[{"p", "[", "\[Tau]", "]"}]}], "+", 
     RowBox[{"koffpc", " ", 
      RowBox[{"pc", "[", "\[Tau]", "]"}]}], "+", 
     RowBox[{"koffpt", " ", 
      RowBox[{"pt", "[", "\[Tau]", "]"}]}], "-", 
     RowBox[{"konpt", " ", 
      RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
      RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["pc", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"konpc", " ", 
      RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
      RowBox[{"p", "[", "\[Tau]", "]"}]}], "-", 
     RowBox[{"koffpc", " ", 
      RowBox[{"pc", "[", "\[Tau]", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["pt", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "koffpt"}], " ", 
      RowBox[{"pt", "[", "\[Tau]", "]"}]}], "+", 
     RowBox[{"konpt", " ", 
      RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
      RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["t", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"koffpt", " ", 
      RowBox[{"pt", "[", "\[Tau]", "]"}]}], "-", 
     RowBox[{"konpt", " ", 
      RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
      RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}], ",", 
   RowBox[{
    RowBox[{"t", "[", "0", "]"}], "\[Equal]", "t0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "0", "]"}], "\[Equal]", "c0"}], ",", 
   RowBox[{
    RowBox[{"pt", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"pc", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.658173262990888*^9, 3.658173283710332*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["c", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "konpc"}], " ", 
         RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}]}], "+", 
        RowBox[{"koffpc", " ", 
         RowBox[{"pc", "[", "\[Tau]", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["p", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "konpc"}], " ", 
         RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}]}], "+", 
        RowBox[{"koffpc", " ", 
         RowBox[{"pc", "[", "\[Tau]", "]"}]}], "+", 
        RowBox[{"koffpt", " ", 
         RowBox[{"pt", "[", "\[Tau]", "]"}]}], "-", 
        RowBox[{"konpt", " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["pc", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"konpc", " ", 
         RowBox[{"c", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}]}], "-", 
        RowBox[{"koffpc", " ", 
         RowBox[{"pc", "[", "\[Tau]", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["pt", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "koffpt"}], " ", 
         RowBox[{"pt", "[", "\[Tau]", "]"}]}], "+", 
        RowBox[{"konpt", " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["t", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"koffpt", " ", 
         RowBox[{"pt", "[", "\[Tau]", "]"}]}], "-", 
        RowBox[{"konpt", " ", 
         RowBox[{"p", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"t", "[", "\[Tau]", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]},
     {
      RowBox[{
       RowBox[{"t", "[", "0", "]"}], "\[Equal]", "t0"}]},
     {
      RowBox[{
       RowBox[{"c", "[", "0", "]"}], "\[Equal]", "c0"}]},
     {
      RowBox[{
       RowBox[{"pt", "[", "0", "]"}], "\[Equal]", "0"}]},
     {
      RowBox[{
       RowBox[{"pc", "[", "0", "]"}], "\[Equal]", "0"}]}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Input",
 CellChangeTimes->{{3.6581732630094376`*^9, 3.6581732837153454`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Running the Model", "Section",
 CellChangeTimes->{{3.6591179759356785`*^9, 3.6591179810637417`*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"parameters", " ", "=", "  ", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Tau]max", " ", "=", " ", 
     RowBox[{"10", "^", "log\[Tau]max"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"soln", " ", "=", " ", 
     RowBox[{"ParametricNDSolve", "[", 
      RowBox[{"eqns", ",", " ", "vars", ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", " ", "0", ",", " ", "\[Tau]max"}], "}"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{
        "konpt", ",", " ", "konpc", ",", " ", "koffpt", ",", " ", "koffpc", 
         ",", " ", "t0", ",", " ", "c0", ",", " ", "p0"}], "}"}], ",", " ", 
       RowBox[{"MaxStepSize", "\[Rule]", 
        RowBox[{"\[Tau]max", "/", "1000"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Grid", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"pt", "[", 
                   RowBox[{
                    RowBox[{"10", "^", "logkon1"}], ",", " ", 
                    RowBox[{"10", "^", "logkon2"}], ",", " ", 
                    RowBox[{"10", "^", "logkoff1"}], ",", " ", 
                    RowBox[{"10", "^", "logkoff2"}], ",", " ", 
                    RowBox[{"10", "^", "logt0"}], ",", " ", 
                    RowBox[{"10", "^", "logc0"}], ",", " ", 
                    RowBox[{"10", "^", "logp0"}]}], "]"}], "[", "\[Tau]", 
                  "]"}], "/", " ", 
                 RowBox[{"(", 
                  RowBox[{"10", "^", "logt0"}], ")"}]}], ")"}], ",", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"pc", "[", 
                   RowBox[{
                    RowBox[{"10", "^", "logkon1"}], ",", " ", 
                    RowBox[{"10", "^", "logkon2"}], ",", " ", 
                    RowBox[{"10", "^", "logkoff1"}], ",", " ", 
                    RowBox[{"10", "^", "logkoff2"}], ",", " ", 
                    RowBox[{"10", "^", "logt0"}], ",", " ", 
                    RowBox[{"10", "^", "logc0"}], ",", " ", 
                    RowBox[{"10", "^", "logp0"}]}], "]"}], "[", "\[Tau]", 
                  "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"10", "^", "logc0"}], ")"}]}], ")"}]}], 
              "\[IndentingNewLine]", "}"}], " ", "/.", " ", "parameters"}], 
            " ", "/.", " ", "soln"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Tau]", ",", "0", ",", "\[Tau]max"}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], ",", " ", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", " ", 
          RowBox[{"PlotLegends", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"\"\<pt/t0\>\"", ",", " ", "\"\<pc/c0\>\""}], "}"}]}], 
          ",", " ", 
          RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<seconds\>\"", ",", " ", "\"\<fraction bound\>\""}], 
            "}"}]}]}], "]"}], "}"}], ",", " ", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"pt", "[", 
                   RowBox[{
                    RowBox[{"10", "^", "logkon1"}], ",", " ", 
                    RowBox[{"10", "^", "logkon2"}], ",", " ", 
                    RowBox[{"10", "^", "logkoff1"}], ",", " ", 
                    RowBox[{"10", "^", "logkoff2"}], ",", " ", 
                    RowBox[{"10", "^", "logt0"}], ",", " ", 
                    RowBox[{"10", "^", "logc0"}], ",", " ", 
                    RowBox[{"10", "^", "logp0"}]}], "]"}], "[", "\[Tau]", 
                  "]"}], "/", " ", 
                 RowBox[{"(", "1", ")"}]}], ")"}], ",", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"pc", "[", 
                   RowBox[{
                    RowBox[{"10", "^", "logkon1"}], ",", " ", 
                    RowBox[{"10", "^", "logkon2"}], ",", " ", 
                    RowBox[{"10", "^", "logkoff1"}], ",", " ", 
                    RowBox[{"10", "^", "logkoff2"}], ",", " ", 
                    RowBox[{"10", "^", "logt0"}], ",", " ", 
                    RowBox[{"10", "^", "logc0"}], ",", " ", 
                    RowBox[{"10", "^", "logp0"}]}], "]"}], "[", "\[Tau]", 
                  "]"}], "/", 
                 RowBox[{"(", "1", ")"}]}], ")"}]}], "\[IndentingNewLine]", 
              "}"}], " ", "/.", " ", "parameters"}], " ", "/.", " ", "soln"}],
            "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Tau]", ",", "0", ",", "\[Tau]max"}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "Automatic"}], "}"}]}], ",", " ", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", " ", 
          RowBox[{"PlotLegends", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"\"\<pt\>\"", ",", " ", "\"\<pc\>\""}], "}"}]}], ",", " ", 
          RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<seconds\>\"", ",", " ", "\"\<total bound\>\""}], 
            "}"}]}]}], "]"}], "\[IndentingNewLine]", "}"}]}], "}"}], "]"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"log\[Tau]max", ",", " ", 
             RowBox[{"-", "6."}], ",", " ", "\"\<\[Tau]max\>\""}], "}"}], ",",
            " ", 
           RowBox[{"-", "10"}], ",", " ", "1"}], "}"}], "]"}], ",", " ", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"10", "^", "log\[Tau]max"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"logp0", ",", " ", "0", ",", " ", "\"\<p0   \>\""}], 
            "}"}], ",", " ", 
           RowBox[{"-", "10"}], ",", " ", "2"}], "}"}], "]"}], ",", " ", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"10", "^", "logp0"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"logt0", ",", " ", "0", ",", " ", "\"\<t0   \>\""}], 
            "}"}], ",", " ", 
           RowBox[{"-", "10"}], ",", " ", "2"}], "}"}], "]"}], ",", " ", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"10", "^", "logt0"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"logc0", ",", " ", "0", ",", " ", "\"\<c0   \>\""}], 
            "}"}], ",", " ", 
           RowBox[{"-", "10"}], ",", " ", "2"}], "}"}], " ", "]"}], ",", " ", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"10", "^", "logc0"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"logkon1", ",", " ", "7", ",", " ", "\"\<konpt\>\""}], 
            "}"}], ",", " ", "0", ",", " ", "10"}], "}"}], "]"}], ",", " ", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"10", "^", "logkon1"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"logkoff1", ",", " ", "6", ",", " ", "\"\<koffpt\>\""}], 
            "}"}], ",", " ", "0", ",", " ", "12"}], "}"}], "]"}], ",", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"10", "^", "logkoff1"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"logkon2", ",", " ", "7", ",", " ", "\"\<konpc\>\""}], 
            "}"}], ",", " ", "0", ",", " ", "10"}], "}"}], "]"}], ",", " ", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"10", "^", "logkon2"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"logkoff2", ",", " ", "6", ",", " ", "\"\<koffpc\>\""}], 
            "}"}], ",", " ", "0", ",", " ", "12"}], "}"}], "]"}], ",", " ", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"10", "^", "logkoff2"}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6580782337208977`*^9, 3.6580783583154325`*^9}, {
   3.6580784794110394`*^9, 3.658078505346292*^9}, {3.6580785372334337`*^9, 
   3.6580786043439293`*^9}, {3.6580786724893847`*^9, 
   3.6580786803125935`*^9}, {3.658078731065477*^9, 3.6580788110794897`*^9}, {
   3.6580788586082525`*^9, 3.65807886514954*^9}, {3.6580792713132524`*^9, 
   3.6580792753761497`*^9}, {3.658079316425173*^9, 3.658079324326563*^9}, {
   3.6580793615060353`*^9, 3.6580794414023933`*^9}, {3.658079606265706*^9, 
   3.6580798128849645`*^9}, {3.658079848848884*^9, 3.658079867547118*^9}, {
   3.6580799447535114`*^9, 3.6580799471515627`*^9}, {3.6580803342813263`*^9, 
   3.6580804650864787`*^9}, {3.6580808144942656`*^9, 
   3.6580810806945257`*^9}, {3.6580811180357075`*^9, 
   3.6580811307418694`*^9}, {3.658081170714875*^9, 3.6580811867827272`*^9}, {
   3.6580812556695833`*^9, 3.6580812806068077`*^9}, {3.658081459778222*^9, 
   3.658081482328864*^9}, {3.6580816566120977`*^9, 3.6580816619710484`*^9}, {
   3.658081764853757*^9, 3.658081939344699*^9}, {3.6580819868167458`*^9, 
   3.6580821584118977`*^9}, {3.6580822052241883`*^9, 3.658082243129983*^9}, {
   3.6581727270473623`*^9, 3.6581728173073673`*^9}, {3.6581729198657417`*^9, 
   3.658172975218233*^9}, {3.658173143482876*^9, 3.658173146291352*^9}, {
   3.6581732630304937`*^9, 3.6581732837222996`*^9}, {3.6581733193002768`*^9, 
   3.6581733272059565`*^9}, {3.6581733888945656`*^9, 3.658173492392943*^9}, {
   3.658173578538686*^9, 3.6581736015982137`*^9}, {3.659116185584116*^9, 
   3.6591161897578917`*^9}, {3.659116446993737*^9, 3.6591164505617094`*^9}, 
   3.6591179732963676`*^9}]
}, Open  ]]
},
WindowSize->{1304, 1548},
WindowMargins->{{Automatic, 207}, {Automatic, 0}},
CellContext->Notebook,
InputAliases->{"intt" -> RowBox[{"\[Integral]", 
     RowBox[{"\[SelectionPlaceholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "dintt" -> RowBox[{
     SubsuperscriptBox[
     "\[Integral]", "\[SelectionPlaceholder]", "\[Placeholder]"], 
     RowBox[{"\[Placeholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "sumt" -> RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "prodt" -> RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "dt" -> RowBox[{
     SubscriptBox["\[PartialD]", "\[Placeholder]"], " ", 
     "\[SelectionPlaceholder]"}], "ket" -> 
  TemplateBox[{"\[Placeholder]"}, "Ket"], "bra" -> 
  TemplateBox[{"\[Placeholder]"}, "Bra"], "braket" -> 
  TemplateBox[{"\[Placeholder]", "\[Placeholder]"}, "BraKet"], "notation" -> 
  RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation>" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation<" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "symb" -> RowBox[{"Symbolize", "[", 
     TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], "]"}], 
  "infixnotation" -> RowBox[{"InfixNotation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], ",", 
       "\[Placeholder]"}], "]"}], "addia" -> RowBox[{"AddInputAlias", "[", 
     RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "pattwraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationPatternTag"], 
  "madeboxeswraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationMadeBoxesTag"], "rxn" -> 
  OverscriptBox["\[RightArrow]", "\[Placeholder]"], "erxn" -> RowBox[{
     UnderoverscriptBox[
      TagBox[
       TagBox["\[Equilibrium]", DisplayForm], DisplayForm], "\[Placeholder]", 
      "\[Placeholder]"], " "}]},
Magnification:>0.95 Inherited,
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 157, 2, 67, "Section"],
Cell[CellGroupData[{
Cell[762, 28, 166, 2, 46, "Subsection"],
Cell[931, 32, 2953, 75, 116, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[3921, 112, 97, 1, 38, "Subsection"],
Cell[4021, 115, 254, 5, 18, "Text"],
Cell[4278, 122, 1814, 42, 143, "Input"],
Cell[6095, 166, 6080, 173, 288, "Input"],
Cell[12178, 341, 2385, 63, 93, "Input"],
Cell[14566, 406, 699, 19, 25, "Input"],
Cell[15268, 427, 528, 14, 25, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[15833, 446, 161, 2, 38, "Subsection"],
Cell[15997, 450, 608, 11, 19, "Input"],
Cell[16608, 463, 6265, 99, 79, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[22910, 567, 97, 1, 38, "Subsection"],
Cell[23010, 570, 184, 4, 27, "Text"],
Cell[23197, 576, 1926, 46, 101, "Input"],
Cell[25126, 624, 272, 7, 28, "Input"],
Cell[25401, 633, 2547, 73, 81, "Input"],
Cell[27951, 708, 111, 1, 27, "Text"],
Cell[28065, 711, 987, 20, 28, "Input"],
Cell[29055, 733, 461, 8, 45, "Text"],
Cell[29519, 743, 2205, 38, 105, "Input"],
Cell[31727, 783, 2494, 71, 48, "Input"],
Cell[34224, 856, 2949, 88, 152, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37222, 950, 106, 1, 67, "Section"],
Cell[37331, 953, 11522, 257, 651, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
