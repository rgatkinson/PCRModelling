(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    238619,       4949]
NotebookOptionsPosition[    232850,       4796]
NotebookOutlinePosition[    235850,       4863]
CellTagsIndexPosition[    235807,       4860]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Code for the Model", "Section",
 CellChangeTimes->{{3.6348397084940505`*^9, 3.6348397089180746`*^9}, {
  3.63486890578404*^9, 3.6348689079761653`*^9}}],

Cell[CellGroupData[{

Cell["Miscellaneous Utilities", "Subsection",
 CellChangeTimes->{{3.6345770377895007`*^9, 3.6345770388395023`*^9}, {
  3.6348493313534465`*^9, 3.634849334721639*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"makeState", "[", "list_List", "]"}], " ", ":=", " ", 
  "list"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"readState", "[", 
   RowBox[{"state_", ",", " ", "symbol_Symbol"}], "]"}], " ", ":=", " ", 
  RowBox[{"readState", "[", 
   RowBox[{"state", ",", " ", "symbol", ",", " ", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"readState", "[", 
   RowBox[{"state_", ",", " ", "symbol_Symbol", ",", " ", "default_"}], "]"}],
   " ", ":=", " ", 
  RowBox[{"symbol", " ", "/.", " ", 
   RowBox[{"(", 
    RowBox[{"state", " ", "~", "Join", "~", " ", 
     RowBox[{"{", 
      RowBox[{"symbol", " ", "\[Rule]", " ", "default"}], "}"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"preempt", "[", 
   RowBox[{"new_", ",", " ", "old_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"keys", ",", " ", "replacements", ",", " ", "values"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"keys", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"old", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "~", "Join", "~", " ", 
        RowBox[{"new", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "//", " ", "Union"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"replacements", " ", "=", " ", 
      RowBox[{"FilterRules", "[", 
       RowBox[{"new", ",", " ", "keys"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"values", " ", "=", " ", 
      RowBox[{
       RowBox[{"keys", " ", "/.", " ", "replacements"}], " ", "/.", " ", 
       "old"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Rule", " ", "@@", "#"}], "&"}], " ", "/@", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"keys", ",", " ", "values"}], "}"}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"preempt", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "b"}], ",", " ", 
     RowBox[{"e", "\[Rule]", "f"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "c"}], ",", " ", 
     RowBox[{"c", "\[Rule]", "d"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"readState", "[", 
  RowBox[{
   RowBox[{"makeState", "[", 
    RowBox[{"{", 
     RowBox[{"a", "\[Rule]", " ", "7"}], "}"}], "]"}], ",", " ", "b", ",", 
   " ", "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6345770416095057`*^9, 3.6345770867245693`*^9}, {
  3.6345775909082794`*^9, 3.6345775995982914`*^9}, {3.6345777103344483`*^9, 
  3.6345777209574633`*^9}, {3.6346724423876963`*^9, 3.6346725064113584`*^9}, {
  3.6346726854505987`*^9, 3.634672702585579*^9}, {3.6348629106201363`*^9, 
  3.634862924819948*^9}, {3.635103000661501*^9, 3.635103019809596*^9}, {
  3.635130676146448*^9, 3.635130796666342*^9}, {3.6351311334886065`*^9, 
  3.635131138407888*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chemistry", "Subsection",
 CellChangeTimes->{{3.634849268721864*^9, 3.634849271306012*^9}}],

Cell["\<\
The main point of this section is, given a system of chemical equations, to \
be able to compute the set of differential rate equations that govern that \
system.\
\>", "Text",
 CellChangeTimes->{{3.6348504642652454`*^9, 3.634850510185872*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Notation`AutoLoadNotationPalette", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<Notation`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Notation", "[", 
  RowBox[{
   TemplateBox[{RowBox[{"a_", " ", 
       UnderoverscriptBox[
        TagBox[
         TagBox["\[Equilibrium]", DisplayForm], DisplayForm], "kr_", "kf_"], 
       " ", "b_"}]},
    "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
   TemplateBox[{RowBox[{"TChemicalReaction", "[", 
       RowBox[{
         RowBox[{"TChemicalExpr", "[", "a_", "]"}], ",", 
         RowBox[{"TChemicalExpr", "[", "b_", "]"}], ",", "kf_", ",", " ", 
         "kr_"}], "]"}]},
    "NotationTemplateTag"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Notation", "[", 
  RowBox[{
   TemplateBox[{RowBox[{"a_", 
       OverscriptBox["\[RightArrow]", "k_"], "b_"}]},
    "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
   TemplateBox[{RowBox[{"TChemicalReaction", "[", 
       RowBox[{
         RowBox[{"TChemicalExpr", "[", "a_", "]"}], ",", 
         RowBox[{"TChemicalExpr", "[", "b_", "]"}], ",", "k_", ",", " ", 
         "0"}], "]"}]},
    "NotationTemplateTag"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddInputAlias", "[", 
  RowBox[{"\"\<rxn\>\"", "\[Rule]", 
   TemplateBox[{OverscriptBox["\[RightArrow]", "\[Placeholder]"]},
    "NotationTemplateTag"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddInputAlias", "[", 
  RowBox[{"\"\<erxn\>\"", "\[Rule]", 
   TemplateBox[{RowBox[{
       UnderoverscriptBox[
        TagBox[
         TagBox["\[Equilibrium]", DisplayForm], DisplayForm], 
        "\[Placeholder]", "\[Placeholder]"], " "}]},
    "NotationTemplateTag"]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6348492985245686`*^9, 3.6348492997236376`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"chemicalReactionQ", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"x", ",", " ", 
     RowBox[{"TChemicalReaction", "[", 
      RowBox[{"_", ",", "_", ",", "_", ",", "_"}], "]"}]}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chemicalSystemPattern", " ", "=", " ", 
    RowBox[{"{", " ", 
     RowBox[{"Repeated", "[", 
      RowBox[{"_", "?", "chemicalReactionQ"}], "]"}], " ", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allSpecies", "[", 
   RowBox[{"TChemicalExpr", "[", "e_", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"Variables", "[", "e", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allSpecies", "[", 
   RowBox[{"TChemicalReaction", "[", 
    RowBox[{"r_", ",", "p_", ",", " ", "_", ",", " ", "_"}], "]"}], "]"}], 
  " ", ":=", " ", 
  RowBox[{
   RowBox[{"allSpecies", "[", "r", "]"}], " ", "\[Union]", " ", 
   RowBox[{"allSpecies", "[", "p", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"allSpecies", "[", 
     RowBox[{"system", " ", ":", " ", "chemicalSystemPattern"}], "]"}], " ", ":=",
     " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"allSpecies", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
       "system"}], " ", "//", " ", "Flatten"}], " ", "//", " ", "Union"}]}], 
   ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allParameters", "[", 
   RowBox[{"rxn", ":", "  ", 
    RowBox[{"TChemicalReaction", "[", 
     RowBox[{"r_", ",", "p_", ",", " ", "kf_", ",", " ", "kr_"}], "]"}]}], 
   "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Variables", "[", "kf", "]"}], ",", " ", 
      RowBox[{"Variables", "[", "kr", "]"}]}], "}"}], " ", "//", " ", 
    "Flatten"}], " ", "//", " ", "Union"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"allParameters", "[", 
     RowBox[{"system", " ", ":", " ", "chemicalSystemPattern"}], "]"}], " ", ":=",
     " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"allParameters", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
       "system"}], " ", "//", " ", "Flatten"}], " ", "//", " ", "Union"}]}], 
   ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stochiometry", "[", 
   RowBox[{
    RowBox[{"TChemicalExpr", "[", "expr_", "]"}], ",", " ", "species_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"expr", ",", " ", "species"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stochiometry", "[", 
   RowBox[{"e", ":", " ", 
    RowBox[{"TChemicalExpr", "[", "_", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[Nu]", "#"], "\[Rule]", 
     RowBox[{"stochiometry", "[", 
      RowBox[{"e", ",", " ", "#"}], "]"}]}], "&"}], " ", "/@", " ", 
   RowBox[{"allSpecies", "[", "e", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stochiometry", "[", 
   RowBox[{"rxn", ":", "  ", 
    RowBox[{"TChemicalReaction", "[", 
     RowBox[{"r_", ",", "p_", ",", " ", "_", ",", " ", "_"}], "]"}]}], "]"}], 
  " ", ":=", "  ", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[Nu]", "#"], "\[Rule]", 
     RowBox[{
      RowBox[{"stochiometry", "[", 
       RowBox[{"p", ",", " ", "#"}], "]"}], "-", 
      RowBox[{"stochiometry", "[", 
       RowBox[{"r", ",", " ", "#"}], "]"}]}]}], " ", "&"}], " ", "/@", " ", 
   RowBox[{"allSpecies", "[", "rxn", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stochiometry", "[", 
    RowBox[{"system", " ", ":", " ", "chemicalSystemPattern"}], "]"}], " ", ":=",
    " ", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "species", "}"}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Nu]", "species"], "\[Rule]", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["\[Nu]", "species"], " ", "/.", 
             RowBox[{"stochiometry", "[", "#", "]"}]}], " ", "/.", " ", 
            RowBox[{
             SubscriptBox["\[Nu]", "species"], "\[Rule]", " ", "0"}]}], "&"}],
           "/@", " ", "system"}], ")"}], "]"}]}]}], "]"}], "/@", " ", 
    RowBox[{"allSpecies", "[", "system", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rate", "[", 
   RowBox[{
    RowBox[{"e", ":", " ", 
     RowBox[{"TChemicalExpr", "[", "_", "]"}]}], ",", " ", "k_"}], "]"}], " ",
   ":=", " ", 
  RowBox[{"k", " ", "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", " ", "@@", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["#", 
          SubscriptBox["\[Nu]", "#"]], "&"}], "/@", " ", 
        RowBox[{"allSpecies", "[", "e", "]"}]}], ")"}]}], " ", "/.", " ", 
     RowBox[{"stochiometry", "[", "e", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rate", "[", 
    RowBox[{"rxn", " ", ":", " ", 
     RowBox[{"TChemicalReaction", "[", 
      RowBox[{"r_", ",", "p_", ",", " ", "kf_", ",", " ", "kr_"}], "]"}]}], 
    "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"rate", "[", 
     RowBox[{"r", ",", "kf"}], "]"}], " ", "-", " ", 
    RowBox[{"rate", "[", 
     RowBox[{"p", ",", "kr"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rate", "[", 
   RowBox[{
    RowBox[{"rxn", " ", ":", " ", 
     RowBox[{"TChemicalReaction", "[", 
      RowBox[{"_", ",", "_", ",", "_", ",", "_"}], "]"}]}], ",", " ", 
    "species_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"rate", "[", "rxn", "]"}], " ", "*", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Nu]", 
       RowBox[{"species", " "}]], "/.", " ", 
      RowBox[{"stochiometry", "[", "rxn", "]"}]}], " ", "/.", " ", 
     RowBox[{
      SubscriptBox["\[Nu]", 
       RowBox[{"species", " "}]], "\[Rule]", " ", "0"}]}], 
    ")"}]}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rateEqns", "[", 
   RowBox[{
    RowBox[{"rxn_", "?", "chemicalReactionQ"}], ",", " ", "t_"}], "]"}], " ", 
  ":=", " ", 
  RowBox[{"rates", "[", 
   RowBox[{
    RowBox[{"{", "rxn", "}"}], ",", " ", "t"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rateEqns", "[", 
   RowBox[{
    RowBox[{"system", " ", ":", " ", "chemicalSystemPattern"}], ",", " ", 
    "t_", ",", " ", "optionsSeq___Rule"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"options", ",", "  ", "systemSpecies", ",", " ", "exprs"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"options", " ", "=", " ", 
      RowBox[{"preempt", "[", 
       RowBox[{
        RowBox[{"{", " ", "optionsSeq", " ", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"WasteSpecies", " ", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"systemSpecies", " ", "=", " ", 
      RowBox[{"allSpecies", "[", "system", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"systemSpecies", " ", "=", " ", 
      RowBox[{"Intersection", "[", 
       RowBox[{"systemSpecies", ",", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{"systemSpecies", ",", " ", 
          RowBox[{"(", 
           RowBox[{"WasteSpecies", " ", "/.", " ", "options"}], ")"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "species", "}"}], ",", " ", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"species", "[", "t", "]"}], ",", "t"}], "]"}], " ", "==", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"#", ",", " ", "species"}], "]"}], "&"}], "/@", " ", 
             "system"}], "]"}], " ", "/.", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"#", " ", "\[Rule]", " ", 
               RowBox[{"#", "[", "t", "]"}]}], "&"}], " ", "/@", " ", 
             "systemSpecies"}], ")"}]}], ")"}]}]}], "]"}], "/@", 
      "systemSpecies"}]}]}], " ", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6348494258278503`*^9, 3.634849432539234*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rateEqns", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "+", " ", "G"}], " ", 
       OverscriptBox["\[RightArrow]", "k"], " ", 
       RowBox[{"P", " ", "+", " ", "W1"}]}], ",", " ", 
      RowBox[{
       RowBox[{"P", " ", "+", " ", "R"}], " ", 
       OverscriptBox["\[RightArrow]", "q"], " ", 
       RowBox[{"F", " ", "+", " ", "W2"}]}]}], "}"}], ",", " ", "\[Tau]", ",",
     " ", 
    RowBox[{"WasteSpecies", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"W1", ",", " ", "W2"}], "}"}]}]}], "]"}], " ", "//", " ", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.6348495618736315`*^9, 3.634849562265654*^9}}],

Cell[BoxData[
 RowBox[{"stochiometry", "[", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "+", " ", "G"}], " ", 
     OverscriptBox["\[RightArrow]", "k"], " ", 
     RowBox[{"P", " ", "+", " ", "W1"}]}], ",", " ", 
    RowBox[{
     RowBox[{"P", " ", "+", " ", "R"}], " ", 
     OverscriptBox["\[RightArrow]", "q"], " ", 
     RowBox[{"F", " ", "+", " ", "W2"}]}], ",", " ", 
    RowBox[{
     RowBox[{"A", " ", "+", " ", "B"}], " ", 
     OverscriptBox["\[RightArrow]", "d"], "C"}]}], "}"}], "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constants", "Subsection",
 CellChangeTimes->{{3.6344352200038705`*^9, 3.634435220931924*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"constants", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"initial", " ", "concentrations"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fStart", " ", "\[Rule]", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"rStart", " ", "\[Rule]", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"eStart", " ", "\[Rule]", "2.4*^-7"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"polymerase", " ", "enzyme"}], ",", " ", 
       RowBox[{"value", " ", "subject", " ", "to", " ", "confirmation"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"equilibrium", " ", "disassociation", " ", "constants"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"fteq", " ", "\[Rule]", " ", 
      RowBox[{"ftoff", " ", "/", " ", "fton"}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"rueq", " ", "\[Rule]", 
      RowBox[{"ruoff", " ", "/", " ", "ruon"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ku", " ", "\[Rule]", " ", "1.5096*^-54"}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"different", " ", "from", " ", "Gevertz"}], ",", " ", 
       RowBox[{"who", " ", "had", " ", 
        RowBox[{"zero", ".", " ", "This"}], " ", "is", " ", "ballpark", " ", 
        "from", " ", 
        RowBox[{"Nupack", " ", "@", "72"}], "deg", " ", "for", " ", "a", " ", 
        "random", " ", "200", "mer"}], ",", " ", 
       RowBox[{"\[CapitalDelta]G", "\[Equal]", 
        RowBox[{
         RowBox[{"-", "85.00"}], " ", 
         RowBox[{"kcal", "/", "mol"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"kd", " ", "\[Rule]", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "2"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"on", " ", "and", " ", "off", " ", "reaction", " ", "rates"}], 
      " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"fton", " ", "\[Rule]", " ", 
      RowBox[{"10", "^", "6"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ruon", " ", "\[Rule]", " ", 
      RowBox[{"10", "^", "6"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"konu", " ", "\[Rule]", " ", 
      RowBox[{"10", "^", "6"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"kond", " ", "\[Rule]", " ", 
      RowBox[{"10", "^", "6"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ftoff", " ", "\[Rule]", " ", "5.5531*^-7"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ruoff", " ", "\[Rule]", " ", "8.1493*^-5"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"koffu", " ", "\[Rule]", " ", 
      RowBox[{"ku", " ", "*", " ", "konu"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"koffd", " ", "\[Rule]", " ", 
      RowBox[{"10", "^", "4"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Michaelis", " ", "Menton", " ", "parameters"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"km", "\[Rule]", " ", "1.5*^-9"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kcat", "\[Rule]", " ", "0.17"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kcat", " ", "\[Rule]", " ", "kcat"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"kon1", " ", "\[Rule]", " ", 
      RowBox[{"polymeraseEfficiency", " ", "*", " ", 
       RowBox[{"(", 
        RowBox[{"kcat", " ", "*", " ", "konScale"}], ")"}]}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"koff1", " ", "\[Rule]", 
      RowBox[{"polymeraseEfficiency", " ", "*", " ", 
       RowBox[{"(", 
        RowBox[{"kcat", " ", "*", "koffScale"}], ")"}]}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"polymeraseEfficiency", " ", "\[Rule]", " ", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["koff", "0"], "\[Rule]", " ", 
      RowBox[{"koffScale", " ", "*", " ", "kcat"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"konScale", " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["koff", "0"], "+", " ", "kcat"}], ")"}], " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{"kcat", " ", "*", " ", "km"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"koffScale", " ", "\[Rule]", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "4"}]}]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"picked", " ", "pretty", " ", "arbitrarily"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"kcau", " ", "\[Rule]", " ", "kcat"}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"we", "'"}], "ll", " ", "keep", " ", "all", " ", "the", " ", 
        RowBox[{"kcat", "'"}], "s", " ", "the", " ", "same"}], ",", " ", 
       RowBox[{"for", " ", "now"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"kon2", " ", "\[Rule]", " ", "kon1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"koff2", " ", "\[Rule]", " ", "koff1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Polymerase", " ", "competition", " ", 
       RowBox[{"control", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"kon3", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"kon4", " ", "\[Rule]", " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"koff3", " ", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"koff4", " ", "\[Rule]", " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Duration", " ", "of", " ", "cycle", " ", "phases"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Tau]den", " ", "\[Rule]", " ", "5"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Tau]ann", " ", "\[Rule]", " ", "20"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Tau]ext", " ", "\[Rule]", " ", "15"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Polymerase", " ", "degredation", " ", "during", " ", "denaturing", " ",
        "phase"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"kdeg", "\[Rule]", " ", "1.9*^-4"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{
      "controls", " ", "degredation", " ", "of", " ", "polymerase", " ", 
       RowBox[{"in", " ", "'"}], 
       RowBox[{"eqn26", "'"}], " ", "case"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"enzymeDegredation", " ", "\[Rule]", " ", "eqn26"}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"an", " ", "algorithm", " ", 
        RowBox[{"selector", ":", " ", "none"}]}], ",", " ", "eqn26", ",", " ", 
       RowBox[{"or", " ", "eqn27"}]}], "*)"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Miscellaneous", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"polymeraseAnnealEfficiency", " ", "\[Rule]", " ", "0.9"}]}], 
    " ", 
    RowBox[{"(*", " ", 
     RowBox[{"how", " ", "good", " ", "is", " ", 
      RowBox[{"poly", "'"}], "ase", " ", "in", " ", "anneal", " ", "phase", 
      " ", "vs", " ", "extension", " ", "phase"}], "*)"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state0", "[", "]"}], " ", ":=", " ", 
  RowBox[{"state0", "[", 
   RowBox[{
    RowBox[{"10", "^", 
     RowBox[{"-", "12"}]}], ",", " ", "constants"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state0", "[", 
   RowBox[{"tParam_", ",", " ", "constants_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"makeState", " ", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"f", " ", "\[Rule]", " ", "fStart"}], ",", " ", 
        RowBox[{"r", " ", "\[Rule]", " ", "rStart"}], ",", " ", 
        RowBox[{"t", " ", "\[Rule]", " ", "tParam"}], ",", " ", 
        RowBox[{"u", " ", "\[Rule]", " ", "tParam"}], ",", " ", 
        RowBox[{"tStart", "\[Rule]", " ", "tParam"}], ",", " ", 
        RowBox[{"uStart", "\[Rule]", " ", "tParam"}], ",", " ", 
        RowBox[{"e", " ", "\[Rule]", " ", "eStart"}]}], " ", "}"}], " ", "//.",
       " ", "constants"}], ")"}]}], " ", "//", " ", 
   "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"state0", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", "  ", 
     RowBox[{"t", ",", " ", "u", ",", "  ", "fteq", ",", " ", "ku", ",", " ", 
      RowBox[{"koffu", "/", "konu"}], ",", " ", "koffu", ",", " ", "konu"}], 
     " ", "}"}], " ", "//.", " ", 
    RowBox[{"state0", "[", "]"}]}], " ", "//.", " ", "constants"}], "//", " ",
   "N"}]}], "Input",
 CellChangeTimes->{{3.634435222143993*^9, 3.634435225780201*^9}, {
   3.6344355326827545`*^9, 3.6344358431055098`*^9}, {3.6344374258620386`*^9, 
   3.63443754513286*^9}, {3.6344376444285393`*^9, 3.634437665132724*^9}, {
   3.6344381175706015`*^9, 3.634438134160551*^9}, {3.634439339697503*^9, 
   3.6344393424166594`*^9}, {3.634439433712881*^9, 3.634439434448923*^9}, {
   3.6344394744162087`*^9, 3.634439479992528*^9}, 3.6344395111443095`*^9, {
   3.634482914057667*^9, 3.6344829197676744`*^9}, {3.6344898161093497`*^9, 
   3.6344898169893513`*^9}, {3.6344906260015326`*^9, 3.634490674926601*^9}, {
   3.634494723657215*^9, 3.6344947237272153`*^9}, {3.634494808954336*^9, 
   3.6344948091443367`*^9}, {3.6344950830337214`*^9, 3.634495083403722*^9}, {
   3.634495138009799*^9, 3.634495138109799*^9}, 3.63449518873687*^9, {
   3.634495631348048*^9, 3.6344956867351265`*^9}, {3.634495791056273*^9, 
   3.634495820140314*^9}, {3.6344959118544436`*^9, 3.6344959118944435`*^9}, 
   3.6345000069733047`*^9, {3.6345002117895937`*^9, 3.6345002183706026`*^9}, {
   3.634500267358672*^9, 3.634500267549672*^9}, 3.634500593147131*^9, 
   3.6345006265411787`*^9, {3.6345007787773924`*^9, 3.634500782718398*^9}, {
   3.6345009334866104`*^9, 3.634500933586611*^9}, 3.6345010506927757`*^9, 
   3.6345014170313015`*^9, {3.6345026937911277`*^9, 3.63450273827619*^9}, {
   3.6345031060047073`*^9, 3.6345031074747095`*^9}, 3.6345041252103586`*^9, {
   3.6345087939830613`*^9, 3.634508847383116*^9}, {3.634577112727606*^9, 
   3.6345771143686085`*^9}, 3.6346622554316564`*^9, {3.6346623070209465`*^9, 
   3.63466231436856*^9}, {3.6346623489070206`*^9, 3.634662353150228*^9}, {
   3.6346624149897366`*^9, 3.6346624224465494`*^9}, 3.63466245659801*^9, {
   3.63466267289239*^9, 3.6346626729703903`*^9}, 3.6346628680985327`*^9, {
   3.6346629271456366`*^9, 3.634662927317237*^9}, 3.6346629622144985`*^9, 
   3.634663046517046*^9, {3.634663179975281*^9, 3.6346631822372847`*^9}, {
   3.634667777166379*^9, 3.6346677985966053`*^9}, {3.6346744729588385`*^9, 
   3.6346745029255524`*^9}, {3.6346943511758075`*^9, 3.634694356307101*^9}, {
   3.634694684862893*^9, 3.634694712334464*^9}, {3.6346948426399174`*^9, 
   3.6346948452230654`*^9}, {3.634696096182616*^9, 3.634696100078839*^9}, {
   3.6348345565243745`*^9, 3.634834594316536*^9}, {3.634840502394459*^9, 
   3.6348405024984646`*^9}, {3.6348517553870935`*^9, 
   3.6348518156195383`*^9}, {3.634853297921321*^9, 3.634853324352833*^9}, {
   3.634853739813596*^9, 3.634853740877657*^9}, {3.6348538159579515`*^9, 
   3.63485384094038*^9}, {3.6348539524847603`*^9, 3.6348539562199736`*^9}, {
   3.6348540030526524`*^9, 3.6348540222037477`*^9}, {3.6348541789307117`*^9, 
   3.6348542689068584`*^9}, 3.6348611877135916`*^9, {3.634861230129018*^9, 
   3.634861243161763*^9}, {3.634861347696742*^9, 3.634861375008304*^9}, 
   3.6348614065361075`*^9, {3.6348614609842215`*^9, 3.634861469822727*^9}, {
   3.634861505031741*^9, 3.6348615639241095`*^9}, {3.634865634914957*^9, 
   3.6348656442874928`*^9}, {3.634865736143747*^9, 3.6348659868960896`*^9}, {
   3.6348671291724234`*^9, 3.6348671373038883`*^9}, {3.6348685191979284`*^9, 
   3.6348685427902775`*^9}, {3.6350159134777303`*^9, 3.635015922799743*^9}, {
   3.6350207602601385`*^9, 3.6350207645911446`*^9}, {3.635027870670311*^9, 
   3.6350279019210987`*^9}, {3.6350279947054057`*^9, 3.63502799548145*^9}, {
   3.6350281779998894`*^9, 3.6350281852393036`*^9}, {3.635096336534335*^9, 
   3.635096370806295*^9}, 3.635097805292343*^9, {3.63510229361306*^9, 
   3.635102328981083*^9}, {3.6351311685596123`*^9, 3.635131240733741*^9}, 
   3.635131845260318*^9, 3.6351319097710075`*^9, {3.6351319406357727`*^9, 
   3.6351319421878614`*^9}, {3.635188083212527*^9, 3.6351881426249247`*^9}, {
   3.6352643172198625`*^9, 3.63526432784247*^9}, {3.635264518721388*^9, 
   3.6352645807529354`*^9}, {3.635264633335943*^9, 3.635264672024156*^9}, {
   3.635264791791006*^9, 3.6352648151913447`*^9}, {3.6352654337147226`*^9, 
   3.6352654427862415`*^9}, {3.635265482138492*^9, 3.6352654962663*^9}, {
   3.6353430211983447`*^9, 3.635343053178401*^9}, {3.635343091524268*^9, 
   3.635343191699044*^9}, {3.6353433470129175`*^9, 3.635343382253379*^9}, {
   3.63534351308471*^9, 3.6353435267286353`*^9}, {3.635343692681833*^9, 
   3.635343718749479*^9}, {3.6353437694807677`*^9, 3.6353437738799753`*^9}, {
   3.6353438119128428`*^9, 3.6353438133012447`*^9}, 3.6353438437524986`*^9, {
   3.635356621501941*^9, 3.6353566539499984`*^9}, {3.635356685618054*^9, 
   3.6353567176293097`*^9}, {3.6353567731040077`*^9, 
   3.6353568508409443`*^9}, {3.635356916159259*^9, 3.635357267987677*^9}, {
   3.6353583686987176`*^9, 3.6353584646026864`*^9}, {3.635358510436567*^9, 
   3.6353585263173947`*^9}, {3.635358587126302*^9, 3.63535859745352*^9}, {
   3.635537128217101*^9, 3.6355371378181148`*^9}, {3.6355468346851406`*^9, 
   3.635546850267163*^9}, {3.659114056430811*^9, 3.659114065135726*^9}, {
   3.659114148114523*^9, 3.659114155326145*^9}, {3.6591145574053288`*^9, 
   3.659114581275977*^9}, {3.659114620144754*^9, 3.6591146296399384`*^9}, {
   3.6591195199579124`*^9, 3.659119566259323*^9}}],

Cell[BoxData[
 RowBox[{"stateVariables", " ", "=", " ", "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
   "f", ",", " ", "r", ",", " ", "ft", ",", " ", "ru", ",", " ", "t", ",", 
    " ", "u", ",", " ", "fr", ",", " ", "tu", ",", " ", "e", ",", " ", "eu", 
    ",", " ", "ed", ",", " ", "eft", ",", " ", "eru"}], "\[IndentingNewLine]",
    "}"}]}]], "Input",
 CellChangeTimes->{{3.635188245888831*^9, 3.635188285327087*^9}, {
   3.6355371548766394`*^9, 3.6355371552816396`*^9}, {3.635537186561184*^9, 
   3.6355371895411882`*^9}, {3.6591140564468093`*^9, 
   3.6591140651467237`*^9}, {3.659114148138506*^9, 3.6591141553331413`*^9}, 
   3.6591142809436097`*^9, 3.6591143959015656`*^9, {3.6591146201667585`*^9, 
   3.6591146296539345`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Annealing Model", "Subsection",
 CellChangeTimes->{{3.634862344829775*^9, 3.634862346701882*^9}}],

Cell[CellGroupData[{

Cell["Equilibrium Annealing Model", "Subsubsection",
 CellChangeTimes->{{3.6344315782535744`*^9, 3.6344315833338647`*^9}, {
  3.634862332982097*^9, 3.634862334222168*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"equilibriumEqns", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fT", " ", "\[Equal]", " ", 
      RowBox[{"f", " ", "+", " ", "ft", " ", "+", " ", "fr"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rT", " ", "\[Equal]", " ", 
      RowBox[{"r", " ", "+", " ", "ru", " ", "+", " ", "fr"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"tT", " ", "\[Equal]", " ", 
      RowBox[{"t", " ", "+", " ", "ft"}]}], " ", 
     RowBox[{"(*", 
      RowBox[{"+", " ", "tu"}], "*)"}], ",", "\[IndentingNewLine]", 
     RowBox[{"uT", " ", "\[Equal]", " ", 
      RowBox[{"u", " ", "+", " ", "ru"}]}], " ", 
     RowBox[{"(*", 
      RowBox[{"+", " ", "tu"}], "*)"}], ",", "\[IndentingNewLine]", 
     RowBox[{"fteq", " ", "\[Equal]", " ", 
      RowBox[{"f", " ", 
       RowBox[{"t", " ", "/", " ", "ft"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"rueq", " ", "\[Equal]", " ", 
      RowBox[{"r", " ", 
       RowBox[{"u", " ", "/", " ", "ru"}]}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"ku", " ", "\[Equal]", " ", 
        RowBox[{"t", " ", 
         RowBox[{"u", " ", "/", " ", "tu"}]}]}], ","}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"kd", " ", "\[Equal]", " ", 
      RowBox[{"f", " ", 
       RowBox[{"r", " ", "/", " ", "fr"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6344160609570355`*^9, 3.6344160709726086`*^9}, {
   3.6344161110679016`*^9, 3.634416213042734*^9}, {3.6344162710670533`*^9, 
   3.6344163209479065`*^9}, {3.6344166853597493`*^9, 3.6344166863278046`*^9}, 
   3.634417627338628*^9, {3.6344177059371233`*^9, 3.634417708072245*^9}, {
   3.6344177567540293`*^9, 3.6344179376633773`*^9}, {3.6344179820469155`*^9, 
   3.6344180479666862`*^9}, 3.6344181557508507`*^9, {3.634418949695262*^9, 
   3.634418995678892*^9}, {3.634419027028685*^9, 3.634419106678241*^9}, {
   3.6344214964379272`*^9, 3.6344214968059483`*^9}, {3.6344315714871874`*^9, 
   3.6344315854469852`*^9}, {3.6344382214955463`*^9, 
   3.6344382365594077`*^9}, {3.6344382696653013`*^9, 
   3.6344382783908005`*^9}, {3.6344389500092144`*^9, 3.634438999479044*^9}, {
   3.6344393480809827`*^9, 3.6344393498240824`*^9}, {3.634439535771718*^9, 
   3.6344395453072634`*^9}, {3.6344831140679483`*^9, 3.634483116377951*^9}, {
   3.634488112580595*^9, 3.6344881129705954`*^9}, {3.65911405645881*^9, 
   3.659114065161725*^9}, {3.659114148152505*^9, 3.659114155351164*^9}, {
   3.6591142827532687`*^9, 3.6591142879521313`*^9}, {3.659114397530306*^9, 
   3.659114401416642*^9}, {3.6591146201772957`*^9, 3.659114629668935*^9}, {
   3.6591195602024345`*^9, 3.6591195662703056`*^9}}],

Cell["\<\
A function that given the input state to the annealing step produces the \
state at the conclusion of the annealing step according to the equilibrium \
model.\
\>", "Text",
 CellChangeTimes->{{3.634480828485735*^9, 3.634480873349798*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"annealEquilibrium", "[", 
   RowBox[{"annealingInput_", ",", " ", "constants_", ",", " ", 
    RowBox[{"options_:", 
     RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "  ", 
     RowBox[{
     "eqns", ",", " ", "solns", ",", "result", " ", ",", " ", 
      "annEfficiency"}], " ", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eqns", " ", "=", " ", 
      RowBox[{
       RowBox[{"equilibriumEqns", " ", "/.", " ", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fT", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "f"}], "]"}], "  ", "+", 
             " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "ft"}], "]"}], " ", "+", 
             " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "fr"}], "]"}]}], ")"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"rT", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "r"}], "]"}], " ", "+", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "ru"}], "]"}], " ", "+", 
             " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "fr"}], "]"}]}], ")"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"tT", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "t"}], "]"}], " ", "+", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "ft"}], "]"}]}], ")"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"uT", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "u"}], "]"}], " ", "+", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "ru"}], "]"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], " ", "\[IndentingNewLine]", " ", "//.",
        " ", "constants"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"solns", " ", "=", " ", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"eqns", " ", "~", "Join", "~", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f", " ", "\[GreaterEqual]", "0"}], " ", ",", 
            RowBox[{"r", " ", "\[GreaterEqual]", "0"}]}], "}"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "ft", ",", "ru", ",", "f", ",", "r", ",", " ", "t", ",", " ", "u", 
           ",", " ", "fr"}], "}"}]}], "]"}], " ", "//", " ", "Quiet"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "solns", "]"}], " ", ">", " ", "0"}], ",", 
        RowBox[{"solns", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
        RowBox[{"preempt", "[", 
         RowBox[{"annealingInput", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ft", "\[Rule]", " ", "0"}], ",", " ", 
            RowBox[{"ru", "\[Rule]", " ", "0"}], ",", " ", 
            RowBox[{"f", "\[Rule]", "0"}], ",", 
            RowBox[{"r", "\[Rule]", "0"}], ",", 
            RowBox[{"t", "\[Rule]", "0"}], ",", 
            RowBox[{"u", "\[Rule]", "0"}], ",", 
            RowBox[{"fr", "\[Rule]", "0"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"annEfficiency", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ft", " ", "+", " ", "ru"}], ")"}], " ", "//.", " ", 
          "result"}], ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"readState", "[", 
           RowBox[{"annealingInput", ",", "t"}], "]"}], " ", "+", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingInput", ",", "u"}], "]"}]}], ")"}]}], " ", "//", 
       " ", "Quiet"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"suppress", " ", "division", " ", "by", " ", "zero"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"annEfficiency", " ", "===", " ", "Indeterminate"}], ",", " ", 
       RowBox[{"annEfficiency", " ", "=", " ", "0"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"preempt", "[", 
       RowBox[{"result", ",", " ", "annealingInput"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"preempt", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Epsilon]Ann", " ", "\[Rule]", " ", "annEfficiency"}], 
         "}"}], ",", " ", "result"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "//", " ", "makeState"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"annealEquilibrium", "[", 
  RowBox[{
   RowBox[{"state0", "[", "]"}], ",", " ", "constants"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"annealEquilibrium", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "\[Rule]", "0"}], ",", " ", 
     RowBox[{"r", "\[Rule]", "0"}], ",", " ", 
     RowBox[{"t", " ", "\[Rule]", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}]}], ",", " ", 
     RowBox[{"u", "\[Rule]", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}]}]}], "}"}], ",", " ", "constants"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6344350112349296`*^9, 3.6344350305100317`*^9}, {
   3.634437387533846*^9, 3.6344373879008675`*^9}, {3.6344381566878395`*^9, 
   3.634438201479401*^9}, {3.6344382971918755`*^9, 3.6344383259095182`*^9}, {
   3.6344383799156075`*^9, 3.634438408063217*^9}, {3.634438443478243*^9, 
   3.6344384446783113`*^9}, {3.634438679172724*^9, 3.634438681164838*^9}, {
   3.634438760676385*^9, 3.63443876355555*^9}, {3.6344388028457975`*^9, 
   3.634438898467266*^9}, {3.634438984707199*^9, 3.6344390489168715`*^9}, {
   3.634439097953676*^9, 3.634439098489707*^9}, {3.6344391489135914`*^9, 
   3.6344391533298435`*^9}, {3.634439356408459*^9, 3.634439395214679*^9}, {
   3.6344395483184357`*^9, 3.6344395486304536`*^9}, {3.634439595302123*^9, 
   3.634439639518652*^9}, 3.6344397214863405`*^9, {3.6344398187969065`*^9, 
   3.6344400586756268`*^9}, {3.634440144642544*^9, 3.634440165770752*^9}, {
   3.634440195994481*^9, 3.6344401966035156`*^9}, {3.634440229458395*^9, 
   3.634440381857112*^9}, {3.634440427096699*^9, 3.6344405112565126`*^9}, {
   3.6344807924396844`*^9, 3.6344807938796864`*^9}, {3.6344881220716085`*^9, 
   3.63448813785363*^9}, {3.6344884804410286`*^9, 3.634488492232045*^9}, {
   3.6344886734243*^9, 3.6344886826053133`*^9}, {3.634488997759083*^9, 
   3.634489008820098*^9}, {3.6344894267805*^9, 3.634489428050502*^9}, {
   3.6344974529487133`*^9, 3.634497461128724*^9}, {3.634577131370632*^9, 
   3.634577136271639*^9}, 3.6346678169726562`*^9, {3.6348622721926203`*^9, 
   3.6348622999922104`*^9}, {3.634921334367488*^9, 3.634921336629492*^9}, {
   3.635095901032426*^9, 3.6350959078408146`*^9}, {3.635101876015175*^9, 
   3.635101908046007*^9}, {3.63513145996628*^9, 3.6351315643812523`*^9}, {
   3.635131603229474*^9, 3.635131711164648*^9}, {3.6351318191318235`*^9, 
   3.6351318193958387`*^9}, {3.6351727776069326`*^9, 
   3.6351728868705244`*^9}, {3.6351729292089987`*^9, 
   3.6351729313306026`*^9}, {3.635188333583847*^9, 3.6351883636795683`*^9}, {
   3.635214097260445*^9, 3.6352141294032836`*^9}, {3.635214370162054*^9, 
   3.6352143748393216`*^9}, {3.635214437417901*^9, 3.6352144958072405`*^9}, {
   3.6352147515038657`*^9, 3.635214762695506*^9}, {3.6352147931122456`*^9, 
   3.63521480087969*^9}, {3.6352148414000072`*^9, 3.6352150923573613`*^9}, {
   3.6352151435412893`*^9, 3.635215328515869*^9}, {3.6352154426743984`*^9, 
   3.6352154540350485`*^9}, {3.635215514330497*^9, 3.635215557585971*^9}, {
   3.6355371735201654`*^9, 3.635537175990169*^9}, {3.635546659124894*^9, 
   3.6355466813579254`*^9}, {3.6355574836620526`*^9, 
   3.6355575112850914`*^9}, {3.659114056475316*^9, 3.659114064778965*^9}, {
   3.6591141481635237`*^9, 3.6591141553761854`*^9}, {3.6591142890972867`*^9, 
   3.6591142923129454`*^9}, {3.6591146201887927`*^9, 3.659114629687935*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Michaelis Menton Reactions", "Subsubsection",
 CellChangeTimes->{{3.635100055457045*^9, 3.635100062048422*^9}}],

Cell["\<\
The reactions are classic. Note that we have two sets, one for each hybrid \
(ft and ru). We also have competition with accumulated amplicons. Note that \
we list the reactions here rather than in the \[OpenCurlyQuote]Extension \
Model\[CloseCurlyQuote] section as we need them to handle the case where we \
do both extension and annealing in the \[OpenCurlyQuote]Kinetic Annealing \
Model\[CloseCurlyQuote].\
\>", "Text",
 CellChangeTimes->{{3.635197103456455*^9, 3.635197147528976*^9}, {
  3.6591141483482184`*^9, 3.6591141555202403`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"michaelisMentionReactions", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"e", " ", "+", " ", "ft"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "koff1", "kon1"], " ", "eft"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"eft", " ", 
      OverscriptBox["\[RightArrow]", "kcat"], " ", 
      RowBox[{"e", "+", "tu"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", " ", "+", " ", "ru"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "koff2", "kon2"], " ", "eru"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"eru", " ", 
      OverscriptBox["\[RightArrow]", "kcau"], 
      RowBox[{"e", "+", "tu"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", " ", "+", " ", "tu"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "koff3", "kon3"], " ", "eu"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", " ", "+", " ", "fr"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "koff4", "kon4"], " ", "ed"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extensionMichaelisMentionDiffEqs", " ", "=", " ", 
   RowBox[{"rateEqns", "[", 
    RowBox[{"michaelisMentionReactions", ",", " ", "\[Tau]", ",", " ", 
     RowBox[{"WasteSpecies", " ", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "//", " ", "Column"}], " ", "//", " ", 
  "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.6348650167976027`*^9, 3.6348650230939627`*^9}, {
   3.6348656456965733`*^9, 3.6348656466166263`*^9}, 3.6348657415280547`*^9, 
   3.6348657775281143`*^9, {3.635008989643858*^9, 3.635009025786909*^9}, {
   3.6350158639096603`*^9, 3.635015894073703*^9}, 3.635017749314889*^9, {
   3.6355372014022045`*^9, 3.635537218644229*^9}, {3.6591141483657465`*^9, 
   3.65911415472703*^9}, 3.6591142939524307`*^9, {3.659114407689497*^9, 
   3.659114410505247*^9}, {3.6591146202095904`*^9, 3.6591146296974387`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinetic Annealing Model", "Subsubsection",
 CellChangeTimes->{{3.6344809110048513`*^9, 3.634480913554855*^9}, {
  3.6348623371103334`*^9, 3.634862338510413*^9}}],

Cell["We have the fundamental annealing reactions from the paper.", "Text",
 CellChangeTimes->{{3.6344885044340625`*^9, 3.6344885073140664`*^9}, {
  3.634571544308897*^9, 3.6345715532689095`*^9}, {3.635099878577928*^9, 
  3.6350998882344804`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kineticAnnealingReactions", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"f", " ", "+", " ", "t"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "ftoff", "fton"], " ", "ft"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", " ", "+", " ", "u"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "ruoff", "ruon"], " ", "ru"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", " ", "+", " ", "u"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "koffu", "konu"], " ", "tu"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", " ", "+", "r"}], " ", 
      UnderoverscriptBox[
       TagBox[
        TagBox["\[Equilibrium]",
         DisplayForm],
        DisplayForm], "koffd", "kond"], " ", "fr"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kineticEqns", " ", "=", " ", 
   RowBox[{"rateEqns", "[", 
    RowBox[{"kineticAnnealingReactions", ",", "  ", "\[Tau]", ",", " ", 
     RowBox[{"WasteSpecies", " ", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kineticEqns", "//", " ", "Column"}], " ", "//", " ", 
  "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.634950655945882*^9, 3.6349508314709215`*^9}, {
   3.6349510597409773`*^9, 3.6349510636612015`*^9}, {3.6349511608367596`*^9, 
   3.6349511699402804`*^9}, {3.635009072442974*^9, 3.635009117547038*^9}, 
   3.635356624762347*^9, 3.6353566556036015`*^9, {3.6353566907504625`*^9, 
   3.635356718752512*^9}, {3.635356781356422*^9, 3.635356853680149*^9}, {
   3.659114055761104*^9, 3.659114064789945*^9}, {3.659114147173725*^9, 
   3.6591141547360287`*^9}, 3.659114231369073*^9, 3.6591144124579163`*^9, {
   3.659114620216564*^9, 3.6591146297064557`*^9}, {3.6591195199804153`*^9, 
   3.6591195461055355`*^9}}],

Cell["\<\
We consider both kinetic annealing and Michaelis Mention reactions together.\
\>", "Text",
 CellChangeTimes->{{3.635100500045474*^9, 3.6351005194055815`*^9}, 
   3.6351019494033723`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kineticAnnealAndMMEqns", " ", "=", " ", 
   RowBox[{"rateEqns", "[", 
    RowBox[{
     RowBox[{
     "kineticAnnealingReactions", " ", "~", "Join", "~", " ", 
      "michaelisMentionReactions"}], ",", " ", "\[Tau]", ",", " ", 
     RowBox[{"WasteSpecies", " ", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kineticAnnealAndMMEqns", "//", " ", "Column"}], " ", "//", " ", 
  "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.6351005235608187`*^9, 3.6351005758708105`*^9}}],

Cell["\<\
We construct a function that executes the annealing step according to the \
kinetic model. Optionally, in can include extension activity, but at a \
reduced efficiency.\
\>", "Text",
 CellChangeTimes->{{3.634571747538397*^9, 3.6345717614394164`*^9}, {
  3.635129163227914*^9, 3.635129189779433*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"annealKinetic", "[", 
   RowBox[{"annealingInput_", ",", " ", "constants_", ",", " ", 
    RowBox[{"options_:", 
     RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "  ", 
     RowBox[{
     "\[Tau]Anneal", ",", " ", "extend", ",", " ", "diffeqs", ",", " ", 
      "inits", ",", " ", "consts", ",", " ", "eqns", ",", " ", "vars", ",", 
      " ", "soln", ",", " ", "result", ",", " ", "annEfficiency", " ", ",", 
      " ", "\[CapitalDelta]f", ",", " ", "\[CapitalDelta]r"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"consts", " ", "=", " ", "constants"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"extend", " ", "=", " ", 
      RowBox[{"useExtendDuringAnneal", " ", "//.", " ", 
       RowBox[{"preempt", "[", 
        RowBox[{"options", ",", " ", 
         RowBox[{"{", 
          RowBox[{"useExtendDuringAnneal", " ", "\[Rule]", " ", "False"}], 
          "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"extend", ",", "\[IndentingNewLine]", 
       RowBox[{"consts", " ", "=", " ", 
        RowBox[{"preempt", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "polymeraseEfficiency", "\[Rule]", " ", 
            "polymeraseAnnealEfficiency"}], "}"}], ",", " ", "consts"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Tau]Anneal", " ", "=", " ", 
      RowBox[{"\[Tau]ann", " ", "//.", " ", "consts"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"diffeqs", " ", "=", " ", "kineticEqns"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inits", " ", "=", " ", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ft", "[", "0", "]"}], " ", "\[Equal]", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", " ", "ft", ",", " ", "0"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ru", "[", "0", "]"}], " ", "\[Equal]", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", " ", "ru", ",", " ", "0"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tu", "[", "0", "]"}], " ", "\[Equal]", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", " ", "tu", ",", " ", "0"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fr", "[", "0", "]"}], " ", "\[Equal]", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", " ", "fr", ",", " ", "0"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"f", "[", "0", "]"}], " ", "\[Equal]", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", "f", ",", " ", "0"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "[", "0", "]"}], " ", "\[Equal]", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", "r", ",", " ", "0"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t", "[", "0", "]"}], " ", "\[Equal]", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", "t", ",", " ", "0"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u", "[", "0", "]"}], " ", "\[Equal]", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", "u", ",", " ", "0"}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
       "ft", ",", " ", "ru", ",", " ", "tu", ",", " ", "fr", ",", " ", "f", 
        ",", " ", "r", ",", " ", "t", " ", ",", "u"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"extend", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"diffeqs", " ", "=", " ", "kineticAnnealAndMMEqns"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"inits", " ", "=", " ", 
         RowBox[{"inits", " ", "~", "Join", "~", " ", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"eft", "[", "0", "]"}], " ", "\[Equal]", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", "eft", ",", " ", "0"}], "]"}]}], 
            ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"eru", "[", "0", "]"}], " ", "\[Equal]", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", "eru", ",", " ", "0"}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"e", "[", "0", "]"}], " ", "==", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", " ", "e", ",", " ", "0"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"eu", "[", "0", "]"}], " ", "\[Equal]", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", "eu", ",", " ", "0"}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ed", "[", "0", "]"}], " ", "\[Equal]", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingInput", ",", "ed", ",", " ", "0"}], "]"}]}]}],
            "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vars", " ", "=", " ", 
         RowBox[{"vars", " ", "~", "Join", "~", " ", 
          RowBox[{"{", 
           RowBox[{
           "eft", ",", " ", "eru", ",", " ", "e", ",", "  ", "eu", ",", " ", 
            "ed"}], "}"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqns", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"diffeqs", " ", "//.", " ", "consts"}], ")"}], " ", "~", 
       "Join", "~", " ", "inits"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"soln", " ", "=", " ", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{"eqns", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", "\[Tau]", "]"}], "&"}], " ", "/@", " ", "vars"}],
          ",", " ", 
         RowBox[{"{", 
          RowBox[{"\[Tau]", ",", " ", "0", ",", " ", "\[Tau]Anneal"}], "}"}], 
         ",", " ", "\[IndentingNewLine]", 
         RowBox[{"AccuracyGoal", "\[Rule]", "MachinePrecision"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PrecisionGoal", "\[Rule]", "MachinePrecision"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MaxStepFraction", "\[Rule]", ".001"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", "\[Tau]", "]"}], " ", "/.", " ", "soln"}], 
             ")"}], " ", "/.", " ", 
            RowBox[{"\[Tau]", "\[Rule]", "\[Tau]Anneal"}]}], ")"}]}], "&"}], "/@",
         " ", "vars"}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"preempt", "[", 
       RowBox[{"result", ",", " ", "annealingInput"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"We", "'"}], "ll", " ", "use", " ", "an", " ", "annealing", 
        " ", "efficiency", " ", "cacluation", " ", "which", " ", "is", " ", 
        "equivalent", " ", "to", " ", "the", " ", "below"}], ",", " ", 
       RowBox[{
       "but", " ", "also", " ", "works", " ", "in", " ", "the", " ", 
        "extension", " ", "case", " ", "too"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Essentially", " ", "waht", " ", "we", " ", "do", " ", "is", " ", 
       "figure", " ", "out", " ", "how", " ", "many", " ", "free", " ", 
       "primers", " ", 
       RowBox[{"we", "'"}], "ve", " ", "lost", " ", "to", " ", "everything", 
       " ", "except", " ", "primer", " ", 
       RowBox[{"dimers", ".", " ", "Those"}], " ", "must", " ", "have"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"hybridized", ",", " ", 
       RowBox[{
       "and", " ", "either", " ", "still", " ", "be", " ", "hybrids", " ", 
        "or", " ", "have", " ", "been", " ", "extended", " ", "into", " ", 
        "duplex", " ", "amplicons"}], ",", " ", 
       RowBox[{"and", " ", 
        RowBox[{"so", ":", " ", 
         RowBox[{
         "be", " ", "the", " ", "amount", " ", "of", " ", "hybrids", " ", 
          RowBox[{"formed", "."}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Divided", " ", "by", " ", "the", " ", "total", " ", "template", " ", 
        "targets", " ", "we", " ", "have"}], ",", " ", 
       RowBox[{"and", " ", "we", " ", "get", " ", "the", " ", "efficiency"}], 
       ",", " ", 
       RowBox[{
       "just", " ", "as", " ", "in", " ", "eqn", " ", "31", " ", "in", " ", 
        "the", " ", "paper"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"annEfficiency", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ru", " ", "+", " ", "ru"}], ")"}], " ", "//.", " ", 
           "result"}], ")"}], " ", "/", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"readState", "[", 
            RowBox[{"annealingInput", ",", "t"}], "]"}], " ", "+", " ", 
           RowBox[{"readState", "[", 
            RowBox[{"annealingInput", ",", "u"}], "]"}]}], ")"}]}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]f", " ", "=", " ", 
      RowBox[{
       RowBox[{"readState", "[", 
        RowBox[{"annealingInput", ",", "f"}], "]"}], "-", " ", 
       RowBox[{"(", 
        RowBox[{"f", " ", "//.", " ", "result"}], ")"}], " ", "-", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"fr", " ", "//.", " ", "result"}], ")"}], " ", "-", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", " ", "fr"}], "]"}]}], ")"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
      RowBox[{
       RowBox[{"readState", "[", 
        RowBox[{"annealingInput", ",", "r"}], "]"}], " ", "-", " ", 
       RowBox[{"(", 
        RowBox[{"r", " ", "//.", " ", "result"}], ")"}], " ", "-", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"fr", " ", "//.", " ", "result"}], ")"}], " ", "-", " ", 
         RowBox[{"readState", "[", 
          RowBox[{"annealingInput", ",", " ", "fr"}], "]"}]}], ")"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"annEfficiency", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[CapitalDelta]f", " ", "+", " ", "\[CapitalDelta]r"}], 
         ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"readState", "[", 
           RowBox[{"annealingInput", ",", "t"}], "]"}], " ", "+", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingInput", ",", "u"}], "]"}]}], ")"}]}], " ", "//", 
       " ", "Quiet"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"annEfficiency", "===", "Indeterminate"}], ",", " ", 
       RowBox[{"annEfficiency", "=", "0"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"preempt", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Epsilon]Ann", " ", "\[Rule]", " ", "annEfficiency"}], 
         "}"}], ",", " ", "result"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "//", " ", "makeState"}]}]}], " ", 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"annealKinetic", "[", 
   RowBox[{
    RowBox[{"state0", "[", "]"}], ",", " ", 
    RowBox[{"preempt", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", " ", "constants"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"useExtendDuringAnneal", " ", "\[Rule]", " ", "False"}], "}"}]}],
    "]"}], " ", "//", "Sort"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"annealKinetic", "[", 
   RowBox[{
    RowBox[{"state0", "[", "]"}], ",", " ", 
    RowBox[{"preempt", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", " ", "constants"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"useExtendDuringAnneal", " ", "\[Rule]", " ", "True"}], "}"}]}], 
   "]"}], " ", "//", " ", "Sort"}]}], "Input",
 CellChangeTimes->{{3.634571774521435*^9, 3.634571825227506*^9}, {
   3.6345719142372336`*^9, 3.634571965913306*^9}, {3.6345719980063515`*^9, 
   3.6345720373694067`*^9}, {3.6345720899034805`*^9, 
   3.6345721104455094`*^9}, {3.634572142636555*^9, 3.6345722702297354`*^9}, {
   3.6345723398958335`*^9, 3.6345723427768373`*^9}, {3.634572376688885*^9, 
   3.6345726237152324`*^9}, {3.6345729275435*^9, 3.6345729284435015`*^9}, {
   3.634572958726544*^9, 3.634573001079603*^9}, 3.6345738253463397`*^9, {
   3.634574129795768*^9, 3.634574156118805*^9}, {3.6345742301659093`*^9, 
   3.6345742437979283`*^9}, {3.6345743279970465`*^9, 3.634574348558076*^9}, {
   3.6345746968875685`*^9, 3.634574766403666*^9}, {3.634574871306815*^9, 
   3.6345748886278396`*^9}, {3.6345749221698866`*^9, 3.634574922329887*^9}, {
   3.634575002471504*^9, 3.6345750230225334`*^9}, 3.6345750878186245`*^9, {
   3.6345754193491583`*^9, 3.6345754260091677`*^9}, {3.6345771813507032`*^9, 
   3.634577182451705*^9}, {3.6345772561218085`*^9, 3.6345772600618143`*^9}, 
   3.634667845837307*^9, {3.634696915280466*^9, 3.634696975223894*^9}, {
   3.6346971315828376`*^9, 3.634697177854484*^9}, 3.634697212662475*^9, {
   3.6346973614209833`*^9, 3.6346973648851814`*^9}, {3.63469742552465*^9, 
   3.6346974669160175`*^9}, 3.634697612053319*^9, {3.6347369633980875`*^9, 
   3.634736963574097*^9}, {3.6348620549621954`*^9, 3.6348621236901264`*^9}, {
   3.6348621859536877`*^9, 3.634862232793367*^9}, {3.6350208425102544`*^9, 
   3.6350208467502604`*^9}, {3.6350213928400307`*^9, 
   3.6350214413950987`*^9}, {3.635021526258218*^9, 3.635021527068219*^9}, {
   3.635021573386285*^9, 3.635021581477296*^9}, {3.635021647884389*^9, 
   3.6350216480643897`*^9}, {3.635095920536541*^9, 3.635095924936793*^9}, {
   3.635099772333851*^9, 3.635099837367571*^9}, {3.635099909887719*^9, 
   3.6350999214693813`*^9}, {3.635099955613334*^9, 3.6350999935945063`*^9}, {
   3.635100112324298*^9, 3.6351004311155314`*^9}, {3.6351006024583316`*^9, 
   3.6351006238225536`*^9}, {3.6351007252213535`*^9, 
   3.6351007436944103`*^9}, {3.6351007892690163`*^9, 
   3.6351008008296776`*^9}, {3.63510085664787*^9, 3.635100858355968*^9}, {
   3.635100907111757*^9, 3.6351009103649426`*^9}, {3.6351009665351553`*^9, 
   3.635101106747175*^9}, {3.6351011367548914`*^9, 3.635101137378927*^9}, {
   3.635101191590028*^9, 3.6351014112055893`*^9}, {3.6351014845727854`*^9, 
   3.6351015914118967`*^9}, {3.635101978245022*^9, 3.6351019877855678`*^9}, {
   3.63510237053446*^9, 3.6351023981750407`*^9}, {3.63510249606164*^9, 
   3.6351025880939035`*^9}, {3.635102635957641*^9, 3.6351026785170755`*^9}, {
   3.635102749772151*^9, 3.6351027499561615`*^9}, {3.635129198192914*^9, 
   3.635129234649999*^9}, {3.635130628693734*^9, 3.635130631525896*^9}, {
   3.635130812068222*^9, 3.6351308574758196`*^9}, {3.635130900119259*^9, 
   3.6351309096268024`*^9}, {3.635130941366618*^9, 3.6351309623368177`*^9}, {
   3.635131005469284*^9, 3.63513104262941*^9}, 3.635131292621709*^9, 
   3.635131928578083*^9, {3.6351884118233223`*^9, 3.635188426191144*^9}, {
   3.6352127932958627`*^9, 3.6352128892163486`*^9}, {3.635212928448593*^9, 
   3.6352129928872786`*^9}, {3.635216177969455*^9, 3.6352162019128246`*^9}, {
   3.635259026468249*^9, 3.635259048571513*^9}, {3.635537231485247*^9, 
   3.6355372607182884`*^9}, {3.6355465615337563`*^9, 3.635546576634778*^9}, 
   3.635546636672862*^9, {3.6355575686181726`*^9, 3.635557604348223*^9}, {
   3.6591140557781115`*^9, 3.6591140648311367`*^9}, {3.659114147191226*^9, 
   3.65911415477907*^9}, {3.6591142336872826`*^9, 3.659114241145794*^9}, {
   3.659114413499819*^9, 3.6591144160359755`*^9}, {3.6591146202355814`*^9, 
   3.659114629728462*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extension Model", "Subsection",
 CellChangeTimes->{{3.6344315933414373`*^9, 3.634431595605567*^9}}],

Cell[CellGroupData[{

Cell["Gevertz et al.", "Subsubsection",
 CellChangeTimes->{{3.634846565477247*^9, 3.634846574669773*^9}}],

Cell["\<\
Here we implement the extension model as described in the paper by Gevertz et \
al, in section \[OpenCurlyDoubleQuote]Step 3\[CloseCurlyDoubleQuote]. We \
begin by analysing the differential equation 28 from the paper, solving it \
symbolically, once, so we don\[CloseCurlyQuote]t have to recompute that each \
and every cycle.\
\>", "Text",
 CellChangeTimes->{{3.634488518357082*^9, 3.6344885655211487`*^9}, {
  3.6345001475215034`*^9, 3.6345001557025146`*^9}, {3.634501540703477*^9, 
  3.63450158546854*^9}, {3.6345016166505837`*^9, 3.634501617351585*^9}, {
  3.6348465859414177`*^9, 3.6348465917887526`*^9}, {3.6348466343251853`*^9, 
  3.6348466595406275`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"extensionAnalysis", "[", 
   RowBox[{"sT_", ",", " ", "\[Tau]_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"diffeq", ",", " ", "s", ",", " ", "soln", ",", " ", "vmax"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"diffeq", " ", "=", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"s", "[", "\[Tau]", "]"}], ",", "\[Tau]"}], "]"}]}], " ", 
       "\[Equal]", " ", 
       RowBox[{"vmax", " ", 
        RowBox[{
         RowBox[{"s", "[", "\[Tau]", "]"}], " ", "/", " ", 
         RowBox[{"(", 
          RowBox[{"km", " ", "+", " ", 
           RowBox[{"s", "[", "\[Tau]", "]"}]}], ")"}]}]}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"eqn", " ", "28"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"soln", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"DSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"diffeq", ",", " ", 
            RowBox[{
             RowBox[{"s", "[", "0", "]"}], "\[Equal]", "sT"}]}], "}"}], ",", 
          " ", 
          RowBox[{"s", "[", "\[Tau]", "]"}], ",", " ", "\[Tau]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "Quiet"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", "[", "\[Tau]", "]"}], " ", "/.", " ", 
      RowBox[{"(", 
       RowBox[{"soln", " ", "/.", " ", 
        RowBox[{"vmax", " ", "\[Rule]", " ", 
         RowBox[{"kcat", " ", "*", " ", "e"}]}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"sAnalysis", " ", "=", " ", 
  RowBox[{"extensionAnalysis", "[", 
   RowBox[{"sT", ",", " ", "\[Tau]ext"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.63449673751966*^9, 3.6344967877537303`*^9}, {
   3.634496821756778*^9, 3.6344969190459146`*^9}, {3.6344969513499603`*^9, 
   3.6344970664591217`*^9}, {3.6344971103951836`*^9, 3.634497171380269*^9}, {
   3.6344972908024855`*^9, 3.634497407312649*^9}, {3.634497516164802*^9, 
   3.6344977341981087`*^9}, {3.634497812907219*^9, 3.634497894035333*^9}, {
   3.6344979248683767`*^9, 3.634497929438383*^9}, {3.6344981296826644`*^9, 
   3.634498167105717*^9}, {3.6344982805078764`*^9, 3.634498337833957*^9}, {
   3.634498381809019*^9, 3.634498409092057*^9}, {3.6344985158722076`*^9, 
   3.6344985750772905`*^9}, {3.634498630143368*^9, 3.6344986364933767`*^9}, 
   3.634498726176504*^9, {3.6344987652905593`*^9, 3.634498853139683*^9}, {
   3.634498885883729*^9, 3.6344989586228313`*^9}, 3.634499138414084*^9, {
   3.6344992689972677`*^9, 3.6344993615373974`*^9}, {3.634499394430444*^9, 
   3.6344994431345124`*^9}, {3.634499481713567*^9, 3.634499631285777*^9}, {
   3.6344996639788227`*^9, 3.63449969075086*^9}, {3.6344997428359337`*^9, 
   3.634499987901278*^9}, {3.634500062858383*^9, 3.6345000665083885`*^9}, 
   3.6345001391204915`*^9, {3.634656030021838*^9, 3.6346560336018434`*^9}}],

Cell["With that in hand, the extension efficiency can be computed.", "Text",
 CellChangeTimes->{{3.634501623802594*^9, 3.634501636733612*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"extensionEfficiencyGevertz", "[", 
   RowBox[{"annealingOutput_", ",", " ", "constants_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sTT", ",", " ", "s", ",", " ", "vmax", ",", " ", "eqn30", ",", " ", 
      "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sTT", " ", "=", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"readState", "[", 
         RowBox[{"annealingOutput", ",", "ft"}], "]"}], " ", "+", " ", 
        RowBox[{"readState", "[", 
         RowBox[{"annealingOutput", ",", "ru"}], "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"sAnalysis", " ", "/.", " ", 
         RowBox[{"sT", " ", "\[Rule]", " ", "sTT"}]}], " ", "//.", " ", 
        "constants"}], " ", "/.", " ", 
       RowBox[{"e", " ", "\[Rule]", " ", 
        RowBox[{"readState", "[", 
         RowBox[{"annealingOutput", ",", "e"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"sTT", " ", "-", "s"}], ")"}], " ", "/", " ", "sTT"}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{"eqn", " ", "32"}], " ", "*)"}], " ", "//", " ", "Quiet"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"result", " ", "===", " ", "Indeterminate"}], ",", " ", 
       RowBox[{"result", " ", "=", " ", "0"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"extensionEfficiencyGevertz", "[", 
  RowBox[{
   RowBox[{"annealKinetic", "[", 
    RowBox[{
     RowBox[{"state0", "[", "]"}], ",", " ", "constants"}], "]"}], ",", " ", 
   "constants"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6344885504801273`*^9, 3.634488621318227*^9}, 
   3.634488995388079*^9, {3.634489343631383*^9, 3.634489345172385*^9}, {
   3.6344934285668344`*^9, 3.634493430036837*^9}, {3.63449383346187*^9, 
   3.6344941157042675`*^9}, {3.634494165888338*^9, 3.634494173009348*^9}, {
   3.6344942070823956`*^9, 3.634494269150483*^9}, {3.634494569309998*^9, 
   3.6344945977840385`*^9}, {3.634494662230129*^9, 3.634494683532159*^9}, 
   3.6344956981361427`*^9, {3.6344990014678917`*^9, 3.634499001857892*^9}, {
   3.6345000573573756`*^9, 3.634500130520479*^9}, {3.63450164942663*^9, 
   3.6345016541166363`*^9}, {3.6345733188316264`*^9, 3.634573319661628*^9}, {
   3.6345753747940955`*^9, 3.634575375384096*^9}, 3.6345755707403708`*^9, {
   3.6345764310375805`*^9, 3.6345764312875805`*^9}, {3.6345772823848457`*^9, 
   3.6345773114568863`*^9}, 3.634655894160647*^9, {3.6346564501904306`*^9, 
   3.6346564506104307`*^9}, 3.63465747804989*^9, {3.634662069704929*^9, 
   3.6346620700325294`*^9}, 3.6346693427704086`*^9, {3.634672418987358*^9, 
   3.6346724193163767`*^9}, {3.634674259358621*^9, 3.634674311382597*^9}, 
   3.634674361806481*^9, {3.634674392086213*^9, 3.6346744162535954`*^9}, {
   3.634674578388869*^9, 3.6346746603965592`*^9}, 3.6346747062551823`*^9, {
   3.6346748317223587`*^9, 3.634674940618587*^9}, {3.6346947320385914`*^9, 
   3.6346947599421873`*^9}, {3.634696824816292*^9, 3.6346968259273553`*^9}, {
   3.6348465482592626`*^9, 3.634846548265263*^9}, {3.635173349967526*^9, 
   3.6351733530563316`*^9}, 3.6351734043024216`*^9, {3.6352156793349347`*^9, 
   3.635215702231244*^9}, {3.6352157340390635`*^9, 3.635215805450148*^9}, {
   3.65911414722423*^9, 3.659114154793056*^9}, 3.6591146508872476`*^9}],

Cell["\<\
We compute the result of the extension step (which becomes, after an implicit \
denaturing, the input to the next annealing step). Note that this can be \
modified to support one of three different enzyme degredation models.\
\>", "Text",
 CellChangeTimes->{{3.6344886500722675`*^9, 3.634488653522272*^9}, {
  3.6344886863853188`*^9, 3.6344887198203654`*^9}, {3.6344889400120015`*^9, 
  3.634488959464029*^9}, {3.634501681559675*^9, 3.634501703562706*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"extensionStepGevertz", "[", 
   RowBox[{"annealingOutputA_", ",", " ", "constants_", ",", " ", 
    RowBox[{"options_:", " ", 
     RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"annealingOutput", ",", " ", "extEfficiency"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Free", " ", "up", " ", "any", " ", "eft", " ", "and", " ", "eru", " ", 
       "complexes", " ", "to", " ", "fit", " ", "into", " ", "the", " ", 
       "Gevertz", " ", 
       RowBox[{"model", ".", " ", 
        RowBox[{"Shouldn", "'"}]}], "t", " ", "actually", " ", "*", "be", "*",
        " ", "any"}], ";", " ", 
      RowBox[{
       RowBox[{"we", "'"}], "re", " ", "just", " ", "being", " ", 
       RowBox[{"complete", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"annealingOutput", " ", "=", " ", 
      RowBox[{"preempt", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ft", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "ft"}], "]"}], " ", "+", 
            " ", 
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "eft"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ru", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "ru"}], "]"}], " ", "+", 
            " ", 
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "eru"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"e", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "e"}], "]"}], " ", "+", 
            " ", 
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "eft"}], "]"}], " ", "+", 
            " ", 
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "eru"}], "]"}], " ", "+", 
            " ", 
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutputA", ",", " ", "ed"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"eft", " ", "\[Rule]", " ", "0"}], ",", " ", 
          RowBox[{"eru", " ", "\[Rule]", " ", "0"}], ",", " ", 
          RowBox[{"ed", "\[Rule]", " ", "0"}]}], "\[IndentingNewLine]", "}"}],
         ",", " ", "annealingOutputA"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"now", " ", 
       RowBox[{"it", "'"}], "s", " ", 
       RowBox[{"simple", ":", " ", 
        RowBox[{
        "ft", " ", "and", " ", "ru", " ", "extend", " ", "at", " ", "the", 
         " ", "computed", " ", "efficiency"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"extEfficiency", " ", "=", " ", 
      RowBox[{"extensionEfficiencyGevertz", "[", 
       RowBox[{"annealingOutput", ",", " ", "constants"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"preempt", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ft", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", " ", "-", " ", "extEfficiency"}], ")"}], " ", 
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutput", ",", "ft"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ru", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", " ", "-", " ", "extEfficiency"}], ")"}], " ", 
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutput", ",", "ru"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tu", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"annealingOutput", ",", " ", "tu"}], "]"}], " ", "+", 
            " ", 
            RowBox[{"extEfficiency", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingOutput", ",", "ru"}], "]"}]}], " ", "+", "  ", 
            RowBox[{"extEfficiency", " ", 
             RowBox[{"readState", "[", 
              RowBox[{"annealingOutput", ",", "ft"}], "]"}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Epsilon]Ext", " ", "\[Rule]", " ", "extEfficiency"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        "annealingOutput"}], "\[IndentingNewLine]", "]"}], "  ", "//", " ", 
      "makeState"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"extensionStepGevertz", "[", 
  RowBox[{
   RowBox[{"annealEquilibrium", "[", 
    RowBox[{
     RowBox[{"state0", "[", "]"}], ",", "constants"}], "]"}], ",", " ", 
   "constants"}], "]"}]}], "Input",
 CellChangeTimes->{{3.634488963044034*^9, 3.6344889862170663`*^9}, {
   3.6344890259441223`*^9, 3.6344892409394245`*^9}, {3.634489277163289*^9, 
   3.634489315208343*^9}, {3.6344894392815175`*^9, 3.6344894402915187`*^9}, {
   3.634490104457263*^9, 3.6344901165282803`*^9}, {3.63449068844862*^9, 
   3.63449068848862*^9}, {3.634492945194155*^9, 3.6344929692561893`*^9}, {
   3.6344930628653207`*^9, 3.6344931004983735`*^9}, {3.6344931439434347`*^9, 
   3.634493182787489*^9}, {3.634493260059598*^9, 3.634493267849609*^9}, {
   3.6344933978537917`*^9, 3.634493437887848*^9}, {3.6344957550722227`*^9, 
   3.63449576718324*^9}, {3.634495896863423*^9, 3.634495904453433*^9}, {
   3.6345003719508195`*^9, 3.634500382882835*^9}, {3.6345004174168835`*^9, 
   3.6345005226080313`*^9}, {3.6345011088038673`*^9, 
   3.6345011088938675`*^9}, {3.634501707893712*^9, 3.6345017336567483`*^9}, 
   3.6345041132573414`*^9, {3.6345042540145397`*^9, 3.63450426862656*^9}, {
   3.634508819783537*^9, 3.6345088235747538`*^9}, {3.6345089614286385`*^9, 
   3.634508987869151*^9}, {3.6345090642695208`*^9, 3.6345090839336452`*^9}, {
   3.634577407147021*^9, 3.6345774698231087`*^9}, 3.634667910821024*^9, 
   3.6346723569818115`*^9, {3.634694505649643*^9, 3.6346945098258815`*^9}, {
   3.634694771607855*^9, 3.6346947717918653`*^9}, {3.6348467681998425`*^9, 
   3.634846768207843*^9}, {3.634861993762695*^9, 3.634862008835557*^9}, {
   3.634862386600164*^9, 3.634862460296379*^9}, {3.6349212736989813`*^9, 
   3.63492130151383*^9}, {3.6350224176552353`*^9, 3.6350224318512607`*^9}, {
   3.6350959553925347`*^9, 3.6350959588167305`*^9}, {3.635132000243182*^9, 
   3.635132012914907*^9}, {3.6351320536422367`*^9, 3.635132055658352*^9}, {
   3.6351734282016635`*^9, 3.6351735705217133`*^9}, {3.6351736007077665`*^9, 
   3.635173656977065*^9}, {3.6351884842144628`*^9, 3.635188494598057*^9}, {
   3.6351954816226916`*^9, 3.6351955987983932`*^9}, {3.6351956598858876`*^9, 
   3.635195879764464*^9}, {3.6351959184276752`*^9, 3.6351959276122007`*^9}, {
   3.6351965020480566`*^9, 3.635196525920422*^9}, {3.635196573103121*^9, 
   3.635196574863221*^9}, {3.635215639478655*^9, 3.6352156452469845`*^9}, {
   3.635215825717307*^9, 3.6352158277574244`*^9}, {3.6355467490660205`*^9, 
   3.6355467641680417`*^9}, {3.6591141472432575`*^9, 
   3.6591141548300734`*^9}, {3.659114417313981*^9, 3.659114418458373*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Michaelis Menton extension model from first principles", "Subsubsection",
 CellChangeTimes->{{3.634864892115471*^9, 3.634864905364229*^9}, {
  3.635015784050548*^9, 3.6350157877205534`*^9}}],

Cell["\<\
The reactions are classic. Note that we have two sets, one for each hybrid \
(ft and ru). We also have competition with accumulated amplicons.\
\>", "Text",
 CellChangeTimes->{{3.634864909003437*^9, 3.6348649620914736`*^9}, {
  3.63501579987157*^9, 3.635015857317651*^9}, {3.6591141473598614`*^9, 
  3.659114154910066*^9}}],

Cell["\<\
Here, we compute the extension step by solving the Michaelis Menton \
differential equations from first principles. The actual differential \
equations were computed above.\
\>", "Text",
 CellChangeTimes->{{3.6348468008757114`*^9, 3.634846840818996*^9}, {
  3.6348524023640985`*^9, 3.634852406276322*^9}, {3.6348649881309633`*^9, 
  3.634865002667794*^9}}],

Cell[BoxData[
 RowBox[{"extensionMichaelisMentionDiffEqs", " ", "//", " ", 
  "ColumnForm"}]], "Input",
 CellChangeTimes->{{3.6355378756266546`*^9, 3.635537878837659*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"extensionStepMichaelisMention", "[", 
    RowBox[{"annealingOutput_", ",", "constants_", ",", " ", 
     RowBox[{"options_:", " ", 
      RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "\[Tau]Extension", ",", " ", "inits", ",", " ", "diffeqs", ",", " ", 
       "eqns", ",", " ", "soln", ",", " ", "ftStart", ",", " ", "ruStart", 
       ",", " ", "endOf", ",", "extEfficiency"}], " ", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Tau]Extension", " ", "=", " ", 
       RowBox[{"\[Tau]ext", " ", "//.", " ", "constants"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"diffeqs", " ", "=", " ", "extensionMichaelisMentionDiffEqs"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ftStart", " ", "=", " ", 
       RowBox[{"readState", "[", 
        RowBox[{"annealingOutput", ",", " ", "ft"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ruStart", " ", "=", " ", 
       RowBox[{"readState", "[", 
        RowBox[{"annealingOutput", ",", " ", "ru"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inits", " ", "=", " ", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ft", "[", "0", "]"}], " ", "\[Equal]", " ", "ftStart"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ru", "[", "0", "]"}], " ", "\[Equal]", " ", "ruStart"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"e", "[", "0", "]"}], " ", "\[Equal]", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingOutput", ",", "e"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eft", "[", "0", "]"}], " ", "\[Equal]", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingOutput", ",", "eft"}], "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eru", "[", "0", "]"}], " ", "\[Equal]", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingOutput", ",", "eru"}], "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tu", "[", "0", "]"}], " ", "\[Equal]", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingOutput", ",", " ", "tu"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fr", "[", "0", "]"}], " ", "\[Equal]", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingOutput", ",", " ", "fr"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eu", "[", "0", "]"}], " ", "\[Equal]", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingOutput", ",", "eu"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ed", "[", "0", "]"}], " ", "\[Equal]", " ", 
          RowBox[{"readState", "[", 
           RowBox[{"annealingOutput", ",", " ", "ed"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eqns", " ", "=", " ", 
       RowBox[{"diffeqs", " ", "~", "Join", "~", " ", "inits"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"soln", " ", "=", " ", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"eqns", " ", "//.", " ", "constants"}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", "\[Tau]", "]"}], "&"}], " ", "/@", " ", 
           RowBox[{"{", 
            RowBox[{
            "ft", ",", " ", "ru", ",", " ", "eft", ",", " ", "eru", ",", " ", 
             "e", ",", " ", "tu", ",", " ", "fr", ",", " ", "eu", ",", " ", 
             "ed"}], "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\[Tau]", ",", " ", "0", ",", " ", "\[Tau]Extension"}], 
           "}"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"AccuracyGoal", "\[Rule]", "MachinePrecision"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PrecisionGoal", "\[Rule]", "MachinePrecision"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MaxStepFraction", "\[Rule]", ".001"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"endOf", "[", "sym_", "]"}], " ", ":=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"sym", "[", "\[Tau]", "]"}], " ", "/.", " ", "soln"}], " ", "/.",
         " ", 
        RowBox[{"\[Tau]", " ", "\[Rule]", " ", "\[Tau]Extension"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Our", " ", "extension", " ", "efficiency", " ", "is", " ", "the", " ",
         "fraction", " ", "of", " ", "the", " ", "hybrids", " ", "that", " ", 
        "got", " ", "converted", " ", "during", " ", "the", " ", 
        "extension"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"extEfficiency", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ftStart", " ", "+", " ", "ruStart"}], ")"}], " ", "-", 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"endOf", "[", "ft", "]"}], " ", "+", " ", 
             RowBox[{"endOf", "[", "ru", "]"}]}], ")"}]}], ")"}], " ", "/", 
         " ", 
         RowBox[{"(", 
          RowBox[{"ftStart", " ", "+", " ", "ruStart"}], ")"}]}], " ", "//", 
        " ", "Quiet"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"extEfficiency", "\[Equal]", "Indeterminate"}], ",", " ", 
        RowBox[{"extEfficiency", "=", "0"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"preempt", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ft", " ", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "ft", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ru", " ", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "ru", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"e", " ", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "e", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"eft", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "eft", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"eru", " ", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "eru", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"tu", " ", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "tu", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"fr", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "fr", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"eu", " ", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "eu", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ed", " ", "\[Rule]", " ", 
            RowBox[{"endOf", "[", "ed", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\[Epsilon]Ext", " ", "\[Rule]", " ", "extEfficiency"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "annealingOutput"}], "]"}], " ", 
       "//", " ", "makeState"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extensionStepMichaelisMention", "[", 
   RowBox[{
    RowBox[{"annealKinetic", "[", 
     RowBox[{
      RowBox[{"state0", "[", "]"}], ",", " ", "constants"}], "]"}], ",", " ", 
    "constants"}], "]"}], " "}]}], "Input",
 CellChangeTimes->{{3.6348498236396036`*^9, 3.634849830030969*^9}, {
   3.6348498939916277`*^9, 3.6348502687180605`*^9}, {3.634850368797785*^9, 
   3.6348503738450737`*^9}, 3.634850524348682*^9, {3.6348510171448684`*^9, 
   3.6348510486566706`*^9}, {3.6348510844087152`*^9, 
   3.6348511596160173`*^9}, {3.6348512242047114`*^9, 
   3.6348512527253428`*^9}, {3.6348516730593843`*^9, 3.6348517221541924`*^9}, 
   3.634851823288977*^9, {3.6348518686485715`*^9, 3.634851921193577*^9}, {
   3.634851977234782*^9, 3.634851981411021*^9}, {3.6348521347857933`*^9, 
   3.634852142208218*^9}, {3.634852295709998*^9, 3.634852343734745*^9}, {
   3.634853025120718*^9, 3.6348532620392685`*^9}, 3.634853378535932*^9, {
   3.634853783126073*^9, 3.6348537872693105`*^9}, {3.6348538652097683`*^9, 
   3.634853928490388*^9}, {3.6348539683646684`*^9, 3.6348539753540683`*^9}, {
   3.634854036182547*^9, 3.6348540508153844`*^9}, {3.6348540828822184`*^9, 
   3.634854104714467*^9}, {3.634854148985999*^9, 3.63485416140971*^9}, {
   3.634854390863834*^9, 3.634854403998585*^9}, {3.634854466896183*^9, 
   3.634854732486374*^9}, {3.6348548090617533`*^9, 3.634854887342231*^9}, {
   3.6348608721965446`*^9, 3.63486092071332*^9}, {3.634860979906706*^9, 
   3.63486107387508*^9}, {3.6348611098821397`*^9, 3.6348611616421003`*^9}, {
   3.634861684935031*^9, 3.634861782803629*^9}, {3.634861832370464*^9, 
   3.6348619093018637`*^9}, {3.634862498913588*^9, 3.634862502605799*^9}, {
   3.6348634089786406`*^9, 3.6348634788956394`*^9}, {3.634863542922302*^9, 
   3.634863630626318*^9}, {3.634863663775214*^9, 3.6348638887570825`*^9}, {
   3.634864239645152*^9, 3.6348642421172934`*^9}, {3.634864339661873*^9, 
   3.6348643399578896`*^9}, {3.6349206853311353`*^9, 
   3.6349206989343596`*^9}, {3.634921159864581*^9, 3.634921183732623*^9}, {
   3.6350159641778016`*^9, 3.635015985081831*^9}, {3.6350160610289383`*^9, 
   3.6350160612389383`*^9}, {3.6350178283740005`*^9, 3.635017837367013*^9}, {
   3.635018401748808*^9, 3.6350184107198205`*^9}, {3.6350185728080487`*^9, 
   3.635018596729082*^9}, {3.6350222369601183`*^9, 3.6350222402517242`*^9}, {
   3.6350222847742023`*^9, 3.635022284961403*^9}, 3.635027418840468*^9, {
   3.635027580957741*^9, 3.635027593917482*^9}, {3.63502768549372*^9, 
   3.6350276856447287`*^9}, {3.635095977930824*^9, 3.6350959861382933`*^9}, {
   3.635102152631996*^9, 3.635102187728004*^9}, {3.6351292971285725`*^9, 
   3.6351293096482887`*^9}, 3.635129879675893*^9, {3.635129944372593*^9, 
   3.6351299610035443`*^9}, {3.635132119460001*^9, 3.635132163356512*^9}, {
   3.6351736923891277`*^9, 3.6351737367098055`*^9}, {3.63519655490908*^9, 
   3.63519660036868*^9}, {3.635196635320679*^9, 3.6351967592717686`*^9}, {
   3.6351967948798056`*^9, 3.6351967951358204`*^9}, {3.6351968921593695`*^9, 
   3.6351970789170513`*^9}, {3.635197283459751*^9, 3.635197304658963*^9}, {
   3.6351999570166693`*^9, 3.6351999934167514`*^9}, {3.63521624239814*^9, 
   3.6352162638263655`*^9}, {3.6353865788949842`*^9, 3.635386603829019*^9}, {
   3.635537268219299*^9, 3.6355372919533324`*^9}, {3.635537905301696*^9, 
   3.6355379428357487`*^9}, {3.659114147392414*^9, 3.659114154978609*^9}, {
   3.659114244000536*^9, 3.6591142480253963`*^9}, {3.65911441975595*^9, 
   3.6591144273068957`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Denaturing Model", "Subsection",
 CellChangeTimes->{{3.6351731556277966`*^9, 3.6351731594966035`*^9}}],

Cell["\<\
We explicitly model the denaturing by breaking apart all DNA complexes and \
disassociating the enzyme from anything it might be attached to. We also \
account for enzyme degredation.\
\>", "Text",
 CellChangeTimes->{{3.6351975304138756`*^9, 3.6351975738773613`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"denature", "[", 
   RowBox[{"state_", ",", " ", "constants_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "enzymeDegredation", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"enzymeDegredation", " ", "=", " ", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Symbol", "[", "\"\<enzymeDegredation\>\"", "]"}], " ", "//.",
          " ", "constants"}], ",", " ", "\[IndentingNewLine]", "none", ",", 
        " ", "1", ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"no", " ", "degredation"}], " ", "*)"}], 
        "\[IndentingNewLine]", "eqn26", ",", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "kdeg"}], " ", "/", " ", "\[Tau]den"}], "]"}], " ", "//.",
          " ", "constants"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"eqn", " ", "26"}], " ", "*)"}], "\[IndentingNewLine]", 
        "eqn27", ",", " ", "0.9990"}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{"eqn", " ", "27"}], " ", "*)"}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"preempt", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"f", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "f"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "ft"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "eft"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "fr"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "ed"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"r", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "r"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "ru"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "eru"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "fr"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "ed"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"t", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "t"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "tu"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "eu"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "ft"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "eft"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"u", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "u"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "tu"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "eu"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", " ", "ru"}], "]"}], " ", "+", " ", 
            RowBox[{"readState", "[", 
             RowBox[{"state", ",", "eru"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"e", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"readState", "[", 
               RowBox[{"state", ",", "e"}], "]"}], " ", "+", " ", 
              RowBox[{"readState", "[", 
               RowBox[{"state", ",", " ", "eft"}], "]"}], " ", "+", " ", 
              RowBox[{"readState", "[", 
               RowBox[{"state", ",", "eru"}], "]"}], " ", "+", " ", 
              RowBox[{"readState", "[", 
               RowBox[{"state", ",", "eu"}], "]"}], " ", "+", " ", 
              RowBox[{"readState", "[", 
               RowBox[{"state", ",", " ", "ed"}], "]"}]}], ")"}], " ", "*", 
            " ", "enzymeDegredation"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"ft", " ", "\[Rule]", " ", "0"}], ",", 
          RowBox[{"ru", " ", "\[Rule]", " ", "0"}], ",", 
          RowBox[{"fr", "\[Rule]", " ", "0"}], ",", 
          RowBox[{"tu", " ", "\[Rule]", " ", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"eu", " ", "\[Rule]", " ", "0"}], ",", 
          RowBox[{"ed", "\[Rule]", " ", "0"}], ",", " ", 
          RowBox[{"eft", " ", "\[Rule]", " ", "0"}], ",", " ", 
          RowBox[{"eru", " ", "\[Rule]", " ", "0"}]}], "\[IndentingNewLine]", 
         "}"}], ",", "state"}], "]"}], " ", "//", "makeState"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"denature", "[", 
  RowBox[{
   RowBox[{"extensionStepMichaelisMention", "[", 
    RowBox[{
     RowBox[{"annealKinetic", "[", 
      RowBox[{
       RowBox[{"state0", "[", "]"}], ",", " ", "constants"}], "]"}], ",", " ",
      "constants"}], "]"}], ",", " ", "constants"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"#", " ", "\[Rule]", " ", 
    RowBox[{"(", 
     RowBox[{"#", " ", "/.", " ", "%"}], ")"}]}], " ", "&"}], " ", "/@", " ", 
  "stateVariables"}]}], "Input",
 CellChangeTimes->{{3.6351301480482426`*^9, 3.6351304103332443`*^9}, {
   3.6351731993546734`*^9, 3.635173262877985*^9}, {3.6351973800252743`*^9, 
   3.6351975140489397`*^9}, {3.635197591752384*^9, 3.6351975933844776`*^9}, {
   3.6351976406641817`*^9, 3.6351976749281416`*^9}, 3.6351978759506392`*^9, {
   3.6351984838024063`*^9, 3.635198484306435*^9}, {3.635198607313471*^9, 
   3.635198614888904*^9}, {3.635514973460596*^9, 3.6355149901726193`*^9}, {
   3.6355150221756644`*^9, 3.635515039637689*^9}, {3.63553729736434*^9, 
   3.6355374084634967`*^9}, {3.6591140558352013`*^9, 
   3.6591140648491364`*^9}, {3.659114147439398*^9, 3.659114155000098*^9}, {
   3.6591142493451824`*^9, 3.659114251328837*^9}, {3.6591144307718563`*^9, 
   3.6591144330266438`*^9}, {3.6591146202565813`*^9, 3.659114629738463*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Runs", "Subsection",
 CellChangeTimes->{{3.634489357213402*^9, 3.6344893579134035`*^9}, {
  3.634489456113541*^9, 3.6344894591635456`*^9}, {3.634489492936593*^9, 
  3.634489493266593*^9}, {3.6345021102002783`*^9, 3.634502115791286*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"run", "[", "n_", "]"}], " ", ":=", " ", 
  RowBox[{"run", "[", 
   RowBox[{"n", ",", 
    RowBox[{"state0", "[", "]"}], ",", " ", "annealKinetic", ",", " ", 
    "extensionStepMichaelisMention", ",", " ", "constants"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"run", "[", 
   RowBox[{
   "n_", ",", " ", "initialState_", ",", " ", "annealStep_", ",", " ", 
    "extnStep_", ",", " ", "constants_", ",", " ", 
    RowBox[{"options_:", " ", 
     RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "results", ",", " ", "step", ",", " ", "cycle", ",", " ", 
      "denaturedCycleInput", ",", " ", "annealOutput", ",", " ", 
      "extensionOutput", ",", " ", "denaturedExtensionOutput"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"results", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"denaturedCycleInput", " ", "=", " ", 
      RowBox[{"denature", "[", 
       RowBox[{"initialState", ",", " ", "constants"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"cycle", " ", "=", " ", "0"}], ",", " ", 
       RowBox[{"cycle", " ", "<", " ", "n"}], ",", " ", 
       RowBox[{"cycle", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"annealOutput", " ", "=", " ", 
         RowBox[{"annealStep", "[", 
          RowBox[{
          "denaturedCycleInput", ",", " ", "constants", ",", " ", "options"}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"extensionOutput", " ", "=", " ", 
         RowBox[{"extnStep", "[", 
          RowBox[{
          "annealOutput", ",", " ", "constants", ",", " ", "options"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"denaturedExtensionOutput", " ", "=", " ", 
         RowBox[{"denature", "[", 
          RowBox[{"extensionOutput", ",", " ", "constants"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"results", " ", "=", " ", 
         RowBox[{"results", " ", "~", "Join", "~", " ", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"tStart", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedCycleInput", ",", " ", "tStart"}], "]"}]}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"tStart", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedCycleInput", ",", " ", "uStart"}], "]"}]}],
                ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"eTC", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedCycleInput", ",", " ", "e"}], "]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"fTC", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedCycleInput", ",", " ", "f"}], "]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"rTC", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedCycleInput", ",", " ", "r"}], "]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"tTC", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedCycleInput", ",", " ", "t"}], "]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"uTC", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedCycleInput", ",", " ", "u"}], "]"}]}], ",",
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"eT", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedExtensionOutput", ",", " ", "e"}], "]"}]}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"fT", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedExtensionOutput", ",", " ", "f"}], "]"}]}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"rT", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedExtensionOutput", ",", " ", "r"}], "]"}]}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"tT", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedExtensionOutput", ",", " ", "t"}], "]"}]}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"uT", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"denaturedExtensionOutput", ",", " ", "u"}], "]"}]}],
                ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"fA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "f"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"rA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "r"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"tA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "t"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"uA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "u"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ftA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "ft"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ruA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "ru"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"dA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "fr"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"uA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "tu"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"euA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "eu"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"edA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "ed"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"eftA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "eft"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"eruA", " ", "\[Rule]", " ", 
                RowBox[{"readState", "[", 
                 RowBox[{"annealOutput", ",", " ", "eru"}], "]"}]}]}], 
              "\[IndentingNewLine]", "}"}], ",", " ", "\[IndentingNewLine]", 
             "extensionOutput"}], "\[IndentingNewLine]", "]"}], "}"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
        "denaturedCycleInput", " ", "=", " ", "denaturedExtensionOutput"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "results"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"customGraphVariables", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
    "eTC", ",", " ", "fTC", ",", " ", "rTC", ",", " ", "tTC", ",", " ", "uTC",
      ",", " ", "eT", ",", " ", "fT", ",", " ", "rT", ",", " ", "tT", ",", 
     " ", "uT", ",", " ", "\[IndentingNewLine]", "f", ",", " ", "r", ",", " ",
      "ft", ",", " ", "ru", ",", " ", "t", ",", " ", "u", ",", " ", "fr", ",",
      " ", "tu", ",", " ", "e", ",", " ", "eu", ",", " ", "ed", ",", " ", 
     "eft", ",", " ", "eru", ",", " ", "\[IndentingNewLine]", "fA", ",", " ", 
     "rA", ",", " ", "ftA", ",", " ", "ruA", ",", " ", "tA", ",", " ", "uA", 
     ",", " ", "dA", ",", " ", "uA", ",", " ", "eA", ",", " ", "euA", ",", 
     " ", "eftA", ",", " ", "eruA", ",", "\[IndentingNewLine]", "tStart", ",",
      " ", "uStart"}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"run", "[", 
   RowBox[{"3", ",", " ", 
    RowBox[{"state0", "[", "]"}], ",", " ", "annealEquilibrium", ",", " ", 
    "extensionStepGevertz", ",", " ", "constants"}], "]"}], " ", "//", " ", 
  "ColumnForm"}]}], "Input",
 CellChangeTimes->{{3.6344897427412467`*^9, 3.6344897939463186`*^9}, {
   3.634489832180372*^9, 3.6344899027894726`*^9}, {3.6344904229462466`*^9, 
   3.6344904440102763`*^9}, {3.634490694078628*^9, 3.634490694128628*^9}, 
   3.6344923060818996`*^9, {3.6344930694563303`*^9, 3.634493072376334*^9}, {
   3.6344947037841873`*^9, 3.634494704654188*^9}, {3.634495722789177*^9, 
   3.6344957229891777`*^9}, 3.6345021268023014`*^9, {3.634502322783579*^9, 
   3.6345023538266225`*^9}, {3.634502395622681*^9, 3.634502403763693*^9}, 
   3.634502443728749*^9, {3.634502783250253*^9, 3.6345030890926833`*^9}, {
   3.63450315045177*^9, 3.6345032837869573`*^9}, {3.634503332752026*^9, 
   3.6345033360120306`*^9}, {3.6345033732652035`*^9, 
   3.6345033828162165`*^9}, {3.634503493887373*^9, 3.634503590837509*^9}, {
   3.634503626500559*^9, 3.634503703277667*^9}, {3.634503821538932*^9, 
   3.634503959212125*^9}, {3.634504073363285*^9, 3.634504095435316*^9}, {
   3.6345041542333994`*^9, 3.6345042371315155`*^9}, {3.6345042728265657`*^9, 
   3.6345042752775693`*^9}, {3.6345077118691683`*^9, 3.634507713278249*^9}, {
   3.63457304816667*^9, 3.634573074068706*^9}, {3.634573110012757*^9, 
   3.6345731690978394`*^9}, {3.6345732018008857`*^9, 3.634573234706932*^9}, {
   3.63457333579365*^9, 3.6345733393936553`*^9}, {3.6345755927124014`*^9, 
   3.6345756126244297`*^9}, {3.6345757314075966`*^9, 3.634575826789731*^9}, {
   3.634577663848383*^9, 3.6345776649683847`*^9}, {3.6346567345498314`*^9, 
   3.6346567349198313`*^9}, {3.6346679261168985`*^9, 3.6346679331873035`*^9}, 
   3.6348465482792635`*^9, 3.634846768223844*^9, {3.6348476385046215`*^9, 
   3.6348476396486864`*^9}, {3.6348625361117153`*^9, 3.634862552839672*^9}, {
   3.634862589252755*^9, 3.634862846964495*^9}, {3.634862995011963*^9, 
   3.6348630171552296`*^9}, {3.6348639781171937`*^9, 
   3.6348640534745035`*^9}, {3.634920956085211*^9, 3.634920990951272*^9}, {
   3.634921045270568*^9, 3.6349210518537793`*^9}, {3.635022454674101*^9, 
   3.635022469774927*^9}, {3.635023334484446*^9, 3.6350233769321203`*^9}, 
   3.635023617375343*^9, 3.6350238404557347`*^9, {3.6350958802252355`*^9, 
   3.635095885689548*^9}, {3.6350959428808193`*^9, 3.635095943664864*^9}, {
   3.6350960040403175`*^9, 3.6350960051043777`*^9}, {3.6351304742128983`*^9, 
   3.635130570612412*^9}, 3.6351737589242444`*^9, {3.635174882949403*^9, 
   3.6351749130730557`*^9}, {3.635197905269316*^9, 3.6351979090535326`*^9}, {
   3.6351979429874735`*^9, 3.635197954499132*^9}, {3.6351980048080096`*^9, 
   3.6351980319485617`*^9}, {3.635198394091275*^9, 3.6351984243680067`*^9}, {
   3.6351984996553135`*^9, 3.63519850222346*^9}, {3.6351986564562817`*^9, 
   3.635198658223383*^9}, {3.635198782286479*^9, 3.6351988859424076`*^9}, {
   3.635198922038472*^9, 3.6351991369487643`*^9}, {3.635199392715393*^9, 
   3.635199452642821*^9}, {3.635199559833952*^9, 3.6351995817142034`*^9}, {
   3.6352096441247406`*^9, 3.6352097248983603`*^9}, {3.635211426750701*^9, 
   3.6352114379113393`*^9}, {3.6352126111424437`*^9, 
   3.6352126194949217`*^9}, {3.6352139055074778`*^9, 
   3.6352139458287835`*^9}, {3.635213995274612*^9, 3.635213995634632*^9}, 
   3.6352158579251494`*^9, {3.6354745896096945`*^9, 3.6354746691888065`*^9}, {
   3.6354747048018565`*^9, 3.635474718643876*^9}, {3.635474754137926*^9, 
   3.635474786020971*^9}, {3.6354748492580595`*^9, 3.6354749574012117`*^9}, 
   3.635529059006604*^9, {3.6355290973106585`*^9, 3.6355293222059746`*^9}, {
   3.635529359450027*^9, 3.635529365071035*^9}, {3.6355294258691206`*^9, 
   3.63552946089217*^9}, {3.6355295984058886`*^9, 3.635529610017905*^9}, {
   3.635537435733035*^9, 3.635537454125061*^9}, {3.63554693362728*^9, 
   3.635546988553357*^9}, {3.659114055865714*^9, 3.659114064889142*^9}, {
   3.659114147464907*^9, 3.6591141550250983`*^9}, {3.6591142567939844`*^9, 
   3.659114265975732*^9}, {3.6591144347392817`*^9, 3.6591144357860165`*^9}, {
   3.659114620267581*^9, 3.659114629770444*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Output", "Subsection",
 CellChangeTimes->{{3.6345021054802713`*^9, 3.634502106360273*^9}, {
  3.6348525902588453`*^9, 3.6348525927309866`*^9}}],

Cell[CellGroupData[{

Cell["Plotting", "Subsubsection",
 CellChangeTimes->{{3.6345024118447037`*^9, 3.6345024135247064`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"http", ":"}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"stackoverflow", ".", "com"}], "/", "questions"}], "/", 
      "9207569"}], "/", "wolfram"}], "-", "mathematica", "-", "y", "-", 
    "axis", "-", "frame", "-", "labels", "-", "are", "-", "not", "-", 
    "aligned"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.634737425065493*^9, 3.6347374275926375`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotRuns", "[", 
   RowBox[{"runs_", ",", " ", "constants_", ",", " ", "renderOptionsIn_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "customGraph", ",", " ", "targetConcentrations", ",", " ", "plot", ",", 
      " ", "floor", ",", " ", "visualFloor", ",", " ", "ceil", ",", " ", 
      "max", ",", " ", "color", ",", " ", "legend", ",", " ", "row", ",", " ",
       "rows", ",", " ", "norow", ",", " ", "renderOptions"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"renderOptions", " ", "=", " ", 
      RowBox[{"preempt", "[", 
       RowBox[{"renderOptionsIn", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"showU", " ", "\[Rule]", " ", "False"}], ",", " ", 
          RowBox[{"useLinearPlots", "\[Rule]", " ", "False"}], ",", "  ", 
          RowBox[{"showExtraPlots", " ", "\[Rule]", " ", "False"}], ",", " ", 
          RowBox[{"useCustomGraphs", " ", "\[Rule]", " ", "False"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"targetConcentrations", " ", "=", " ", 
      RowBox[{
       RowBox[{"Symbol", "[", "\"\<targetConcentrations\>\"", "]"}], " ", "//.",
        " ", "renderOptions"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Options", "[", "plot", "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"plotFunc", " ", "\[Rule]", " ", "ListLogPlot"}], ",", " ", 
         RowBox[{"labels", " ", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], ",", " ", 
         RowBox[{"imageLeftPadding", " ", "\[Rule]", " ", "0"}]}], "}"}], " ",
        "~", "Join", "~", " ", 
       RowBox[{"Options", "[", "ListLogPlot", "]"}], " ", "~", "Join", "~", 
       " ", 
       RowBox[{"Options", "[", "ListPlot", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plot", "[", 
       RowBox[{"what_", ",", " ", 
        RowBox[{"opts", " ", ":", " ", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"plotter", ",", " ", "plotOpts"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"plotter", " ", "=", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"useLinearPlots", " ", "//.", " ", "renderOptions"}], ",",
             " ", "ListPlot", ",", " ", 
            RowBox[{"OptionValue", "[", "plotFunc", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"plotOpts", " ", "=", " ", 
          RowBox[{
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "opts", "}"}], ",", " ", 
             RowBox[{"Options", "[", "plotter", "]"}]}], "]"}], " ", 
           "\[IndentingNewLine]", "~", "Join", "~", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FrameLabel", " ", "\[Rule]", " ", 
              RowBox[{"OptionValue", "[", "labels", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Frame", " ", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{
               "True", ",", " ", "True", ",", " ", "True", ",", " ", "True"}],
                "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", " ", "Medium"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"ImagePadding", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"51", " ", "+", " ", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "useLinearPlots", " ", "//.", " ", "renderOptions"}], ",",
                     "15", ",", "0"}], "]"}], " ", "+", " ", 
                   RowBox[{"OptionValue", "[", "imageLeftPadding", "]"}]}], 
                  ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"45", ",", "0"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Ticks", " ", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", " ", "Automatic"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"GridLines", " ", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"0", ",", "100", ",", "5"}], "]"}], ",", " ", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}]}], " ", ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"plotter", "[", 
            RowBox[{"what", ",", " ", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", "plotOpts"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"plotter", "[", "what", "]"}]}], "\[IndentingNewLine]", 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"floor", " ", "=", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "20"}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "roughly", " ", "a", " ", "copy", " ", "count", " ", "of", " ", "1", 
       " ", "in", " ", "25", " ", "uL"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"visualFloor", " ", "=", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "10.5"}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "roughly", " ", "what", " ", "can", " ", "be", " ", "measured", " ", 
       "in", " ", "fluoresence"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"max", " ", "=", " ", 
      RowBox[{"Max", " ", "@@", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "//.", "constants"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"fStart", ",", " ", "rStart"}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ceil", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"useLinearPlots", " ", "//.", " ", "renderOptions"}], ",", 
        " ", 
        RowBox[{"max", " ", "*", " ", "1.05"}], ",", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"10", ",", " ", "max"}], "]"}], " ", "+", " ", "0.5"}], 
          ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"customGraph", "[", "expr_", "]"}], " ", ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vars", ",", " ", "fn"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fn", " ", "=", " ", 
          RowBox[{"Function", "[", 
           RowBox[{"state", ",", " ", 
            RowBox[{"ReleaseHold", "[", 
             RowBox[{
              RowBox[{"expr", " ", "/.", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", " ", "\[Rule]", " ", 
                    RowBox[{"readState", "[", 
                    RowBox[{"state", ",", " ", "#"}], "]"}]}], ")"}], " ", 
                  "&"}], " ", "/@", " ", "customGraphVariables"}], ")"}]}], 
              " ", "//.", " ", "constants"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"plot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"run", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"fn", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
               "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"labels", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"\"\<cycle\>\"", ",", " ", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"expr", "//", " ", "ReleaseHold"}], ",", " ", 
                "InputForm"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"color", " ", "=", " ", 
      RowBox[{"ColorData", "[", "97", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"legend", " ", "=", " ", 
      RowBox[{"PointLegend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"color", "[", "#", "]"}], " ", "&"}], "/@", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "targetConcentrations", "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"N", "[", "targetConcentrations", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"LegendFunction", "\[Rule]", " ", "Framed"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "LegendLabel", "\[Rule]", "\"\<initial target concentrations:\>\""}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"LegendLayout", " ", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<Row\>\"", ",", " ", "1"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"row", "[", "list_List", "]"}], " ", ":=", " ", "list"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"row", "[", 
       RowBox[{"condition_", ",", " ", "list_List"}], "]"}], " ", ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"condition", ",", " ", "list", ",", " ", "norow"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"rows", " ", "=", " ", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"legend", ",", "\[IndentingNewLine]", "SpanFromLeft"}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"row", "[", 
         RowBox[{
          RowBox[{"useCustomGraphs", " ", "//.", " ", "renderOptions"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"customGraph", "[", 
             RowBox[{"customGraphExpr1", " ", "//.", " ", "renderOptions"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"customGraph", "[", 
             RowBox[{"customGraphExpr2", " ", "//.", " ", "renderOptions"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"customGraph", "[", 
             RowBox[{"customGraphExpr3", " ", "//.", " ", "renderOptions"}], 
             "]"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"run", ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"readState", "[", 
                  RowBox[{"#", ",", "tT"}], "]"}], " ", "&"}], " ", "/@", " ",
                 "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"labels", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<cycle\>\"", ",", " ", "\"\<total [t] after ext'n\>\""}], 
              "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"visualFloor", ",", " ", "ceil"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AxesOrigin", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", 
               RowBox[{"10", "^", 
                RowBox[{"-", "10.5"}]}]}], "}"}]}]}], " ", 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"run", ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"readState", "[", 
                  RowBox[{"#", ",", "uT"}], "]"}], " ", "&"}], " ", "/@", " ",
                 "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"labels", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<cycle\>\"", ",", " ", "\"\<total [u] after ext'n\>\""}], 
              "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"visualFloor", ",", " ", "ceil"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AxesOrigin", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", 
               RowBox[{"10", "^", 
                RowBox[{"-", "10.5"}]}]}], "}"}]}]}], " ", 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"showU", " ", "//.", " ", "renderOptions"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"plot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"run", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "tu"}], "]"}], " ", "+", " ", 
                    RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "eu"}], "]"}]}], "&"}], " ", "/@", " ", 
                  "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"labels", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "\"\<cycle\>\"", ",", " ", 
                 "\"\<total [t-u duplex] after ext'n\>\""}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"visualFloor", ",", " ", "ceil"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AxesOrigin", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"10", "^", 
                  RowBox[{"-", "10.5"}]}]}], "}"}]}]}], " ", 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            "\"\<\>\""}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"run", ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"readState", "[", 
                  RowBox[{"#", ",", "fT"}], "]"}], " ", "&"}], " ", "/@", " ",
                 "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"labels", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<cycle\>\"", ",", " ", "\"\<total [f] after ext'n\>\""}], 
              "}"}]}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"floor", ",", "ceil"}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"run", ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"readState", "[", 
                  RowBox[{"#", ",", "rT"}], "]"}], " ", "&"}], " ", "/@", " ",
                 "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"labels", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<cycle\>\"", ",", " ", "\"\<total [r] after ext'n\>\""}], 
              "}"}]}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"floor", ",", "ceil"}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"showExtraPlots", " ", "//.", " ", "renderOptions"}], 
              ",", 
              RowBox[{"showU", " ", "//.", " ", "renderOptions"}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"plot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"run", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "uA"}], "]"}], " ", "+", " ", 
                    RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "euA"}], "]"}]}], "&"}], " ", "/@", " ",
                   "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"labels", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "\"\<cycle\>\"", ",", " ", 
                 "\"\<[t-u duplex] after anneal\>\""}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"visualFloor", ",", " ", "ceil"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AxesOrigin", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"10", "^", 
                  RowBox[{"-", "10.5"}]}]}], "}"}]}]}], " ", 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            "\"\<\>\""}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"run", ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"readState", "[", 
                  RowBox[{"#", ",", "ftA"}], "]"}], " ", "&"}], " ", "/@", 
                " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"labels", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<cycle\>\"", ",", " ", "\"\<[ft] after anneal\>\""}], 
              "}"}]}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"floor", ",", "ceil"}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"run", ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"readState", "[", 
                  RowBox[{"#", ",", "ruA"}], "]"}], " ", "&"}], " ", "/@", 
                " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"labels", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<cycle\>\"", ",", " ", "\"\<[ru] after anneal\>\""}], 
              "}"}]}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"floor", ",", "ceil"}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"run", ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"readState", "[", 
                   RowBox[{"#", ",", "ftA"}], "]"}], " ", "+", " ", 
                  RowBox[{"readState", "[", 
                   RowBox[{"#", ",", "ruA"}], "]"}]}], " ", "&"}], " ", "/@", 
                " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"labels", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<cycle\>\"", ",", " ", 
               "\"\<sum of graphs to left (eqn 29)\>\""}], "}"}]}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRange", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"floor", ",", "ceil"}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"row", "[", 
         RowBox[{
          RowBox[{"showExtraPlots", " ", "//.", " ", "renderOptions"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"plot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"run", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "ft"}], "]"}], " ", "&"}], " ", "/@", 
                  " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"labels", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "\"\<cycle\>\"", ",", " ", "\"\<[ft] after extension\>\""}], 
                "}"}]}], ",", " ", "\[IndentingNewLine]", 
              RowBox[{"PlotRange", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"floor", ",", "ceil"}], "}"}]}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"plot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"run", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "ru"}], "]"}], " ", "&"}], " ", "/@", 
                  " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"labels", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "\"\<cycle\>\"", ",", " ", "\"\<[ru] after extension\>\""}], 
                "}"}]}], ",", " ", "\[IndentingNewLine]", 
              RowBox[{"PlotRange", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"floor", ",", "ceil"}], "}"}]}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"plot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"run", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "ft"}], "]"}], " ", "+", " ", 
                    RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "ru"}], "]"}]}], " ", "&"}], " ", "/@", 
                  " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"labels", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "\"\<cycle\>\"", ",", " ", "\"\<sum of graphs to left\>\""}], 
                "}"}]}], ",", " ", "\[IndentingNewLine]", 
              RowBox[{"PlotRange", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"floor", ",", "ceil"}], "}"}]}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"row", "[", 
         RowBox[{
          RowBox[{"showExtraPlots", " ", "//.", " ", "renderOptions"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"plot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"run", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "eft"}], "]"}], " ", "&"}], " ", "/@", 
                  " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"labels", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "\"\<cycle\>\"", ",", " ", 
                 "\"\<[poly-ft complex] after extension\>\""}], "}"}]}], ",", 
              " ", "\[IndentingNewLine]", 
              RowBox[{"PlotRange", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"floor", ",", "ceil"}], "}"}]}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"plot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"run", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "eru"}], "]"}], " ", "&"}], " ", "/@", 
                  " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"labels", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "\"\<cycle\>\"", ",", " ", 
                 "\"\<[poly-ru complex] after extension\>\""}], "}"}]}], ",", 
              " ", "\[IndentingNewLine]", 
              RowBox[{"PlotRange", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"floor", ",", "ceil"}], "}"}]}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"showU", " ", "//.", " ", "renderOptions"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"plot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Function", "[", 
                  RowBox[{"run", ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "eu"}], "]"}], " ", "&"}], " ", "/@", 
                    " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ",
                 "\[IndentingNewLine]", 
                RowBox[{"labels", "\[Rule]", " ", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<cycle\>\"", ",", " ", 
                   "\"\<[t-u-poly' complex] after extension\>\""}], "}"}]}], 
                ",", " ", "\[IndentingNewLine]", 
                RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                 RowBox[{"{", 
                  RowBox[{"floor", ",", "ceil"}], "}"}]}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\"\<\>\""}], "]"}]}], 
           "\[IndentingNewLine]", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"run", ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"readState", "[", 
                  RowBox[{"#", ",", "\[Epsilon]Ann"}], "]"}], " ", "&"}], " ",
                 "/@", " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", 
            " ", "\[IndentingNewLine]", 
            RowBox[{"plotFunc", " ", "\[Rule]", " ", "ListPlot"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"labels", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<cycle\>\"", ",", " ", 
               "\"\<anneal efficiency (eqn 31)\>\""}], "}"}]}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "1.1"}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"run", ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"readState", "[", 
                  RowBox[{"#", ",", "\[Epsilon]Ext"}], "]"}], " ", "&"}], " ",
                 "/@", " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", 
            " ", "\[IndentingNewLine]", 
            RowBox[{"plotFunc", " ", "\[Rule]", " ", "ListPlot"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"labels", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<cycle\>\"", ",", " ", 
               "\"\<extension efficiency (eqn 32)\>\""}], "}"}]}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "1.1"}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"run", ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"readState", "[", 
                   RowBox[{"#", ",", "\[Epsilon]Ann"}], "]"}], " ", "*", " ", 
                  RowBox[{"readState", "[", 
                   RowBox[{"#", ",", "\[Epsilon]Ext"}], "]"}]}], "&"}], " ", "/@",
                 " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"plotFunc", " ", "\[Rule]", " ", "ListPlot"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"labels", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<cycle\>\"", ",", " ", 
               "\"\<overall efficiency (eqn 33)\>\""}], "}"}]}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "1.1"}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"run", ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"readState", "[", 
                   RowBox[{"#", ",", "eT"}], "]"}], ")"}], " ", "&"}], " ", "/@",
                 " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"labels", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<cycle\>\"", ",", " ", "\"\<total [polymerase]\>\""}], 
              "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"plotFunc", " ", "\[Rule]", " ", "ListPlot"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"imageLeftPadding", "\[Rule]", " ", "20"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AxesOrigin", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0"}], "}"}]}]}], " ", 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"showU", " ", "//.", " ", "renderOptions"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"plot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"run", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "tu"}], "]"}], " ", "+", " ", 
                    RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "eu"}], "]"}]}], ")"}], " ", "/", " ", 
                    RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "eT"}], "]"}]}], ")"}], " ", "&"}], " ",
                   "/@", " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",",
               " ", "\[IndentingNewLine]", 
              RowBox[{"labels", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "\"\<cycle\>\"", ",", " ", 
                 "\"\<[t-u complex] aft ext'n / total [poly']\>\""}], "}"}]}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"plotFunc", " ", "\[Rule]", " ", "ListPlot"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AxesOrigin", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", "0"}], "}"}]}]}], " ", 
             "\[IndentingNewLine]", "]"}], ",", "\"\<\>\""}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"showU", " ", "//.", " ", "renderOptions"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"plot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"run", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "eu"}], "]"}], " ", "/", " ", 
                    RowBox[{"readState", "[", 
                    RowBox[{"#", ",", "eT"}], "]"}]}], ")"}], " ", "&"}], " ",
                   "/@", " ", "run"}]}], "]"}], " ", "/@", " ", "runs"}], ",",
               " ", "\[IndentingNewLine]", 
              RowBox[{"labels", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "\"\<cycle\>\"", ",", " ", 
                 "\"\<[t-u-poly' plex] aft ext'n/total [poly']\>\""}], 
                "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"plotFunc", " ", "\[Rule]", " ", "ListPlot"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AxesOrigin", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", "0"}], "}"}]}]}], " ", 
             "\[IndentingNewLine]", "]"}], ",", "\"\<\>\""}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rows", " ", "=", " ", 
      RowBox[{"rows", " ", "/.", " ", 
       RowBox[{"norow", " ", "\[Rule]", " ", 
        RowBox[{"Sequence", "[", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", "rows", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.634502167796359*^9, 3.634502207421415*^9}, {
   3.634502276414513*^9, 3.634502279474518*^9}, {3.634504397071741*^9, 
   3.6345044593398285`*^9}, {3.6345088801919923`*^9, 
   3.6345088814880667`*^9}, {3.634573436680793*^9, 3.6345734390607967`*^9}, {
   3.6345736029060273`*^9, 3.6345737699512615`*^9}, {3.634573998671583*^9, 
   3.6345739989215837`*^9}, {3.634574042114644*^9, 3.6345740480256524`*^9}, {
   3.634574089698711*^9, 3.634574091808714*^9}, {3.634574121854757*^9, 
   3.6345741223047576`*^9}, {3.6345741793508377`*^9, 
   3.6345741797508383`*^9}, {3.6345743611320934`*^9, 
   3.6345743713031073`*^9}, {3.6345750774276094`*^9, 3.634575077987611*^9}, {
   3.634575108030653*^9, 3.634575109990656*^9}, {3.634575166035734*^9, 
   3.6345752584648643`*^9}, {3.634575875035799*^9, 3.6345759001078343`*^9}, {
   3.6345775085601635`*^9, 3.634577545893216*^9}, {3.6345820081910496`*^9, 
   3.634582131516223*^9}, {3.634582183831297*^9, 3.634582223916353*^9}, {
   3.6345824325384703`*^9, 3.6345824335184717`*^9}, {3.6345830527953424`*^9, 
   3.6345830813383827`*^9}, {3.634583148725477*^9, 3.634583253046625*^9}, {
   3.6345833314797354`*^9, 3.6345833438407526`*^9}, {3.6345833869658136`*^9, 
   3.6345834577339134`*^9}, {3.6345836223761454`*^9, 
   3.6345836314081583`*^9}, {3.6345836665322075`*^9, 3.634583670472213*^9}, {
   3.6345837311872983`*^9, 3.634583736027305*^9}, {3.6345838534094715`*^9, 
   3.634583955941617*^9}, {3.634584054351755*^9, 3.63458417140292*^9}, {
   3.6345843996622925`*^9, 3.6345844662103863`*^9}, {3.6345845311164775`*^9, 
   3.6345845957065687`*^9}, {3.6345894061478133`*^9, 
   3.6345894130662093`*^9}, {3.63458945294549*^9, 3.634589460128901*^9}, {
   3.634589661335409*^9, 3.634589726264123*^9}, {3.634589772695779*^9, 
   3.6345899027342167`*^9}, {3.634589947077753*^9, 3.6345899474537745`*^9}, {
   3.634589994005437*^9, 3.6345899942134485`*^9}, {3.6345900305485272`*^9, 
   3.6345900679646673`*^9}, {3.6345901048217754`*^9, 3.634590242705662*^9}, {
   3.634590340914279*^9, 3.634590349905793*^9}, {3.634598619095764*^9, 
   3.634598620111822*^9}, {3.6345988743493633`*^9, 3.6345989427162743`*^9}, {
   3.6345989793173676`*^9, 3.6345990359646072`*^9}, {3.6346469002752895`*^9, 
   3.6346469082907476`*^9}, 3.6346562942052097`*^9, {3.634656386117339*^9, 
   3.634656394399351*^9}, {3.6346564382984133`*^9, 3.6346564416584187`*^9}, {
   3.634668219548682*^9, 3.634668383068035*^9}, {3.634668427474575*^9, 
   3.6346684410673523`*^9}, 3.6346685340976734`*^9, {3.6346687332734594`*^9, 
   3.6346687391654673`*^9}, {3.634668822339585*^9, 3.6346689750078*^9}, {
   3.6346690410338936`*^9, 3.634669045025899*^9}, {3.6346702249308653`*^9, 
   3.6346702393446894`*^9}, {3.6346705804371986`*^9, 
   3.6346705921108665`*^9}, {3.634670656901572*^9, 3.6346706613978295`*^9}, {
   3.6346707041742764`*^9, 3.6346707117737107`*^9}, {3.634671004115432*^9, 
   3.6346710193403025`*^9}, {3.63467110163501*^9, 3.634671172066038*^9}, {
   3.634672982445586*^9, 3.6346730557977815`*^9}, {3.6346736469345922`*^9, 
   3.6346736487166944`*^9}, 3.6346742427216697`*^9, {3.634696656494664*^9, 
   3.634696666717249*^9}, {3.6346967081196165`*^9, 3.6346967344941254`*^9}, {
   3.6347364228051667`*^9, 3.6347365034377785`*^9}, {3.63473657461885*^9, 
   3.634736596148082*^9}, {3.634736943538951*^9, 3.63473696676928*^9}, {
   3.634737135568935*^9, 3.6347371360569625`*^9}, {3.634737172185029*^9, 
   3.634737258287954*^9}, {3.6347372988632746`*^9, 3.6347373157502403`*^9}, {
   3.634737364190011*^9, 3.6347373809659705`*^9}, {3.6347375036939907`*^9, 
   3.6347375615012965`*^9}, {3.6347375953962355`*^9, 
   3.6347376565897355`*^9}, {3.634737694125882*^9, 3.634737720205374*^9}, {
   3.6347377620457673`*^9, 3.634737762285781*^9}, {3.634750665505803*^9, 
   3.6347507084582596`*^9}, {3.6347507394650335`*^9, 3.634750756394001*^9}, {
   3.6347507901609325`*^9, 3.634750828125104*^9}, {3.6347508942888885`*^9, 
   3.6347509146410522`*^9}, {3.634750949712058*^9, 3.634751007903387*^9}, {
   3.6347511613181615`*^9, 3.6347511686775827`*^9}, {3.6347512293650537`*^9, 
   3.6347512455169773`*^9}, {3.634751398102705*^9, 3.6347514002938304`*^9}, {
   3.6347514443533506`*^9, 3.6347515746198015`*^9}, {3.634751610371846*^9, 
   3.634751627075802*^9}, {3.634760911457838*^9, 3.6347609235535297`*^9}, {
   3.634761071905015*^9, 3.634761078161373*^9}, {3.6347632423061547`*^9, 
   3.634763245952363*^9}, {3.63476333418541*^9, 3.6347633389996853`*^9}, {
   3.6348301618820157`*^9, 3.63483016720732*^9}, {3.6348308099140806`*^9, 
   3.6348308268580503`*^9}, {3.634832929591319*^9, 3.6348329358126755`*^9}, {
   3.63483573466076*^9, 3.6348357412451367`*^9}, {3.634836026861473*^9, 
   3.634836326721624*^9}, {3.634836742219389*^9, 3.6348367476907024`*^9}, {
   3.634836779954548*^9, 3.6348368523216867`*^9}, 3.634852613435171*^9, {
   3.6348526467710776`*^9, 3.634852652634413*^9}, 3.6348527091466455`*^9, {
   3.6348527518630886`*^9, 3.634852752798142*^9}, {3.6349213740081577`*^9, 
   3.6349213893741846`*^9}, {3.634921490633962*^9, 3.634921557152479*^9}, {
   3.634921735211192*^9, 3.6349217427616053`*^9}, {3.634921867327824*^9, 
   3.634921890930665*^9}, {3.635009853956784*^9, 3.6350099042118545`*^9}, {
   3.635018312548682*^9, 3.635018314859686*^9}, {3.6350183944487977`*^9, 
   3.635018395228799*^9}, {3.6350186898682137`*^9, 3.6350187604973125`*^9}, {
   3.635019115486812*^9, 3.635019118596816*^9}, {3.6350193336801186`*^9, 
   3.6350193475121384`*^9}, {3.635019446096277*^9, 3.6350195125923705`*^9}, {
   3.63501955510643*^9, 3.635019595720487*^9}, {3.63501966170758*^9, 
   3.635019664697584*^9}, {3.6350197367686853`*^9, 3.635019740448691*^9}, {
   3.635019799401785*^9, 3.6350198202738147`*^9}, {3.6350198640878763`*^9, 
   3.635019919314954*^9}, {3.6350199857450485`*^9, 3.635019991686057*^9}, {
   3.6350200561361475`*^9, 3.635020112753227*^9}, {3.6350202773164587`*^9, 
   3.635020280956464*^9}, {3.6350203279605303`*^9, 3.635020333550538*^9}, 
   3.6350203888866158`*^9, {3.6350204262106686`*^9, 3.635020432651677*^9}, {
   3.6350223041806364`*^9, 3.6350223070978413`*^9}, {3.6350225161538086`*^9, 
   3.6350225488982663`*^9}, {3.6350226032799616`*^9, 3.635022606961568*^9}, {
   3.6350226975821276`*^9, 3.6350227634142427`*^9}, {3.6350228075311203`*^9, 
   3.6350228411959796`*^9}, {3.6350228768108425`*^9, 
   3.6350228901020656`*^9}, {3.635022928462533*^9, 3.635022928540533*^9}, {
   3.6350367255117793`*^9, 3.635036729840027*^9}, {3.6351312230027266`*^9, 
   3.6351312415707884`*^9}, {3.635198154857592*^9, 3.6351981617929883`*^9}, {
   3.6351983312636814`*^9, 3.6351983355869293`*^9}, {3.635198747917513*^9, 
   3.635198751996746*^9}, {3.635199154145748*^9, 3.635199163001254*^9}, {
   3.635199592426816*^9, 3.635199600822296*^9}, {3.6351996554054184`*^9, 
   3.635199696084745*^9}, {3.635199823518034*^9, 3.6351998448062515`*^9}, {
   3.635200150067711*^9, 3.6352001570111084`*^9}, {3.6352001931151733`*^9, 
   3.6352001932191796`*^9}, {3.635200248328332*^9, 3.6352002557207546`*^9}, {
   3.635200361647813*^9, 3.635200401024065*^9}, {3.6352004430714703`*^9, 
   3.6352004519109755`*^9}, {3.6352005206229057`*^9, 3.635200526143222*^9}, {
   3.635200565349464*^9, 3.6352005871427107`*^9}, {3.6352007076926055`*^9, 
   3.6352007343331294`*^9}, {3.6352093686259828`*^9, 3.635209506890891*^9}, {
   3.635209801086718*^9, 3.6352098037188683`*^9}, {3.6352098559408555`*^9, 
   3.6352098801732416`*^9}, {3.635209918628441*^9, 3.635209918868455*^9}, {
   3.6352099737815957`*^9, 3.6352100567783427`*^9}, {3.635210200691574*^9, 
   3.635210291459766*^9}, {3.635210348762043*^9, 3.6352103652339854`*^9}, {
   3.635210425248418*^9, 3.635210437105096*^9}, {3.635210471986091*^9, 
   3.635210484936832*^9}, {3.6352105442442245`*^9, 3.635210548314457*^9}, {
   3.6352105856505923`*^9, 3.6352106131701665`*^9}, {3.635210853240898*^9, 
   3.6352108837456427`*^9}, {3.635211461332679*^9, 3.6352114876201825`*^9}, {
   3.6352116157795124`*^9, 3.635211628107218*^9}, {3.635211773858554*^9, 
   3.635211790114484*^9}, {3.6352118239554195`*^9, 3.6352118256825185`*^9}, {
   3.6352119215370007`*^9, 3.635211934823761*^9}, {3.6352121664930115`*^9, 
   3.6352121668210306`*^9}, {3.6352126340847564`*^9, 3.635212635268824*^9}, {
   3.6352163813220863`*^9, 3.635216386042356*^9}, {3.635216428873806*^9, 
   3.6352164412495136`*^9}, {3.6352591238368177`*^9, 3.635259172724614*^9}, {
   3.6352595357453775`*^9, 3.6352596663538485`*^9}, {3.6352597615202913`*^9, 
   3.635259762088324*^9}, {3.6352605027316866`*^9, 3.635260559456931*^9}, {
   3.635260599554224*^9, 3.635260676527627*^9}, {3.6352607200501165`*^9, 
   3.6352607730891495`*^9}, {3.635260991166623*^9, 3.6352609997101116`*^9}, {
   3.6352610455177317`*^9, 3.63526104828489*^9}, {3.6352612240029407`*^9, 
   3.6352612271231194`*^9}, {3.6353583726143246`*^9, 3.635358400115573*^9}, {
   3.6353584429338484`*^9, 3.635358464618286*^9}, {3.635374259016594*^9, 
   3.635374319543679*^9}, {3.6353743545577283`*^9, 3.6353744549648695`*^9}, {
   3.63537449080892*^9, 3.635374499319932*^9}, {3.6353775791632614`*^9, 
   3.6353776423913507`*^9}, {3.635377816330595*^9, 3.635377820581601*^9}, {
   3.6353779296237545`*^9, 3.6353779311337566`*^9}, 3.635378007200864*^9, {
   3.635475337558747*^9, 3.635475343419755*^9}, {3.635475374961799*^9, 
   3.6354754061358433`*^9}, {3.635475499244974*^9, 3.635475501784978*^9}, {
   3.6355118809741445`*^9, 3.635511912448189*^9}, 3.6355122178407183`*^9, {
   3.635512295090827*^9, 3.635512413765994*^9}, {3.635512488594099*^9, 
   3.635512658062337*^9}, {3.6355126928473864`*^9, 3.6355127097084103`*^9}, {
   3.6355127819985113`*^9, 3.6355127841485147`*^9}, {3.635512818501563*^9, 
   3.635512820622566*^9}, {3.6355128610916233`*^9, 3.635512876423645*^9}, {
   3.6355129547937555`*^9, 3.6355130229418507`*^9}, {3.63551308645094*^9, 
   3.6355130908609467`*^9}, {3.635513291783229*^9, 3.6355133007242413`*^9}, {
   3.635513352949315*^9, 3.6355133667313347`*^9}, {3.6355134290804224`*^9, 
   3.6355134291804223`*^9}, {3.6355135197815495`*^9, 3.6355135984216604`*^9}, 
   3.635513666382756*^9, {3.6355137620148907`*^9, 3.6355137685649*^9}, {
   3.6355138662090373`*^9, 3.635513885092064*^9}, {3.6355306763374186`*^9, 
   3.635530697210448*^9}, {3.635530996923869*^9, 3.635531006554883*^9}, {
   3.635545500732263*^9, 3.6355455016422644`*^9}, {3.659114055950717*^9, 
   3.659114064928667*^9}, {3.6591141474994297`*^9, 3.659114155095126*^9}, {
   3.659114438424957*^9, 3.6591144396804857`*^9}, {3.659114620328102*^9, 
   3.659114657900607*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Showing", "Subsubsection",
 CellChangeTimes->{{3.634502418124713*^9, 3.6345024264557247`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"execute", "[", 
    RowBox[{"modelConstantsIn_", ",", " ", "runOptionsIn_"}], " ", "]"}], " ",
    ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "renderOptions", ",", " ", "runOptions", ",", " ", "modelConstants", 
       ",", " ", "targetConcentrations", ",", " ", "initialStates", ",", " ", 
       "runs", ",", " ", "annealStep", ",", " ", "extnStep"}], " ", "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"runOptions", " ", "=", " ", 
       RowBox[{"preempt", "[", 
        RowBox[{"runOptionsIn", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "\[Rule]", " ", "35"}], ",", " ", 
           RowBox[{"annealStepName", " ", "\[Rule]", " ", "\"\<kinetic\>\""}],
            ",", " ", 
           RowBox[{
           "extnStepName", " ", "\[Rule]", " ", "\"\<Michaelis-Menton\>\""}], 
           ",", " ", 
           RowBox[{"useExtendDuringAnneal", "\[Rule]", " ", "False"}]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"modelConstants", " ", "=", " ", 
       RowBox[{"preempt", "[", 
        RowBox[{"modelConstantsIn", ",", " ", "constants"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"targetConcentrations", "  ", "=", 
       RowBox[{
        RowBox[{"Symbol", "[", "\"\<targetConcentrations\>\"", "]"}], " ", "//.",
         " ", "runOptions"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"initialStates", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"state0", "[", 
          RowBox[{"#", ",", " ", "modelConstants"}], "]"}], "&"}], " ", "/@", 
        " ", "targetConcentrations"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"annealStep", " ", "=", " ", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"annealStepName", " ", "//.", " ", "runOptions"}], ",", " ", 
         "\"\<kinetic\>\"", ",", " ", "annealKinetic", ",", " ", 
         "\"\<equilibrium\>\"", ",", " ", "annealEquilibrium"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"extnStep", " ", "=", " ", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"extnStepName", " ", "//.", " ", "runOptions"}], ",", " ", 
         "\"\<Gevertz\>\"", ",", " ", "extensionStepGevertz", ",", " ", 
         "\"\<Michaelis-Menton\>\"", ",", " ", 
         "extensionStepMichaelisMention"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"runs", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"run", "[", 
          RowBox[{
           RowBox[{"n", " ", "//.", " ", "runOptions"}], ",", " ", "#", ",", 
           " ", "annealStep", ",", " ", "extnStep", ",", " ", 
           "modelConstants", ",", " ", "runOptions"}], "]"}], " ", "&"}], " ",
         "/@", " ", "initialStates"}]}], ";", "\[IndentingNewLine]", 
      "runs"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6344909301969604`*^9, 3.634491148484268*^9}, {
   3.6344912135213604`*^9, 3.6344912383063955`*^9}, {3.6344913630885715`*^9, 
   3.634491385460603*^9}, {3.634491443836685*^9, 3.6344914463466887`*^9}, {
   3.6344914864757457`*^9, 3.634491529458806*^9}, {3.63449176642614*^9, 
   3.634491871549288*^9}, {3.6344919758234344`*^9, 3.63449198018344*^9}, {
   3.6344920294305096`*^9, 3.6344920297305098`*^9}, {3.634492092157598*^9, 
   3.634492208327762*^9}, {3.634492880284063*^9, 3.634492890186077*^9}, {
   3.634500329403759*^9, 3.6345003311437616`*^9}, {3.6345006957382755`*^9, 
   3.6345007492143507`*^9}, {3.6345008116814384`*^9, 
   3.6345008497864923`*^9}, {3.634500881927538*^9, 3.6345009102035775`*^9}, {
   3.634500962041651*^9, 3.634501024509739*^9}, {3.634501215398018*^9, 
   3.6345013220891676`*^9}, {3.6345022241134386`*^9, 3.634502250345475*^9}, {
   3.6345022837845235`*^9, 3.6345022840645237`*^9}, {3.634502361207633*^9, 
   3.634502389291672*^9}, {3.634573348864669*^9, 3.634573407617752*^9}, {
   3.634575929789876*^9, 3.634575931890879*^9}, {3.634576673647921*^9, 
   3.6345766758979244`*^9}, 3.6345989557550197`*^9, {3.6346468438960648`*^9, 
   3.6346468460161858`*^9}, 3.6346469210154753`*^9, {3.634653964731439*^9, 
   3.634653975243454*^9}, {3.6346543813835163`*^9, 3.634654450171613*^9}, {
   3.634656502680505*^9, 3.6346565046305075`*^9}, {3.634657257600568*^9, 
   3.63465745724885*^9}, {3.6346574958519163`*^9, 3.6346575392869787`*^9}, {
   3.634662185994934*^9, 3.6346621867593355`*^9}, 3.63466221770979*^9, {
   3.6346624354101725`*^9, 3.63466243954418*^9}, {3.634667765741726*^9, 
   3.6346677665977745`*^9}, {3.634668078818633*^9, 3.634668127187399*^9}, {
   3.634668160169286*^9, 3.6346681630254493`*^9}, {3.6346683972878485`*^9, 
   3.6346684044482574`*^9}, {3.6346690002018356`*^9, 3.634669000381836*^9}, {
   3.634669079967949*^9, 3.6346690802379494`*^9}, {3.6346693641946335`*^9, 
   3.6346693685628834`*^9}, {3.634671287477639*^9, 3.6346712882846856`*^9}, 
   3.6346722161837587`*^9, 3.6346723809331813`*^9, {3.634672739746704*^9, 
   3.634672766506235*^9}, {3.6346747982274427`*^9, 3.6346748008355923`*^9}, {
   3.6346944103461914`*^9, 3.6346944167145557`*^9}, {3.634694599632018*^9, 
   3.6346946201831937`*^9}, {3.634694794623171*^9, 3.634694823781839*^9}, {
   3.6346948694934535`*^9, 3.634694869765469*^9}, 3.634697082740044*^9, {
   3.6347365100951595`*^9, 3.6347365121842794`*^9}, {3.634737330346075*^9, 
   3.6347373306580935`*^9}, 3.634830833973457*^9, {3.634835152271449*^9, 
   3.634835308342376*^9}, 3.634835802995669*^9, {3.6348361180566893`*^9, 
   3.634836118744728*^9}, {3.634836148792447*^9, 3.6348361562628746`*^9}, {
   3.6348368739399233`*^9, 3.634836876045044*^9}, {3.634862832245653*^9, 
   3.6348628405401278`*^9}, {3.634863221521919*^9, 3.634863312379115*^9}, {
   3.634863902925893*^9, 3.634863971748829*^9}, {3.634867212878211*^9, 
   3.634867311214836*^9}, {3.634867351030113*^9, 3.6348673599286222`*^9}, {
   3.634867958207842*^9, 3.6348679961600122`*^9}, {3.6348680463198814`*^9, 
   3.63486816833286*^9}, 3.6348682243310633`*^9, {3.635009798302706*^9, 
   3.6350098466867733`*^9}, {3.635019100555791*^9, 3.6350191266878276`*^9}, {
   3.6350232914439707`*^9, 3.6350233245628285`*^9}, {3.635095199573304*^9, 
   3.635095221581563*^9}, {3.6350954188358455`*^9, 3.635095677829659*^9}, {
   3.6351029489035406`*^9, 3.635102950326622*^9}, {3.6351294164443974`*^9, 
   3.635129433716385*^9}, {3.635129474172699*^9, 3.635129516430116*^9}, {
   3.6352094312925673`*^9, 3.63520943431574*^9}, {3.6353655264112654`*^9, 
   3.6353657391016397`*^9}, {3.6353657693968925`*^9, 3.635365776432505*^9}, {
   3.6353658210641837`*^9, 3.635365873683076*^9}, {3.6353663649210424`*^9, 
   3.6353663705838523`*^9}, {3.6353745384049873`*^9, 
   3.6353745399049892`*^9}, {3.6353775199671783`*^9, 3.63537757055225*^9}, {
   3.6353784234134493`*^9, 3.6353784377654696`*^9}, 3.6353786019997*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"go", "[", "]"}], " ", ":=", " ", 
  RowBox[{"DynamicModule", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"annealExtensionName", " ", "=", " ", "\"\<separate\>\""}], ",",
       "annealStepName", ",", "annealTime", ",", "columnSpacer", ",", 
      "concFormat", ",", "concUnits", ",", "customGraphExpr1", ",", 
      "customGraphExpr2", ",", "customGraphExpr3", ",", "eng", ",", 
      "extensionTime", ",", "extnStepName", ",", "initLinear", ",", "initLog",
       ",", "kdFormat", ",", "kdUnits", ",", "kM", ",", "koff3Var", ",", 
      "koff4Var", ",", " ", "koffFormat", ",", "koffUnits", ",", "kon3Var", 
      ",", " ", "kon4Var", ",", " ", "konFormat", ",", "konUnits", ",", "kS", 
      ",", "linearControl", ",", "logControl", ",", "logEnzyme", ",", 
      "logkcat", ",", "logkoffft", ",", "logkoffru", ",", "logkoffu", ",", 
      " ", "logkoffd", ",", " ", "logkoffScale", ",", "logkonft", ",", 
      "logkonru", ",", "logkonScale", ",", "logkonu", ",", " ", "logkond", 
      ",", " ", "logP1", ",", "logP2", ",", "makeControlledSetterBar", ",", 
      "makeCustomGraphInput", ",", "manipulateLinearVar", ",", 
      "manipulateLinearVar2", ",", "manipulateLogVar", ",", 
      "manipulateLogVar2", ",", "modelConstants", ",", "n", ",", "noUnits", 
      ",", "polymeraseAnnealEfficiencyVar", ",", 
      RowBox[{"prevModelConstants", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"prevRunOptions", "=", 
       RowBox[{"{", "}"}]}], ",", "renderOptions", ",", "result", ",", 
      "runOptions", ",", "runs", ",", "sameList", ",", "showExtraPlots", ",", 
      "targetConcentrations", ",", 
      RowBox[{"time", "=", "0"}], ",", "timeUnits", ",", "unitsSpacer", ",", 
      "useCustomGraphs", ",", "useEnzymeContention", ",", 
      "useExtendDuringAnneal", ",", "useLinearPlots"}], "\[IndentingNewLine]",
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"columnSpacer", " ", "=", " ", 
      RowBox[{"Spacer", "[", "1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"unitsSpacer", " ", "=", " ", 
      RowBox[{"Spacer", "[", "2.5", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kM", "[", "]"}], " ", ":=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"10", "^", "logkcat"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"10", "^", "logkcat"}], " ", "*", " ", 
          RowBox[{"10", "^", "logkoffScale"}]}]}], ")"}], " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"10", "^", "logkcat"}], " ", "*", " ", 
         RowBox[{"10", "^", "logkonScale"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kS", "[", "]"}], " ", ":=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"10", "^", "logkcat"}], " ", "*", " ", 
         RowBox[{"10", "^", "logkoffScale"}]}], ")"}], " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"10", "^", "logkcat"}], " ", "*", " ", 
         RowBox[{"10", "^", "logkonScale"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eng", "[", "expr_", "]"}], " ", ":=", " ", 
      RowBox[{"EngineeringForm", "[", 
       RowBox[{
        RowBox[{"expr", " ", "//", " ", "N"}], ",", " ", "4"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"concUnits", "[", "expr_", "]"}], " ", ":=", " ", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"expr", ",", " ", "unitsSpacer", ",", " ", "\"\<M\>\""}], 
        "}"}], "]"}]}], ";", " ", 
     RowBox[{
      RowBox[{"concFormat", "[", "expr_", "]"}], " ", ":=", " ", 
      RowBox[{"concUnits", "[", 
       RowBox[{"eng", "[", "expr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"koffUnits", "[", "expr_", "]"}], " ", ":=", " ", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"expr", ",", " ", "unitsSpacer", ",", 
         RowBox[{"DisplayForm", "[", 
          RowBox[{"SuperscriptBox", "[", 
           RowBox[{"s", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], "]"}]}], ";", " ", 
     RowBox[{
      RowBox[{"koffFormat", "[", "expr_", "]"}], " ", ":=", " ", 
      RowBox[{"koffUnits", "[", 
       RowBox[{"eng", "[", "expr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"konUnits", "[", "expr_", "]"}], " ", ":=", " ", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"expr", ",", "unitsSpacer", ",", " ", 
         RowBox[{"DisplayForm", "[", 
          RowBox[{"SuperscriptBox", "[", 
           RowBox[{"M", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
         RowBox[{"DisplayForm", "[", 
          RowBox[{"SuperscriptBox", "[", 
           RowBox[{"s", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], "]"}]}], ";", " ", 
     RowBox[{
      RowBox[{"konFormat", "[", "expr_", "]"}], " ", ":=", " ", 
      RowBox[{"konUnits", "[", 
       RowBox[{"eng", "[", "expr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kdUnits", "[", "expr_", "]"}], " ", ":=", " ", 
      RowBox[{"concUnits", "[", "expr", "]"}]}], ";", " ", 
     RowBox[{
      RowBox[{"kdFormat", "[", "expr_", "]"}], " ", ":=", " ", 
      RowBox[{"kdUnits", "[", "expr", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"noUnits", "[", "expr_", "]"}], " ", ":=", " ", "expr"}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timeUnits", "[", "expr_", "]"}], " ", ":=", " ", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"expr", ",", " ", "unitsSpacer", ",", "\"\<s\>\""}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"initLog", "[", "sym_", "]"}], " ", ":=", " ", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", " ", 
         RowBox[{"sym", " ", "//.", " ", "constants"}]}], "]"}], " ", "//", 
       " ", "N"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"initLinear", "[", "sym_", "]"}], " ", ":=", " ", 
      RowBox[{
       RowBox[{"sym", " ", "//.", " ", "constants"}], " ", "//", " ", "N"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"logControl", "[", 
       RowBox[{
       "var_", ",", "c_", ",", " ", "low_", ",", " ", "high_", ",", " ", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"var", ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"initLog", "[", "c", "]"}], "]"}], ",", " ", "\"\<\>\""}],
           "}"}], ",", " ", "low", ",", "high", ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", " ", "\[Rule]", " ", "Small"}], ",", " ", 
         RowBox[{"Appearance", " ", "\[Rule]", " ", 
          RowBox[{"{", "\"\<Closed\>\"", "}"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"AppearanceElements", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"(*", 
            RowBox[{
            "\"\<PlayPauseButton\>\"", ",", "\"\<StepLeftButton\>\"", ",", 
             "\"\<StepRightButton\>\"", ",", " ", 
             "\"\<FasterSlowerButtons\>\"", ",", " ", 
             "\"\<DirectionButton\>\"", ","}], "*)"}], " ", 
           "\"\<InputField\>\"", "}"}]}], ",", " ", "opts"}], 
        "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"linearControl", "[", 
       RowBox[{
       "var_", ",", "c_", ",", " ", "low_", ",", " ", "high_", ",", " ", 
        RowBox[{"opts", ":", " ", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"var", ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"initLinear", "[", "c", "]"}], "]"}], ",", " ", 
           "\"\<\>\""}], "}"}], ",", " ", "low", ",", "high", ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", " ", "\[Rule]", " ", "Small"}], ",", " ", 
         RowBox[{"Appearance", " ", "\[Rule]", " ", 
          RowBox[{"{", "\"\<Closed\>\"", "}"}]}], ",", " ", 
         RowBox[{"AppearanceElements", "\[Rule]", 
          RowBox[{"{", " ", "\"\<InputField\>\"", "}"}]}], ",", " ", "opts"}],
         "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"manipulateLogVar", "[", 
       RowBox[{
       "label_", ",", " ", "var_", ",", "c_", ",", " ", "low_", ",", " ", 
        "high_", ",", " ", 
        RowBox[{"format_:", " ", "eng"}], ",", " ", 
        RowBox[{"opts", ":", " ", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Sequence", "[", "\[IndentingNewLine]", 
       RowBox[{"label", ",", " ", "\[IndentingNewLine]", 
        RowBox[{"logControl", "[", 
         RowBox[{
         "var", ",", " ", "c", ",", " ", "low", ",", " ", "high", ",", " ", 
          "opts"}], "]"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"Column", "[", 
         RowBox[{"{", 
          RowBox[{"Dynamic", "[", 
           RowBox[{"format", "[", 
            RowBox[{"10", "^", "var"}], "]"}], "]"}], "}"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"manipulateLogVar2", "[", 
       RowBox[{
       "label_", ",", " ", "var_", ",", "c_", ",", " ", "low_", ",", " ", 
        "high_", ",", " ", "expr_", ",", " ", 
        RowBox[{"opts", ":", " ", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Sequence", "[", "\[IndentingNewLine]", 
       RowBox[{"label", ",", " ", "\[IndentingNewLine]", 
        RowBox[{"logControl", "[", 
         RowBox[{
         "var", ",", " ", "c", ",", " ", "low", ",", " ", "high", ",", " ", 
          "opts"}], "]"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"Column", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Dynamic", "[", 
            RowBox[{"eng", "[", 
             RowBox[{"10", "^", "var"}], "]"}], "]"}], ",", " ", 
           RowBox[{"Dynamic", "[", "expr", "]"}]}], "}"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"manipulateLinearVar", "[", 
       RowBox[{
       "label_", ",", " ", "var_", ",", "c_", ",", " ", "low_", ",", " ", 
        "high_", ",", 
        RowBox[{"opts", ":", " ", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
      RowBox[{"Sequence", "[", 
       RowBox[{"label", ",", " ", 
        RowBox[{"linearControl", "[", 
         RowBox[{
         "var", ",", " ", "c", ",", " ", "low", ",", " ", "high", ",", " ", 
          "opts"}], "]"}], ",", " ", 
        RowBox[{"Dynamic", "[", "var", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"manipulateLinearVar2", "[", 
       RowBox[{
       "label_", ",", " ", "var_", ",", "c_", ",", " ", "low_", ",", " ", 
        "high_", ",", " ", "format_", ",", 
        RowBox[{"opts", ":", " ", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
      RowBox[{"Sequence", "[", 
       RowBox[{"label", ",", " ", 
        RowBox[{"linearControl", "[", 
         RowBox[{
         "var", ",", " ", "c", ",", " ", "low", ",", " ", "high", ",", " ", 
          "opts"}], "]"}], ",", " ", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"format", "[", "var", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"makeControlledSetterBar", "[", 
       RowBox[{"name_", ",", " ", "values_", ",", " ", "expr_"}], "]"}], " ", 
      ":=", " ", 
      RowBox[{"Row", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Spacer", "[", "7", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"SetterBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "name", "]"}], ",", " ", "values", ",", 
           " ", 
           RowBox[{"Enabled", "\[Rule]", " ", 
            RowBox[{"Dynamic", "[", "expr", "]"}]}], ",", " ", 
           RowBox[{"BaseStyle", "\[Rule]", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"If", "[", 
              RowBox[{"expr", ",", " ", "Black", ",", " ", "Gray"}], "]"}], 
             "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"makeCustomGraphInput", "[", 
       RowBox[{"name_", ",", " ", "expr_", ",", " ", "init_"}], "]"}], " ", ":=",
       " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "input", "}"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"input", " ", "=", " ", 
          RowBox[{"Row", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "name", "]"}], ",", " ", 
              RowBox[{"Hold", "[", "Expression", "]"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"ImageSize", "\[Rule]", "105"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"Enabled", "\[Rule]", " ", 
               RowBox[{"Dynamic", "[", "expr", "]"}]}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"BaseStyle", "\[Rule]", 
               RowBox[{"Dynamic", "[", 
                RowBox[{"If", "[", 
                 RowBox[{"expr", ",", " ", "Black", ",", " ", "Gray"}], "]"}],
                 "]"}]}]}], "]"}], "\[IndentingNewLine]", "}"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"name", " ", "=", " ", "init"}], ";", "\[IndentingNewLine]", 
         "input"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sameList", "[", 
       RowBox[{"a_List", ",", " ", "b_List"}], "]"}], "  ", ":=", " ", 
      RowBox[{
       RowBox[{"Equal", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "===", "True"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"targetConcentrations", "  ", "=", " ", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", 
        RowBox[{"NestList", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "*", "10"}], "&"}], ",", " ", 
          RowBox[{"10", "^", 
           RowBox[{"-", "14"}]}], ",", " ", "4"}], "]"}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"update", ";", "\[IndentingNewLine]", 
        RowBox[{"kon3Var", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{"useEnzymeContention", ",", " ", "kon1", ",", " ", "0"}], 
          "]"}]}], ";", " ", 
        RowBox[{"kon4Var", " ", "=", " ", "kon3Var"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"koff3Var", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{"useEnzymeContention", ",", " ", "koff1", ",", " ", "0"}], 
          "]"}]}], ";", 
        RowBox[{"koff4Var", " ", "=", " ", "koff3Var"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"modelConstants", " ", "=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"eStart", " ", "\[Rule]", " ", 
            RowBox[{"10", "^", "logEnzyme"}]}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"fStart", " ", "\[Rule]", " ", 
            RowBox[{"10", "^", "logP1"}]}], ",", 
           RowBox[{"ftoff", " ", "\[Rule]", " ", 
            RowBox[{"10", "^", "logkoffft"}]}], ",", 
           RowBox[{"fton", " ", "\[Rule]", " ", 
            RowBox[{"10", "^", "logkonft"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"rStart", " ", "\[Rule]", " ", 
            RowBox[{"10", "^", "logP2"}]}], ",", " ", 
           RowBox[{"ruoff", " ", "\[Rule]", " ", 
            RowBox[{"10", "^", "logkoffru"}]}], ",", " ", 
           RowBox[{"ruon", " ", "\[Rule]", " ", 
            RowBox[{"10", "^", "logkonru"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"koffu", " ", "\[Rule]", " ", 
            RowBox[{"10", "^", "logkoffu"}]}], ",", " ", 
           RowBox[{"konu", " ", "\[Rule]", " ", 
            RowBox[{"10", "^", "logkonu"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"koffd", " ", "\[Rule]", " ", 
            RowBox[{"10", "^", "logkoffd"}]}], ",", " ", 
           RowBox[{"kond", " ", "\[Rule]", " ", 
            RowBox[{"10", "^", " ", "logkond"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"konScale", "\[Rule]", " ", 
            RowBox[{"10", "^", " ", "logkonScale"}]}], ",", " ", 
           RowBox[{"koffScale", " ", "\[Rule]", " ", 
            RowBox[{"10", "^", "logkoffScale"}]}], ",", " ", 
           RowBox[{"kcat", " ", "\[Rule]", " ", 
            RowBox[{"10", "^", "logkcat"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"kon3", " ", "\[Rule]", " ", "kon3Var"}], ",", " ", 
           RowBox[{"kon4", " ", "\[Rule]", " ", "kon4Var"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"koff3", " ", "\[Rule]", " ", "koff3Var"}], ",", 
           RowBox[{"koff4", " ", "\[Rule]", " ", "koff4Var"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\[Tau]ann", " ", "\[Rule]", " ", "annealTime"}], ",", " ", 
           RowBox[{"\[Tau]ext", " ", "\[Rule]", " ", "extensionTime"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
           "polymeraseAnnealEfficiency", " ", "\[Rule]", " ", 
            "polymeraseAnnealEfficiencyVar"}]}], "\[IndentingNewLine]", 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"runOptions", " ", "=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<n\>\"", "]"}], " ", "\[Rule]", " ", 
            "n"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<annealStepName\>\"", "]"}], " ", 
            "\[Rule]", " ", "annealStepName"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<extnStepName\>\"", "]"}], " ", 
            "\[Rule]", " ", "extnStepName"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<useExtendDuringAnneal\>\"", "]"}], 
            " ", "\[Rule]", " ", "useExtendDuringAnneal"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<targetConcentrations\>\"", "]"}], " ",
             "\[Rule]", " ", "targetConcentrations"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"renderOptions", " ", "=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<showExtraPlots\>\"", "]"}], " ", 
            "\[Rule]", " ", "showExtraPlots"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<useLinearPlots\>\"", "]"}], " ", 
            "\[Rule]", " ", "useLinearPlots"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<showU\>\"", "]"}], " ", "\[Rule]", 
            " ", 
            RowBox[{"annealStepName", "\[Equal]", "\"\<kinetic\>\""}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<targetConcentrations\>\"", "]"}], " ",
             "\[Rule]", " ", "targetConcentrations"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<useCustomGraphs\>\"", "]"}], " ", 
            "\[Rule]", " ", "useCustomGraphs"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<customGraphExpr1\>\"", "]"}], " ", 
            "\[Rule]", " ", "customGraphExpr1"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<customGraphExpr2\>\"", "]"}], " ", 
            "\[Rule]", " ", "customGraphExpr2"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<customGraphExpr3\>\"", "]"}], " ", 
            "\[Rule]", " ", "customGraphExpr3"}]}], "\[IndentingNewLine]", 
          "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"time", ",", " ", "result"}], "}"}], "=", 
         RowBox[{"Timing", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Not", "[", 
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"sameList", "[", 
                 RowBox[{"prevModelConstants", ",", "modelConstants"}], "]"}],
                 ",", 
                RowBox[{"sameList", "[", 
                 RowBox[{"prevRunOptions", ",", "runOptions"}], "]"}]}], 
               "]"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"runs", " ", "=", " ", 
               RowBox[{"execute", "[", 
                RowBox[{"modelConstants", ",", " ", "runOptions"}], "]"}]}], 
              ";", " ", "\[IndentingNewLine]", 
              RowBox[{"prevModelConstants", " ", "=", " ", "modelConstants"}],
               ";", " ", "\[IndentingNewLine]", 
              RowBox[{"prevRunOptions", " ", "=", " ", "runOptions"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"plotRuns", "[", 
            RowBox[{
            "runs", ",", " ", "modelConstants", ",", " ", "renderOptions"}], 
            "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", "result"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"\"\<cycle count\>\"", ",", " ", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"n", ",", " ", "35", ",", " ", "\"\<\>\""}], "}"}], 
                ",", " ", 
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", "50"}], "]"}]}], "}"}], "]"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"columnSpacer", ","}], "*)"}], " ", 
             RowBox[{"Item", "[", 
              RowBox[{"\"\<show linear graphs\>\"", ",", " ", 
               RowBox[{"Alignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
             "SpanFromLeft", ",", "\[IndentingNewLine]", 
             RowBox[{"Row", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Control", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "useLinearPlots", ",", " ", "False", ",", " ", 
                    "\"\<\>\""}], "}"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"True", ",", " ", "False"}], "}"}], ",", " ", 
                   RowBox[{"Enabled", " ", "\[Rule]", " ", "True"}]}], "}"}], 
                 "]"}], ",", " ", "\[IndentingNewLine]", 
                RowBox[{"Spacer", "[", "15", "]"}], ",", "  ", 
                "\"\<show extra graphs\>\"", ",", " ", 
                RowBox[{"Spacer", "[", "5", "]"}], ",", " ", 
                RowBox[{"Control", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "showExtraPlots", ",", " ", "False", ",", " ", 
                    "\"\<\>\""}], "}"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"True", ",", " ", "False"}], "}"}], ",", " ", 
                   RowBox[{"Enabled", " ", "\[Rule]", " ", "True"}]}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Spacer", "[", "15", "]"}], ",", " ", 
                "\"\<show custom graphs\>\"", ",", " ", 
                RowBox[{"Spacer", "[", "5", "]"}], ",", " ", 
                RowBox[{"Control", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "useCustomGraphs", ",", " ", "False", ",", " ", 
                    "\"\<\>\""}], "}"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"True", ",", " ", "False"}], "}"}], ",", " ", 
                   RowBox[{"Enabled", " ", "\[Rule]", " ", "True"}]}], "}"}], 
                 "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
             "\[IndentingNewLine]", "SpanFromLeft"}], "\[IndentingNewLine]", 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<anneal algorithm\>\"", ",", " ", "\[IndentingNewLine]", 
             RowBox[{"makeControlledSetterBar", "[", 
              RowBox[{"annealStepName", ",", " ", 
               RowBox[{"{", 
                RowBox[{"\"\<kinetic\>\"", ",", " ", "\"\<equilibrium\>\""}], 
                "}"}], ",", " ", 
               RowBox[{
               "annealExtensionName", "\[Equal]", "\"\<separate\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"columnSpacer", ","}], "*)"}], " ", 
             RowBox[{"Item", "[", 
              RowBox[{"\"\<poly' active in anneal\>\"", ",", " ", 
               RowBox[{"Alignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
             "SpanFromLeft", ",", "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "useExtendDuringAnneal", ",", " ", "False", ",", " ", 
                  "\"\<\>\""}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"True", ",", " ", "False"}], "}"}], ",", " ", 
                RowBox[{"Enabled", " ", "\[Rule]", " ", 
                 RowBox[{
                 "extnStepName", "\[Equal]", "\"\<Michaelis-Menton\>\""}]}]}],
                "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<ext'n algorithm\>\"", ",", " ", "\[IndentingNewLine]", 
             RowBox[{"makeControlledSetterBar", "[", 
              RowBox[{"extnStepName", ",", " ", 
               RowBox[{"{", 
                RowBox[{
                "\"\<Michaelis-Menton\>\"", ",", " ", "\"\<Gevertz\>\""}], 
                "}"}], ",", " ", 
               RowBox[{
               "annealExtensionName", "\[Equal]", "\"\<separate\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", "SpanFromLeft"}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"manipulateLogVar", "[", 
              RowBox[{
              "\"\<primer f conc\>\"", ",", " ", "logP1", ",", " ", "fStart", 
               ",", " ", 
               RowBox[{"-", "10"}], ",", " ", 
               RowBox[{"-", "3"}], ",", " ", "concFormat"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"columnSpacer", ","}], "*)"}], 
             RowBox[{"manipulateLogVar", "[", 
              RowBox[{
              "\"\<ftoff\>\"", ",", " ", "logkoffft", ",", " ", "ftoff", ",", 
               " ", 
               RowBox[{"-", "10"}], ",", " ", "0", ",", " ", "koffFormat"}], 
              "]"}], ",", " ", "\[IndentingNewLine]", "columnSpacer", ",", 
             RowBox[{"manipulateLogVar", "[", 
              RowBox[{
              "\"\<fton\>\"", ",", " ", "logkonft", ",", " ", "fton", ",", 
               " ", "0", ",", " ", "20", ",", " ", "konFormat"}], "]"}], ",", 
             "\[IndentingNewLine]", "columnSpacer", ",", " ", 
             "\"\<ftoff/fton\>\"", ",", " ", 
             RowBox[{"Dynamic", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"10", "^", "logkoffft"}], " ", "/", " ", 
                RowBox[{"10", "^", "logkonft"}]}], " ", "//", " ", 
               "kdFormat"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"manipulateLogVar", "[", 
              RowBox[{
              "\"\<primer r conc\>\"", ",", " ", "logP2", ",", " ", "rStart", 
               ",", " ", 
               RowBox[{"-", "10"}], ",", " ", 
               RowBox[{"-", "3"}], ",", " ", "concFormat"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"columnSpacer", ","}], "*)"}], 
             RowBox[{"manipulateLogVar", "[", 
              RowBox[{
              "\"\<ruoff\>\"", ",", " ", "logkoffru", ",", " ", "ruoff", ",", 
               " ", 
               RowBox[{"-", "10"}], ",", " ", "0", ",", " ", "koffFormat"}], 
              "]"}], ",", "\[IndentingNewLine]", "columnSpacer", ",", 
             RowBox[{"manipulateLogVar", "[", 
              RowBox[{
              "\"\<ruon\>\"", ",", " ", "logkonru", ",", " ", "ruon", ",", 
               " ", "0", ",", "20", ",", " ", "konFormat"}], "]"}], ",", 
             "\[IndentingNewLine]", "columnSpacer", ",", " ", 
             "\"\<ruoff/ruon\>\"", ",", " ", 
             RowBox[{"Dynamic", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"10", "^", "logkoffru"}], " ", "/", " ", 
                RowBox[{"10", "^", "logkonru"}]}], " ", "//", " ", 
               "kdFormat"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<t-u duplex\>\"", ",", " ", "\"\<\>\"", ",", " ", "\"\<\>\"", 
             ",", " ", "\[IndentingNewLine]", 
             RowBox[{"manipulateLogVar", "[", 
              RowBox[{
              "\"\<koffu\>\"", ",", " ", "logkoffu", ",", " ", "koffu", ",", 
               " ", 
               RowBox[{"-", "60"}], ",", " ", 
               RowBox[{"-", "10"}], ",", " ", "koffFormat"}], "]"}], ",", 
             "\[IndentingNewLine]", "columnSpacer", ",", 
             RowBox[{"manipulateLogVar", "[", 
              RowBox[{
              "\"\<konu\>\"", ",", " ", "logkonu", ",", " ", "konu", ",", " ",
                "0", ",", "20", ",", " ", "konFormat"}], "]"}], ",", 
             "\[IndentingNewLine]", "columnSpacer", ",", " ", 
             "\"\<koffu/konu\>\"", ",", " ", 
             RowBox[{"Dynamic", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"10", "^", "logkoffu"}], " ", "/", " ", 
                RowBox[{"10", "^", "logkonu"}]}], " ", "//", " ", 
               "kdFormat"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<f-r dimer\>\"", ",", " ", "\"\<\>\"", ",", " ", "\"\<\>\"", 
             ",", " ", "\[IndentingNewLine]", 
             RowBox[{"manipulateLogVar", "[", 
              RowBox[{
              "\"\<koffd\>\"", ",", " ", "logkoffd", ",", " ", "koffd", ",", 
               " ", 
               RowBox[{"-", "10"}], ",", " ", "5", ",", " ", "koffFormat"}], 
              "]"}], ",", "\[IndentingNewLine]", "columnSpacer", ",", 
             RowBox[{"manipulateLogVar", "[", 
              RowBox[{
              "\"\<kond\>\"", ",", " ", "logkond", ",", " ", "kond", ",", " ",
                "0", ",", "20", ",", " ", "konFormat"}], "]"}], ",", 
             "\[IndentingNewLine]", "columnSpacer", ",", " ", 
             "\"\<koffd/kond\>\"", ",", "  ", 
             RowBox[{"Dynamic", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"10", "^", "logkoffd"}], " ", "/", " ", 
                RowBox[{"10", "^", "logkond"}]}], " ", "//", " ", 
               "kdFormat"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"manipulateLogVar", "[", 
              RowBox[{
              "\"\<polymerase conc\>\"", ",", " ", "logEnzyme", ",", " ", 
               "eStart", ",", " ", 
               RowBox[{"-", "10"}], ",", " ", 
               RowBox[{"-", "3"}], ",", " ", "concFormat"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"columnSpacer", ","}], "*)"}], " ", 
             RowBox[{"manipulateLogVar2", "[", 
              RowBox[{
              "\"\<koff/kcat\>\"", ",", " ", "logkoffScale", ",", " ", 
               "koffScale", ",", " ", 
               RowBox[{"-", "10"}], ",", " ", "10", ",", " ", 
               RowBox[{"Item", "[", 
                RowBox[{
                 RowBox[{"koffFormat", "[", 
                  RowBox[{
                   RowBox[{"10", "^", "logkoffScale"}], " ", "*", " ", 
                   RowBox[{"10", "^", "logkcat"}]}], "]"}], ",", " ", 
                 RowBox[{"BaseStyle", "\[Rule]", "Gray"}]}], "]"}], ",", " ", 
               RowBox[{"Enabled", " ", "\[Rule]", " ", 
                RowBox[{
                "extnStepName", "\[Equal]", "\"\<Michaelis-Menton\>\""}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", "columnSpacer", ",", " ", 
             RowBox[{"manipulateLogVar2", "[", 
              RowBox[{
              "\"\<kon/kcat\>\"", ",", " ", "logkonScale", ",", " ", 
               "konScale", ",", " ", "0", ",", " ", "20", ",", " ", 
               RowBox[{"Item", "[", 
                RowBox[{
                 RowBox[{"konFormat", "[", 
                  RowBox[{
                   RowBox[{"10", "^", "logkonScale"}], " ", "*", " ", 
                   RowBox[{"10", "^", "logkcat"}]}], "]"}], ",", " ", 
                 RowBox[{"BaseStyle", "\[Rule]", "Gray"}]}], "]"}], ",", "  ", 
               RowBox[{"Enabled", " ", "\[Rule]", " ", 
                RowBox[{
                "extnStepName", "\[Equal]", "\"\<Michaelis-Menton\>\""}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", "columnSpacer", ",", " ", 
             "\"\<Ks=koff/kon\>\"", ",", " ", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"kdFormat", "[", 
               RowBox[{"kS", "[", "]"}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", " ", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Column", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<polymerase\>\"", ",", "\"\<contention\>\""}], 
                "}"}], ",", " ", 
               RowBox[{"Alignment", "\[Rule]", "Right"}]}], "]"}], "*)"}], 
            " ", 
            RowBox[{"\"\<polymerase contention\>\"", ",", " ", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "useEnzymeContention", ",", " ", "False", ",", " ", 
                  "\"\<\>\""}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"True", ",", " ", "False"}], "}"}], ",", " ", 
                RowBox[{"Enabled", " ", "\[Rule]", " ", 
                 RowBox[{
                 "extnStepName", "\[Equal]", "\"\<Michaelis-Menton\>\""}]}]}],
                "}"}], "]"}], ",", " ", "\"\<\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"columnSpacer", ","}], "*)"}], " ", 
             RowBox[{"manipulateLogVar", "[", 
              RowBox[{
              "\"\<kcat\>\"", ",", " ", "logkcat", ",", " ", "kcat", ",", " ", 
               RowBox[{"-", "5"}], ",", " ", "5", ",", " ", "koffFormat"}], 
              "]"}], ",", "\[IndentingNewLine]", "columnSpacer", ",", " ", 
             "\"\<\>\"", ",", " ", "\"\<\>\"", ",", " ", "\"\<\>\"", ",", " ",
              "\[IndentingNewLine]", "columnSpacer", ",", "  ", 
             "\"\<Km=(kcat+koff)/kon\>\"", ",", " ", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"kdFormat", "[", 
               RowBox[{"kM", "[", "]"}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"manipulateLinearVar2", "[", 
              RowBox[{
              "\"\<anneal time\>\"", ",", " ", "annealTime", ",", " ", 
               "\[Tau]ann", ",", " ", "0", ",", " ", "120", ",", " ", 
               "timeUnits", ",", " ", 
               RowBox[{"Enabled", " ", "\[Rule]", " ", 
                RowBox[{"annealStepName", "\[Equal]", "\"\<kinetic\>\""}]}]}],
               "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"columnSpacer", ","}], "*)"}], " ", 
             RowBox[{"manipulateLinearVar2", "[", 
              RowBox[{
              "\"\<ext'n time\>\"", ",", " ", "extensionTime", ",", " ", 
               "\[Tau]ext", ",", " ", "0", ",", " ", "120", ",", " ", 
               "timeUnits"}], "]"}], ",", "\[IndentingNewLine]", 
             "columnSpacer", ",", " ", 
             RowBox[{"manipulateLinearVar", "[", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<poly' anneal\>\"", ",", " ", "\"\<efficiency\>\""}], 
                  "}"}], ",", " ", 
                 RowBox[{"Alignment", "\[Rule]", "Right"}]}], "]"}], ",", " ",
                "polymeraseAnnealEfficiencyVar", ",", " ", 
               "polymeraseAnnealEfficiency", ",", " ", "0", ",", " ", "1", 
               ",", " ", 
               RowBox[{"Enabled", " ", "\[Rule]", 
                RowBox[{"Dynamic", "[", "useExtendDuringAnneal", "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", "columnSpacer", ",", "  ", 
             "\"\<kcat/Km\>\"", ",", " ", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"konFormat", "[", 
               RowBox[{
                RowBox[{"10", "^", "logkcat"}], "/", 
                RowBox[{"kM", "[", "]"}]}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Item", "[", 
              RowBox[{"\"\<1st custom graph\>\"", ",", " ", 
               RowBox[{"BaseStyle", "\[Rule]", 
                RowBox[{"Dynamic", "[", 
                 RowBox[{"If", "[", 
                  RowBox[{
                  "useCustomGraphs", ",", " ", "Black", ",", " ", "Gray"}], 
                  "]"}], "]"}]}]}], "]"}], ",", 
             RowBox[{"makeCustomGraphInput", "[", 
              RowBox[{
              "customGraphExpr1", ",", " ", "useCustomGraphs", ",", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ft", "+", "eft"}], ")"}], " ", "/", " ", "tT"}]}], 
              "]"}], ",", "\[IndentingNewLine]", "columnSpacer", ",", " ", 
             RowBox[{"Item", "[", 
              RowBox[{"\"\<2nd graph\>\"", ",", " ", 
               RowBox[{"BaseStyle", "\[Rule]", 
                RowBox[{"Dynamic", "[", 
                 RowBox[{"If", "[", 
                  RowBox[{
                  "useCustomGraphs", ",", " ", "Black", ",", " ", "Gray"}], 
                  "]"}], "]"}]}]}], "]"}], ",", " ", 
             RowBox[{"makeCustomGraphInput", "[", 
              RowBox[{
              "customGraphExpr2", ",", " ", "useCustomGraphs", ",", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"tu", "+", "eu"}], ")"}], "/", "tT"}]}], "]"}], ",", 
             " ", "\"\<\>\"", ",", " ", "\[IndentingNewLine]", "columnSpacer",
              ",", " ", 
             RowBox[{"Item", "[", 
              RowBox[{"\"\<3rd graph\>\"", ",", " ", 
               RowBox[{"BaseStyle", "\[Rule]", 
                RowBox[{"Dynamic", "[", 
                 RowBox[{"If", "[", 
                  RowBox[{
                  "useCustomGraphs", ",", " ", "Black", ",", " ", "Gray"}], 
                  "]"}], "]"}]}]}], "]"}], ",", " ", 
             RowBox[{"makeCustomGraphInput", "[", 
              RowBox[{
              "customGraphExpr3", ",", " ", "useCustomGraphs", ",", " ", 
               RowBox[{"t", "/", "tT"}]}], "]"}]}], "\[IndentingNewLine]", 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", " ", "\[IndentingNewLine]", 
             RowBox[{"Grid", "[", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<Update\>\"", ",", " ", 
                   RowBox[{"update", " ", "=", " ", 
                    RowBox[{"Not", "[", "update", "]"}]}], ",", " ", 
                   RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", "  ",
                  "\[IndentingNewLine]", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<Reset\>\"", ",", " ", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"annealTime", " ", "=", " ", 
                    RowBox[{"initLinear", "[", "\[Tau]ann", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"extensionTime", " ", "=", " ", 
                    RowBox[{"initLinear", "[", "\[Tau]ext", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"polymeraseAnnealEfficiencyVar", " ", "=", " ", 
                    RowBox[{
                    "initLinear", "[", "polymeraseAnnealEfficiency", "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"logEnzyme", " ", "=", " ", 
                    RowBox[{"initLog", "[", "eStart", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"logP1", " ", "=", 
                    RowBox[{"initLog", "[", "fStart", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"logP2", " ", "=", 
                    RowBox[{"initLog", "[", "rStart", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"logkoffScale", " ", "=", " ", 
                    RowBox[{"initLog", "[", "koffScale", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"logkonScale", " ", "=", " ", 
                    RowBox[{"initLog", "[", "konScale", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"logkcat", " ", "=", 
                    RowBox[{"initLog", "[", "kcat", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"logkonu", " ", "=", " ", 
                    RowBox[{"initLog", "[", "konu", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"logkoffu", " ", "=", " ", 
                    RowBox[{"initLog", "[", "koffu", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"logkond", " ", "=", " ", 
                    RowBox[{"initLog", "[", "kond", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"logkoffd", " ", "=", " ", 
                    RowBox[{"initLog", "[", "koffd", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"logkoffft", " ", "=", " ", 
                    RowBox[{"initLog", "[", "ftoff", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"logkoffru", " ", "=", " ", 
                    RowBox[{"initLog", "[", "ruoff", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"logkonft", " ", "=", " ", 
                    RowBox[{"initLog", "[", "fton", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"logkonru", " ", "=", " ", 
                    RowBox[{"initLog", "[", "ruon", "]"}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}]}], "}"}], 
               "}"}], "]"}], ",", "\[IndentingNewLine]", "SpanFromLeft"}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"{", " ", 
             RowBox[{"\"\<elapsed\>\"", ",", 
              RowBox[{"Dynamic", "[", "time", "]"}]}], "}"}]}], "*)"}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Alignment", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
            "Right", ",", " ", "Left", ",", " ", "Left", ",", " ", "Right", 
             ",", " ", "Left", ",", " ", "Left", ",", " ", "Left", ",", " ", 
             "Right", ",", " ", "Left", ",", " ", "Left", ",", " ", "Left", 
             ",", " ", "Right", ",", " ", "Left"}], "}"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"update", ",", " ", 
         RowBox[{"{", 
          RowBox[{"True", ",", " ", "False"}], "}"}], ",", " ", 
         RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{
         "update", ",", " ", "useLinearPlots", ",", " ", "showExtraPlots"}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Deployed", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"SynchronousUpdating", "\[Rule]", "False"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], " ", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.6345926393607426`*^9, {3.634597599627454*^9, 3.634597616539421*^9}, {
   3.6345976832832384`*^9, 3.634597688362529*^9}, {3.6345977415565715`*^9, 
   3.6345977455548*^9}, {3.6345977849460535`*^9, 3.634597786034116*^9}, {
   3.634597829266588*^9, 3.6345979270811825`*^9}, {3.634598006352717*^9, 
   3.6345980131451054`*^9}, {3.63459805744864*^9, 3.6345980598407764`*^9}, {
   3.634598356918768*^9, 3.6345983670703487`*^9}, {3.634598498605872*^9, 
   3.634598577965411*^9}, {3.634646951776235*^9, 3.634646971343354*^9}, {
   3.634647048831786*^9, 3.634647061199494*^9}, {3.6346471054790263`*^9, 
   3.634647157711014*^9}, {3.6346529962145586`*^9, 3.6346530284086037`*^9}, {
   3.6346531926728354`*^9, 3.6346532067978563`*^9}, {3.634653238672901*^9, 
   3.634653254113922*^9}, {3.6346537486231346`*^9, 3.6346537895781927`*^9}, {
   3.634653836594259*^9, 3.634653889310333*^9}, {3.634654508940696*^9, 
   3.6346546039818296`*^9}, {3.6346546423458834`*^9, 3.6346546784199343`*^9}, 
   3.6346621108900013`*^9, 3.6346627963208065`*^9, {3.6346679831411605`*^9, 
   3.634667989646532*^9}, 3.634668471423088*^9, {3.634669826687087*^9, 
   3.6346698293502393`*^9}, 3.6346698920868273`*^9, {3.634669964989997*^9, 
   3.6346699661820655`*^9}, {3.634670088783078*^9, 3.63467017623608*^9}, 
   3.6346706695072937`*^9, 3.6346713260878477`*^9, {3.6346720724715385`*^9, 
   3.6346721379032807`*^9}, {3.634672168238016*^9, 3.6346721847329597`*^9}, {
   3.6346722380780106`*^9, 3.634672240254135*^9}, 3.6346723933328905`*^9, 
   3.6346945564665494`*^9, {3.6346949913004203`*^9, 3.634695000982974*^9}, {
   3.634696036846222*^9, 3.634696043185585*^9}, {3.6346961223821144`*^9, 
   3.634696124981263*^9}, {3.6347728353278437`*^9, 3.6347728608003016`*^9}, {
   3.6347730067586493`*^9, 3.6347730108788853`*^9}, {3.634773055273424*^9, 
   3.6347731865899353`*^9}, {3.634773245158285*^9, 3.6347732745019636`*^9}, {
   3.634773314061226*^9, 3.6347733353484435`*^9}, {3.6347735586122136`*^9, 
   3.634773560348313*^9}, {3.6347737068826942`*^9, 3.6347737148421497`*^9}, {
   3.6347755900934076`*^9, 3.6347758763157787`*^9}, {3.6347759300188503`*^9, 
   3.634775930202861*^9}, {3.6347759790106525`*^9, 3.634776195601041*^9}, {
   3.634776254560413*^9, 3.6347763766313953`*^9}, 3.6347765231267743`*^9, {
   3.6347766038403907`*^9, 3.634776711767564*^9}, 3.6347767790934143`*^9, {
   3.6348298117979918`*^9, 3.6348298683742275`*^9}, {3.6348298986859617`*^9, 
   3.6348299066294155`*^9}, {3.6348299610935307`*^9, 3.634830023941126*^9}, {
   3.6348303715630083`*^9, 3.6348307279213915`*^9}, {3.634830846424169*^9, 
   3.6348309655859847`*^9}, 3.6348325329496326`*^9, {3.6348325784922376`*^9, 
   3.6348327596666*^9}, {3.634832798321811*^9, 3.634832804906188*^9}, {
   3.6348328453945036`*^9, 3.634832870524941*^9}, {3.6348330143321667`*^9, 
   3.634833179248599*^9}, {3.6348332110714192`*^9, 3.6348333278740997`*^9}, {
   3.634833386830472*^9, 3.6348333952139516`*^9}, {3.634833601611757*^9, 
   3.6348336021167855`*^9}, {3.6348336710687294`*^9, 3.63483385482724*^9}, {
   3.634833910284412*^9, 3.6348340604109983`*^9}, {3.634834094121927*^9, 
   3.634834108722762*^9}, {3.6348341732894545`*^9, 3.63483420467325*^9}, {
   3.634834234904979*^9, 3.6348342506808815`*^9}, {3.634834291337207*^9, 
   3.6348342954174404`*^9}, {3.634834418919504*^9, 3.634834521407366*^9}, {
   3.6348346619424043`*^9, 3.634834689926005*^9}, {3.6348348234056396`*^9, 
   3.6348348456619124`*^9}, {3.6348349039002433`*^9, 
   3.6348349232443495`*^9}, {3.6348350167156963`*^9, 3.634835020154893*^9}, {
   3.6348351849223166`*^9, 3.6348351899866066`*^9}, 3.6348352565074115`*^9, {
   3.6348353155537887`*^9, 3.634835316889865*^9}, {3.634835389481017*^9, 
   3.6348354393888717`*^9}, {3.6348355081678057`*^9, 
   3.6348355332402396`*^9}, {3.634836942510845*^9, 3.6348369687553463`*^9}, {
   3.634837029086797*^9, 3.634837034223091*^9}, {3.6348370804297338`*^9, 
   3.63483711096148*^9}, {3.634837217484573*^9, 3.6348372438300796`*^9}, {
   3.6348373482040496`*^9, 3.634837359944721*^9}, {3.634837408859519*^9, 
   3.6348374093835487`*^9}, {3.6348374488368053`*^9, 
   3.6348374676648827`*^9}, {3.6348375744429893`*^9, 
   3.6348376460980883`*^9}, {3.634837821300109*^9, 3.6348378485406675`*^9}, {
   3.6348379015687003`*^9, 3.6348379140084114`*^9}, {3.6348379558798065`*^9, 
   3.634837994769031*^9}, {3.634838149317871*^9, 3.634838159854473*^9}, {
   3.634838197525628*^9, 3.634838222840076*^9}, {3.6348383376386423`*^9, 
   3.6348385071083355`*^9}, {3.634838669698635*^9, 3.6348388378582525`*^9}, {
   3.6348388750173783`*^9, 3.6348389191459026`*^9}, {3.6348389519127765`*^9, 
   3.634839136479333*^9}, {3.6348393340466332`*^9, 3.634839335011688*^9}, {
   3.6348396580721664`*^9, 3.6348396642925224`*^9}, {3.6348534139629583`*^9, 
   3.6348536692555604`*^9}, {3.634863092409534*^9, 3.6348632108173065`*^9}, {
   3.6348642745541487`*^9, 3.6348642748961687`*^9}, {3.6348645235583906`*^9, 
   3.634864627662345*^9}, {3.6348646707238083`*^9, 3.6348646959852533`*^9}, {
   3.634864796002974*^9, 3.6348648291128674`*^9}, {3.6348660150717006`*^9, 
   3.6348660175318413`*^9}, {3.6348660701048484`*^9, 
   3.6348661002325716`*^9}, {3.6348661312813473`*^9, 3.634866166432358*^9}, {
   3.6348661983681846`*^9, 3.634866358490343*^9}, {3.634866404257961*^9, 
   3.634866438193902*^9}, {3.6348664812723656`*^9, 3.6348664841115284`*^9}, {
   3.6348665214786654`*^9, 3.6348665596988516`*^9}, {3.6348667216731157`*^9, 
   3.634866769616858*^9}, {3.634866806236953*^9, 3.634866825668064*^9}, {
   3.634866950655213*^9, 3.6348670049023156`*^9}, {3.6348673680590873`*^9, 
   3.634867390578375*^9}, {3.634867535185646*^9, 3.634867568039525*^9}, {
   3.634867668856292*^9, 3.6348677018961816`*^9}, {3.6348677384482718`*^9, 
   3.6348677399913607`*^9}, {3.634868289555794*^9, 3.6348683206585727`*^9}, {
   3.6348683525183945`*^9, 3.634868427918708*^9}, {3.6349155803869667`*^9, 
   3.6349156114934216`*^9}, {3.634915666935919*^9, 3.6349156708515263`*^9}, {
   3.6349157476504607`*^9, 3.634915886147504*^9}, {3.6349159281427774`*^9, 
   3.6349159763312626`*^9}, {3.634916059682209*^9, 3.6349160789014425`*^9}, {
   3.6349161808164215`*^9, 3.6349162255417*^9}, {3.6349163003750315`*^9, 
   3.6349164079528203`*^9}, {3.634916471408532*^9, 3.63491647602614*^9}, {
   3.6349168689536314`*^9, 3.634916870888035*^9}, {3.6349169009024878`*^9, 
   3.6349169348793473`*^9}, {3.6349169771710215`*^9, 
   3.6349170425195365`*^9}, {3.63491711257926*^9, 3.6349171388341055`*^9}, {
   3.6349171940426025`*^9, 3.63491729505278*^9}, {3.634917328530439*^9, 
   3.634917387248942*^9}, {3.6349174255314093`*^9, 3.6349174615206723`*^9}, {
   3.634919480570819*^9, 3.634919495671645*^9}, {3.6349195373705187`*^9, 
   3.63491953835332*^9}, {3.6349195693505745`*^9, 3.63491963479109*^9}, {
   3.6349196690497503`*^9, 3.634919709453821*^9}, {3.634919742463479*^9, 
   3.63491974274428*^9}, {3.6349197883753595`*^9, 3.6349197887965603`*^9}, {
   3.6349222183752403`*^9, 3.6349222352388697`*^9}, {3.6349222719145346`*^9, 
   3.634922339415853*^9}, {3.6349223742663145`*^9, 3.6349223771835194`*^9}, {
   3.634922416199188*^9, 3.6349224616108675`*^9}, {3.6349224991445336`*^9, 
   3.6349225051973443`*^9}, {3.6349260563269825`*^9, 3.6349260642517962`*^9}, 
   3.634926537307027*^9, {3.6349265903783197`*^9, 3.6349266463668184`*^9}, {
   3.6349266876756907`*^9, 3.6349266920280986`*^9}, {3.634926776705047*^9, 
   3.6349267969070826`*^9}, {3.634926840509159*^9, 3.634926846140769*^9}, {
   3.6349268940494537`*^9, 3.634926896405058*^9}, {3.6349403353355765`*^9, 
   3.6349403664003534`*^9}, {3.634940886197084*^9, 3.6349409184289274`*^9}, {
   3.6349409945882835`*^9, 3.6349410860435143`*^9}, {3.634941122979627*^9, 
   3.634941152133295*^9}, {3.6349411943377085`*^9, 3.6349411975538926`*^9}, {
   3.6349412330419226`*^9, 3.6349412334429455`*^9}, {3.634941273921261*^9, 
   3.6349412834888077`*^9}, {3.6349418257178216`*^9, 
   3.6349418461569905`*^9}, {3.6349418887974296`*^9, 
   3.6349418918806057`*^9}, {3.6350062410939736`*^9, 3.63500627410802*^9}, {
   3.635006943408961*^9, 3.635006955489978*^9}, {3.6350069906340275`*^9, 
   3.635007057499121*^9}, {3.63500710652919*^9, 3.635007163934271*^9}, {
   3.635008459083315*^9, 3.63500863263356*^9}, 3.6350086884236393`*^9, {
   3.635008742160715*^9, 3.6350087830507727`*^9}, {3.635009293795286*^9, 
   3.635009325708331*^9}, {3.6350108731162157`*^9, 3.6350108828772297`*^9}, {
   3.6350132894744024`*^9, 3.6350133034874225`*^9}, {3.6350133556034956`*^9, 
   3.6350133717545185`*^9}, {3.635013537764752*^9, 3.635013538674753*^9}, {
   3.6350161787431035`*^9, 3.6350161807431064`*^9}, {3.6350162158161554`*^9, 
   3.635016237459186*^9}, {3.6350163020883417`*^9, 3.635016377905448*^9}, {
   3.635016437762532*^9, 3.635016439672535*^9}, {3.6350165002406206`*^9, 
   3.635016506311629*^9}, {3.6350165560646987`*^9, 3.635016622411792*^9}, {
   3.635016657084841*^9, 3.6350166991689005`*^9}, 3.6350167333029485`*^9, {
   3.6350167763670087`*^9, 3.635016792670032*^9}, {3.635016843634104*^9, 
   3.6350168535551176`*^9}, {3.6350169830292997`*^9, 3.635017030404366*^9}, {
   3.6350179525421753`*^9, 3.635017955122179*^9}, {3.6350181189594097`*^9, 
   3.6350181251494184`*^9}, {3.6350188817104836`*^9, 
   3.6350190168566732`*^9}, {3.635019146539856*^9, 3.63501915000086*^9}, {
   3.6350206543919897`*^9, 3.635020662063*^9}, {3.635020780682167*^9, 
   3.6350208196972227`*^9}, {3.635020887334317*^9, 3.635020991596464*^9}, {
   3.635021026710513*^9, 3.6350210270605135`*^9}, {3.635021064045566*^9, 
   3.6350210679355717`*^9}, {3.6350216090003347`*^9, 3.635021613341341*^9}, {
   3.6350230693307805`*^9, 3.6350230742135887`*^9}, {3.635027308144137*^9, 
   3.6350273083681498`*^9}, {3.6350276256652975`*^9, 3.635027625737302*^9}, {
   3.6350351730529833`*^9, 3.6350352114791813`*^9}, {3.6350352488043165`*^9, 
   3.635035256955783*^9}, {3.6350353095877934`*^9, 3.6350353550843954`*^9}, {
   3.635035431027739*^9, 3.63503544817872*^9}, {3.6350354791304903`*^9, 
   3.6350354804345646`*^9}, {3.635035543833191*^9, 3.635035601122468*^9}, {
   3.6350356847852535`*^9, 3.6350356998571153`*^9}, {3.6350357401614203`*^9, 
   3.6350357458017435`*^9}, {3.6350358541619406`*^9, 3.635035900055566*^9}, {
   3.6350359420559683`*^9, 3.635035942807011*^9}, {3.6350359847514105`*^9, 
   3.635036080044861*^9}, {3.6350361187640753`*^9, 3.635036137612153*^9}, {
   3.635036188971091*^9, 3.6350362021318436`*^9}, {3.6350362751810217`*^9, 
   3.635036325924924*^9}, {3.635093928958629*^9, 3.6350939570542364`*^9}, {
   3.6350940435621843`*^9, 3.6350940564419208`*^9}, {3.635094102284543*^9, 
   3.6350941374025517`*^9}, {3.635094183731201*^9, 3.6350941912526317`*^9}, {
   3.6350942777395782`*^9, 3.635094340500168*^9}, {3.6350943776412926`*^9, 
   3.6350944322804174`*^9}, {3.63509447288374*^9, 3.6350945858091993`*^9}, {
   3.6350947295754223`*^9, 3.6350948063838153`*^9}, {3.6350951841164203`*^9, 
   3.635095187412609*^9}, {3.6350953099156156`*^9, 3.635095387741067*^9}, {
   3.635095727833519*^9, 3.6350957640655913`*^9}, {3.6350961523818016`*^9, 
   3.6350961582851396`*^9}, {3.6350962111001606`*^9, 
   3.6350962400758176`*^9}, {3.6350962815071874`*^9, 
   3.6350963297329454`*^9}, {3.6350963801248283`*^9, 3.635096419027053*^9}, {
   3.6350964633165865`*^9, 3.6350964978755627`*^9}, {3.635096537090806*^9, 
   3.6350965724008255`*^9}, {3.635096633465318*^9, 3.635096655897601*^9}, {
   3.6350966962869115`*^9, 3.635096703591329*^9}, {3.63509706813518*^9, 
   3.6350970723754225`*^9}, {3.635098266190705*^9, 3.6350982756622467`*^9}, {
   3.6350983068880324`*^9, 3.6350983179186635`*^9}, {3.6350983655263863`*^9, 
   3.635098416316292*^9}, {3.63509846943633*^9, 3.6350985319239035`*^9}, {
   3.635098568095973*^9, 3.6350986470864906`*^9}, {3.635098686004717*^9, 
   3.635098701757618*^9}, {3.635098826242738*^9, 3.6350988318350577`*^9}, {
   3.6350988631578493`*^9, 3.635098923611307*^9}, {3.6350989675938225`*^9, 
   3.6350989971475134`*^9}, {3.6350990374878206`*^9, 3.63509903992796*^9}, {
   3.6350993355688696`*^9, 3.635099344192363*^9}, {3.6350995861021996`*^9, 
   3.635099593436619*^9}, {3.6350996399882812`*^9, 3.6350996491648064`*^9}, {
   3.63510284451257*^9, 3.635102850264899*^9}, {3.635131223903778*^9, 
   3.6351312428718634`*^9}, {3.6351982389234*^9, 3.6351982864461184`*^9}, {
   3.6352079699349823`*^9, 3.635208113470192*^9}, {3.635208146222065*^9, 
   3.635208158085744*^9}, 3.6352136451495857`*^9, {3.6353566363531675`*^9, 
   3.635356640159574*^9}, {3.6353566704860272`*^9, 3.6353567350233407`*^9}, {
   3.635357465179427*^9, 3.6353575496269755`*^9}, {3.6353583739871273`*^9, 
   3.6353584646338863`*^9}, {3.6353587854592505`*^9, 3.635358792916064*^9}, {
   3.635358862679386*^9, 3.63535897883819*^9}, {3.635359045887108*^9, 
   3.635359053265921*^9}, {3.6353590953547955`*^9, 3.6353592419960527`*^9}, {
   3.635359288313534*^9, 3.635359317875586*^9}, {3.6353593648316684`*^9, 
   3.6353593772648907`*^9}, {3.6353659836164694`*^9, 3.635366077344434*^9}, {
   3.6353745652380247`*^9, 3.635374608043085*^9}, {3.6353773612289553`*^9, 
   3.635377402903014*^9}, {3.6353774360970607`*^9, 3.6353775107551656`*^9}, {
   3.635378135078044*^9, 3.6353782673332295`*^9}, {3.635378342793336*^9, 
   3.6353783498643456`*^9}, {3.6353784669285107`*^9, 
   3.6353784756195226`*^9}, {3.6353787265778756`*^9, 
   3.6353787595319223`*^9}, {3.635379081579375*^9, 3.635379167698496*^9}, {
   3.635379218924568*^9, 3.635379297992679*^9}, {3.6353793419477406`*^9, 
   3.6353793711697817`*^9}, {3.6353794269758606`*^9, 3.635379460028907*^9}, {
   3.635379511414979*^9, 3.6353795544610395`*^9}, {3.6353796262891407`*^9, 
   3.6353796443811665`*^9}, {3.635379700377245*^9, 3.6353797076982555`*^9}, {
   3.635380301133622*^9, 3.635380320315649*^9}, {3.6353803694117184`*^9, 
   3.6353804165557847`*^9}, {3.6353804510898333`*^9, 
   3.6353804578408427`*^9}, {3.6353805077369127`*^9, 3.635380535250952*^9}, {
   3.6353806090780554`*^9, 3.635380715630205*^9}, {3.6353807612092695`*^9, 
   3.635380774472288*^9}, {3.6353808610154104`*^9, 3.6353808647564154`*^9}, {
   3.6353808958084593`*^9, 3.6353808983294625`*^9}, {3.6353809835585823`*^9, 
   3.6353812090849*^9}, {3.6353812548999643`*^9, 3.635381335308077*^9}, {
   3.6353813654301195`*^9, 3.635381467621263*^9}, {3.635381759027178*^9, 
   3.635381907554387*^9}, {3.6353819504914474`*^9, 3.6353819539814525`*^9}, {
   3.635382316761965*^9, 3.635382328643982*^9}, {3.6353823648780327`*^9, 
   3.6353825570313025`*^9}, {3.6353826208883924`*^9, 3.635382622578395*^9}, {
   3.6353826913854914`*^9, 3.6353827576325846`*^9}, {3.6353828001476445`*^9, 
   3.6353828519637175`*^9}, {3.635382894367777*^9, 3.6353829912599134`*^9}, {
   3.635383590102268*^9, 3.6353835915422707`*^9}, {3.635383658159364*^9, 
   3.635383773951527*^9}, {3.6353838049345703`*^9, 3.6353838332776103`*^9}, {
   3.635383894143696*^9, 3.6353839292577453`*^9}, {3.635384007284855*^9, 
   3.6353840116058607`*^9}, {3.635384090574972*^9, 3.6353841181680107`*^9}, {
   3.6353841651820765`*^9, 3.635384170162084*^9}, 3.6353842443301883`*^9, 
   3.635384627520727*^9, {3.6353846785157986`*^9, 3.635384693226819*^9}, {
   3.635384875138075*^9, 3.635384875188075*^9}, {3.6353928887011433`*^9, 
   3.635392956549239*^9}, {3.63539302874734*^9, 3.635393031148344*^9}, {
   3.6353931495235105`*^9, 3.6353931572645216`*^9}, {3.6353932626176696`*^9, 
   3.6353932841897*^9}, {3.6353935451836915`*^9, 3.6353935571133738`*^9}, {
   3.6353936211040125`*^9, 3.635393630480549*^9}, {3.635393671210868*^9, 
   3.635393696645318*^9}, {3.6353938355172467`*^9, 3.635393837937384*^9}, {
   3.63539392845154*^9, 3.635393948583687*^9}, {3.635394296106537*^9, 
   3.635394373439928*^9}, {3.6353944262499323`*^9, 3.635394445152012*^9}, 
   3.6353944916536646`*^9, {3.6353945578934245`*^9, 3.635394558211443*^9}, {
   3.635427214011295*^9, 3.635427270012374*^9}, {3.635427319674444*^9, 
   3.6354273921515465`*^9}, {3.6354275733498025`*^9, 3.635427580711813*^9}, {
   3.6354276163988633`*^9, 3.635427617649865*^9}, {3.6354279212572947`*^9, 
   3.6354279249582996`*^9}, {3.635427964137355*^9, 3.6354279748383703`*^9}, {
   3.635428018539432*^9, 3.6354280739065104`*^9}, {3.6354281080415583`*^9, 
   3.635428146439613*^9}, {3.635428228649729*^9, 3.635428337419883*^9}, {
   3.635428450488044*^9, 3.635428471854074*^9}, {3.635428558192196*^9, 
   3.635428574707219*^9}, {3.6354287571574774`*^9, 3.635428760257482*^9}, {
   3.6354288553576164`*^9, 3.6354288597486224`*^9}, {3.6354288902036653`*^9, 
   3.635428899766679*^9}, {3.6354289354817295`*^9, 3.6354289597677636`*^9}, {
   3.635429000505821*^9, 3.6354290010658216`*^9}, {3.635429065008912*^9, 
   3.635429114419982*^9}, {3.635429148982031*^9, 3.63542917673807*^9}, {
   3.6354292156181335`*^9, 3.6354292320311565`*^9}, {3.6354292626181993`*^9, 
   3.6354292649582033`*^9}, {3.6354293031912584`*^9, 3.635429307322264*^9}, {
   3.6354293409693117`*^9, 3.635429345900319*^9}, {3.635473937972274*^9, 
   3.6354739497842903`*^9}, {3.6354739960683556`*^9, 
   3.6354740066193705`*^9}, {3.6354750380913253`*^9, 3.635475068545368*^9}, {
   3.635475103890418*^9, 3.635475171208513*^9}, {3.6354752942436857`*^9, 
   3.6354752961636887`*^9}, {3.63547541817686*^9, 3.6354754227578664`*^9}, {
   3.6354755787930856`*^9, 3.635475579654087*^9}, {3.635475634369164*^9, 
   3.635475654422192*^9}, {3.6354756980872536`*^9, 3.6354757374523087`*^9}, {
   3.6354758104214125`*^9, 3.635475810691413*^9}, {3.6354758768855076`*^9, 
   3.635475990279667*^9}, {3.6354761413458796`*^9, 3.635476187803945*^9}, {
   3.6354785629782896`*^9, 3.6354785657592936`*^9}, {3.6354786030013466`*^9, 
   3.635478620383371*^9}, {3.6354786610104284`*^9, 3.635478665130434*^9}, {
   3.6354787082684946`*^9, 3.6354787180695086`*^9}, {3.635478768214579*^9, 
   3.635478771764584*^9}, {3.63547891813579*^9, 3.635478918985791*^9}, {
   3.6354790239069386`*^9, 3.635479066041998*^9}, {3.6355147547922883`*^9, 
   3.635514768744308*^9}, {3.635530219630776*^9, 3.635530230131791*^9}, {
   3.635530431570074*^9, 3.635530433370077*^9}, {3.635530528730211*^9, 
   3.635530534431219*^9}, {3.635531219220182*^9, 3.635531400719437*^9}, {
   3.6355314312424803`*^9, 3.6355314412844944`*^9}, {3.6355314727075386`*^9, 
   3.6355317201488867`*^9}, {3.635531763113947*^9, 3.635531801340001*^9}, {
   3.6355375729057283`*^9, 3.635537640113823*^9}, {3.63555214814607*^9, 
   3.635552166502096*^9}, {3.635785233655405*^9, 3.635785238976413*^9}, {
   3.6591140560537305`*^9, 3.6591140649967127`*^9}, {3.6591141475774374`*^9, 
   3.659114155301161*^9}, 3.659114444242899*^9, {3.659114620417859*^9, 
   3.6591146296299353`*^9}, {3.65911952008743*^9, 3.6591195461735334`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Using the Model", "Section",
 CellChangeTimes->{{3.6348396881578875`*^9, 3.634839729397246*^9}, 
   3.635198268400086*^9, 3.635258774157818*^9}],

Cell[BoxData[
 RowBox[{"go", "[", "]"}]], "Input",
 CellChangeTimes->{{3.6350178140329804`*^9, 3.635017816822984*^9}}]
}, Open  ]]
},
WindowSize->{1233, 1548},
WindowMargins->{{Automatic, 326}, {Automatic, 0}},
CellContext->Notebook,
InputAliases->{"intt" -> RowBox[{"\[Integral]", 
     RowBox[{"\[SelectionPlaceholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "dintt" -> RowBox[{
     SubsuperscriptBox[
     "\[Integral]", "\[SelectionPlaceholder]", "\[Placeholder]"], 
     RowBox[{"\[Placeholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "sumt" -> RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "prodt" -> RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "dt" -> RowBox[{
     SubscriptBox["\[PartialD]", "\[Placeholder]"], " ", 
     "\[SelectionPlaceholder]"}], "ket" -> 
  TemplateBox[{"\[Placeholder]"}, "Ket"], "bra" -> 
  TemplateBox[{"\[Placeholder]"}, "Bra"], "braket" -> 
  TemplateBox[{"\[Placeholder]", "\[Placeholder]"}, "BraKet"], "notation" -> 
  RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation>" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation<" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "symb" -> RowBox[{"Symbolize", "[", 
     TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], "]"}], 
  "infixnotation" -> RowBox[{"InfixNotation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], ",", 
       "\[Placeholder]"}], "]"}], "addia" -> RowBox[{"AddInputAlias", "[", 
     RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "pattwraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationPatternTag"], 
  "madeboxeswraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationMadeBoxesTag"], "rxn" -> 
  OverscriptBox["\[RightArrow]", "\[Placeholder]"], "erxn" -> RowBox[{
     UnderoverscriptBox[
      TagBox[
       TagBox["\[Equilibrium]", DisplayForm], DisplayForm], "\[Placeholder]", 
      "\[Placeholder]"], " "}]},
Magnification:>0.95 Inherited,
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 157, 2, 67, "Section"],
Cell[CellGroupData[{
Cell[762, 28, 166, 2, 46, "Subsection"],
Cell[931, 32, 2953, 75, 211, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3921, 112, 97, 1, 46, "Subsection"],
Cell[4021, 115, 254, 5, 29, "Text"],
Cell[4278, 122, 1814, 42, 204, "Input"],
Cell[6095, 166, 6080, 173, 394, "Input"],
Cell[12178, 341, 2385, 63, 131, "Input"],
Cell[14566, 406, 699, 19, 39, "Input"],
Cell[15268, 427, 528, 14, 39, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15833, 446, 99, 1, 46, "Subsection"],
Cell[15935, 449, 13634, 256, 1011, "Input"],
Cell[29572, 707, 766, 13, 91, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30375, 725, 103, 1, 46, "Subsection"],
Cell[CellGroupData[{
Cell[30503, 730, 171, 2, 38, "Subsubsection"],
Cell[30677, 734, 2737, 53, 211, "Input"],
Cell[33417, 789, 248, 5, 29, "Text"],
Cell[33668, 796, 8668, 180, 391, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42373, 981, 117, 1, 38, "Subsubsection"],
Cell[42493, 984, 551, 9, 48, "Text"],
Cell[43047, 995, 2365, 58, 286, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45449, 1058, 167, 2, 38, "Subsubsection"],
Cell[45619, 1062, 247, 3, 29, "Text"],
Cell[45869, 1067, 2158, 54, 236, "Input"],
Cell[48030, 1123, 196, 4, 29, "Text"],
Cell[48229, 1129, 574, 13, 51, "Input"],
Cell[48806, 1144, 309, 6, 29, "Text"],
Cell[49118, 1152, 16594, 347, 1091, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65761, 1505, 105, 1, 43, "Subsection"],
Cell[CellGroupData[{
Cell[65891, 1510, 105, 1, 36, "Subsubsection"],
Cell[65999, 1513, 674, 11, 48, "Text"],
Cell[66676, 1526, 2996, 63, 131, "Input"],
Cell[69675, 1591, 142, 1, 29, "Text"],
Cell[69820, 1594, 3603, 72, 171, "Input"],
Cell[73426, 1668, 466, 7, 48, "Text"],
Cell[73895, 1677, 7456, 149, 471, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81388, 1831, 196, 2, 36, "Subsubsection"],
Cell[81587, 1835, 333, 6, 27, "Text"],
Cell[81923, 1843, 366, 7, 29, "Text"],
Cell[82292, 1852, 171, 3, 30, "Input"],
Cell[82466, 1857, 10830, 211, 831, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93345, 2074, 108, 1, 43, "Subsection"],
Cell[93456, 2077, 277, 5, 29, "Text"],
Cell[93736, 2084, 6530, 137, 391, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100303, 2226, 242, 3, 46, "Subsection"],
Cell[100548, 2231, 13053, 233, 1091, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113638, 2469, 149, 2, 43, "Subsection"],
Cell[CellGroupData[{
Cell[113812, 2475, 103, 1, 38, "Subsubsection"],
Cell[113918, 2478, 458, 12, 30, "Input"],
Cell[114379, 2492, 46099, 951, 3531, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160515, 3448, 100, 1, 38, "Subsubsection"],
Cell[160618, 3451, 6989, 119, 291, "Input"],
Cell[167610, 3572, 64892, 1208, 4251, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[232563, 4787, 150, 2, 67, "Section"],
Cell[232716, 4791, 118, 2, 30, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
